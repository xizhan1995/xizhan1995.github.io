import{r,o as p,c as o,a as e,b as s,w as i,F as c,d as a,e as t}from"./app.11a37516.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const d={},m=e("h1",{id:"\u76EE\u5F55",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#\u76EE\u5F55","aria-hidden":"true"},"#"),a(" \u76EE\u5F55")],-1),h={href:"https://www.gnu.org/software/make/manual/make.html",target:"_blank",rel:"noopener noreferrer"},b=a("https://www.gnu.org/software/make/manual/make.html"),k={class:"table-of-contents"},f=a("\u76EE\u5F55"),g=a("1. \u6982\u89C8"),v=a("\u51C6\u5907"),_=a("1.1 \u5982\u4F55\u9605\u8BFB\u672C\u624B\u518C"),y=a("1.2 \u95EE\u9898\u548Cbug"),w=a("2. Makefile\u6587\u4EF6\u7684\u4ECB\u7ECD"),x=a("2.1 What a Rule Looks Like"),A=a("2.2 A Simple Makefile"),E=a("2.3 How make Processes a Makefile"),S=a("2.4 Variables Make Makefiles Simpler"),$=a("2.5 Letting make Deduce the Recipes"),L=a("2.6 \u53E6\u4E00\u79CD\u98CE\u683C\u7684 makefile"),q=a("2.7 \u6E05\u7406\u76EE\u5F55\u7684\u89C4\u5219"),M=a("3 Writing Makefiles"),I=a("3.1 Makefile \u5305\u542B\u7684\u5143\u7D20"),R=a("3.1.1 \u7EED\u884C"),F=a("3.2 \u6307\u5B9A makefile \u6587\u4EF6\u8DEF\u5F84"),T=a("3.3 \u5305\u542B\u5176\u5B83makefile"),P=a("3.4 \u53D8\u91CF MAKEFILES"),C=a("3.5 Remade \u8FC7\u7A0B"),O=a("3.6 \u8986\u76D6\u53E6\u4E00\u4E2Amakfile\u7684\u90E8\u5206\u5185\u5BB9"),H=a("3.7 \u8BFB\u53D6makefile\uFF1A\u4E24\u9636\u6BB5"),G=a("\u6761\u4EF6\u6307\u4EE4\u7ACB\u5373\u5C55\u5F00"),N=a("\u89C4\u5219\u5B9A\u4E49"),j=a("3.8 \u89E3\u6790Makefile"),K=a("3.9 Secondary Expansion \u5F85\u7EED"),D=a("4. \u4E66\u5199\u89C4\u5219"),V=a("4.1 \u793A\u4F8B"),U=a("4.2 \u89C4\u5219\u8BED\u6CD5"),B=a("4.3 prerequisite \u7684\u5206\u7C7B"),W=a("4.4 \u5728\u6587\u4EF6\u540D\u4E2D\u4F7F\u7528\u901A\u914D\u7B26"),Q=a("4.4.1 \u793A\u4F8B"),X=a("4.4.2 \u9677\u9631"),Y=a("4.4.3 wildcard \u51FD\u6570"),z=a("4.5 prerequisite \u7684\u641C\u7D22\u8DEF\u5F84 \u5F85\u7EED"),J=a("4.5.1 VPATH \u53D8\u91CF"),Z=a("4.5.2 vpath \u6307\u4EE4"),ee=a("4.5.3 \u76EE\u5F55\u641C\u7D22\u662F\u5982\u4F55\u6267\u884C\u7684"),ae=a("4.5.4 \u4E66\u5199\u53EF\u4EE5\u9002\u914D Directory Search \u7684 recipe"),se=a("4.5.5 Directory Search \u548C implicit rule"),ne=a("4.5.6 Directory Search \u548C\u94FE\u63A5\u5E93 \u7565"),ie=a("4.6 Phony target"),le=a("4.7 \u65E2\u6CA1\u6709 recipe \u53C8\u6CA1\u6709 prerequisite \u7684\u89C4\u5219"),te=a("4.8 \u7528\u7A7A\u7684target\u6587\u4EF6\u8BB0\u5F55\u4E8B\u4EF6"),re=a("4.9 \u6709\u7279\u6B8A\u610F\u4E49\u7684\u5185\u7F6Etarget : \u90E8\u5206"),pe=a("4.10 \u4E00\u4E2A\u89C4\u5219\u591A\u4E2A target"),oe=a("4.11 \u4E00\u4E2A target \u591A\u4E2A\u89C4\u5219"),ce=a("4.12 \u9759\u6001\u6A21\u677F\u89C4\u5219"),ue=a("4.12.1 \u8BED\u6CD5"),de=a("4.12.2 \u4E0E\u9690\u5F0F\u89C4\u5219\u5BF9\u6BD4"),me=a("4.13 \u53CC\u5192\u53F7\u89C4\u5219"),he=a("4.14 \u81EA\u52A8\u751F\u6210\u4F9D\u8D56"),be=a("5 \u89C4\u5219\u4E2D\u7684 recipe"),ke=a("5.1 \u8BED\u6CD5"),fe=a("5.1.1 recipe \u4E2D\u7684\u7EED\u884C"),ge=a("5.1.2 \u5728 recipe \u4E2D\u4F7F\u7528\u53D8\u91CF"),ve=a("5.2 recipe \u7684\u56DE\u663E"),_e=a("5.3 \u6267\u884C recipe"),ye=a("5.3.1 \u4F7F\u7528\u4E00\u4E2A shell"),we=a("5.3.2 \u9009\u62E9 shell"),xe=a("5.4 \u5E76\u53D1\u6267\u884C"),Ae=a("5.4.1 \u5E76\u53D1\u65F6\u7684\u8F93\u51FA"),Ee=a("5.4.2 \u5E76\u53D1\u65F6\u7684\u8F93\u5165"),Se=a("5.5 recipe \u4E2D\u7684\u9519\u8BEF"),$e=a("5.6 \u7EC8\u6B62 make"),Le=a("5.7 \u9012\u5F52\u8C03\u7528 make"),qe=a("5.7.1 MAKE\u53D8\u91CF\u7684\u5DE5\u4F5C\u65B9\u5F0F"),Me=a("5.7.2 \u5411\u5B50 make \u4F20\u9012\u53D8\u91CF"),Ie=a("5.7.3 \u5411\u5B50 make \u4F20\u9012\u9009\u9879"),Re=a("5.7.4 --print-directory \u9009\u9879"),Fe=a("5.8 \u5B9A\u4E49\u5BB9\u5668 recipe"),Te=a("5.9 \u4F7F\u7528\u7A7A recipe"),Pe=a("6 \u53D8\u91CF"),Ce=a("9. How to Run Make"),Oe=a("9.1 \u6307\u5B9A makefile"),He=a("9.2 \u6307\u5B9A goal"),Ge=a("9.3 Instead of Executing Recipes"),Ne=a("9.4 \u8DF3\u8FC7\u7F16\u8BD1\u67D0\u4E9B\u6587\u4EF6"),je=a("9.5 \u8986\u76D6\u53D8\u91CF"),Ke=a("9.6 \u6D4B\u8BD5\u7F16\u8BD1\u8FC7\u7A0B"),De=a("9.7 \u9009\u9879\u603B\u7ED3"),Ve=a("10 Using Implicit Rules"),Ue=a("10.1 Using Implicit Rules"),Be=a("10.2 Catalogue of Built-In Rules"),We=a("10.3 Variables Used by Implicit Rules"),Qe=a("10.4 \u9690\u5F0F\u89C4\u5219\u7684\u94FE\u5F0F\u8C03\u7528"),Xe=a("10.5 \u81EA\u5B9A\u4E49\u548C\u91CD\u65B0\u5B9A\u4E49\u6A21\u5F0F\u89C4\u5219"),Ye=a("10.5.1 Introduction to Pattern Rules"),ze=a("10.5.2 Pattern Rule Examples"),Je=a("10.5.3 Automatic Variables"),Ze=a("10.5.4 How Patterns Match"),ea=a("10.5.5 Match-Anything Pattern Rules"),aa=t(`<p>\u770B\u6807\u9898\uFF0C\u624B\u518C\u7684\u524D 10 \u7AE0\u5C5E\u4E8E Make \u5DE5\u5177\u57FA\u7840\u77E5\u8BC6\u3002 \u7B2C 16 \u7AE0\u5219\u662F\u4E00\u4E9B\u6700\u4F73\u5B9E\u8DF5\u3002</p><h1 id="_1-\u6982\u89C8" tabindex="-1"><a class="header-anchor" href="#_1-\u6982\u89C8" aria-hidden="true">#</a> 1. \u6982\u89C8</h1><p>Overview</p><p>make \u5DE5\u5177\u53EF\u4EE5\u81EA\u52A8\u786E\u5B9A\u4E00\u4E2A\u5927\u578B\u7A0B\u5E8F\u4E2D\u7684\u54EA\u4E9B\u90E8\u5206\u9700\u8981\u66F4\u65B0,\u5E76\u6267\u884C\u547D\u4EE4\u91CD\u65B0\u7F16\u8BD1\u8FD9\u4E9B\u90E8\u5206. \u672C\u624B\u518C\u63CF\u8FF0make\u5DE5\u5177\u7684\u7528\u6CD5. make \u7531 Richard Stallman(\u7406\u67E5\u5FB7\xB7\u65AF\u6258\u66FC) \u548C Roland McGrath(\u7F57\u5170\xB7\u9EA6\u683C\u62C9\u601D) \u5F00\u53D1, \u81EA 3.76 \u4E4B\u540E, \u7531 Paul D. Smith \u5F00\u53D1.</p><p>GNU make \u5DE5\u5177\u517C\u5BB9 POSIX.2 \u4E2D\u7684 6.2 \u8282\u7684\u8981\u6C42.</p><p>\u624B\u518C\u4E2D\u4F7F\u7528 C \u7A0B\u5E8F\u4E3A\u4F8B\u5C55\u793A make \u7684\u7528\u6CD5, \u56E0\u4E3AC\u7A0B\u6700\u5E38\u89C1\uFF0C\u4F46make\u4E0D\u4EC5\u9650\u4E8E\u5904\u7406C\u7A0B\u5E8F, \u4EFB\u4F55\u53EF\u4EE5\u4F7F\u7528shell\u547D\u4EE4\u7F16\u8BD1\u7684\u7A0B\u5E8F\u90FD\u53EF\u4EE5\u3002\u5B9E\u9645\u4E0A make \u4E0D\u4EC5\u9650\u4E8E\u7F16\u7A0B\u8BED\u8A00\u3002 \u4EFB\u4F55\u7B26\u5408\u4F9D\u8D56+\u66F4\u65B0+shell\u547D\u4EE4\u7684\u4EFB\u52A1\u90FD\u53EF\u4EE5\u3002 ps: \u4F46c\u5374\u662F\u6700\u5951\u5408\u7684,\u56E0\u4E3A make \u5C31\u662F\u4E3A\u8FD9\u4E00\u76EE\u6807\u4E3A\u52A8\u673A\u5F00\u53D1\u7684.</p><h2 id="\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u51C6\u5907" aria-hidden="true">#</a> \u51C6\u5907</h2><p>\u4E3A\u4E86\u4F7F\u7528 make, \u4F60\u9700\u8981\u7F16\u5199\u4E00\u4E2A makefile \u6587\u4EF6, \u5B83\u63CF\u8FF0\u4E86\u4F60\u7684\u7A0B\u5E8F\u7684\u5404\u4E2A\u6587\u4EF6\u4E4B\u95F4\u7684 \u5173\u7CFB\u4EE5\u53CA\u5982\u4F55\u91CD\u65B0\u7F16\u8BD1\u4ED6\u4EEC\u9700\u8981\u6267\u884C\u7684\u547D\u4EE4.</p><p>\u5982\u679C\u4F60\u4E3A\u81EA\u5DF1\u7684\u9879\u76EE\u7F16\u5199\u4E86\u5408\u9002\u7684 makefile, \u5219\u6BCF\u5F53\u4F60\u4FEE\u6539\u4E86\u67D0\u4E2A\u6E90\u4EE3\u7801\u4E4B\u540E,\u53EA\u9700\u8981\u6267\u884C \u4E00\u6761\u7B80\u5355\u7684\u547D\u4EE4<code>make</code>\u5C31\u80FD\u5B8C\u6210\u6240\u6709\u5FC5\u8981\u7684\u66F4\u65B0. make \u547D\u4EE4\u4F7F\u7528 makefile \u4E2D\u7684\u4FE1\u606F\u4EE5\u53CA \u6BCF\u4E2A\u6587\u4EF6\u7684\u6700\u65B0\u4FEE\u6539\u65F6\u95F4\u51B3\u5B9A\u90A3\u4E9B\u6587\u4EF6\u9700\u8981\u66F4\u65B0, \u66F4\u65B0\u6587\u4EF6\u8981\u6267\u884C\u7684\u547D\u4EE4\u540C\u6837\u5728makefile\u4E2D \u63D0\u4F9B.</p><p>\u8FD8\u53EF\u4EE5\u901A\u8FC7\u547D\u4EE4\u884C\u63A7\u5236make\u66F4\u65B0\u54EA\u4E9B\u6587\u4EF6.</p><h2 id="_1-1-\u5982\u4F55\u9605\u8BFB\u672C\u624B\u518C" tabindex="-1"><a class="header-anchor" href="#_1-1-\u5982\u4F55\u9605\u8BFB\u672C\u624B\u518C" aria-hidden="true">#</a> 1.1 \u5982\u4F55\u9605\u8BFB\u672C\u624B\u518C</h2><p>\u5982\u679C\u662F\u4F60\u65B0\u624B\u6216\u8005\u53EA\u8981\u4E86\u89E3make\u7684\u5927\u6982\u7528\u6CD5\uFF0C\u90A3\u4E48\u53EA\u9700\u8981\u9605\u8BFB\u6BCF\u7AE0\u7684\u524D\u51E0\u4E2A\u5C0F\u8282\u5373\u53EF\uFF0C\u56E0\u4E3A\u6BCF\u7AE0 \u4E2D\u7684\u524D\u9762\u7684\u5C0F\u8282\u662F\u7B80\u8981\u4ECB\u7ECD\uFF0C\u800C\u540E\u9762\u7684\u7AE0\u8282\u5219\u662F\u6DF1\u5165\u8BB2\u89E3\u3002\u7B2C\u4E8C\u7AE0\u662F\u4F8B\u5916\uFF0C\u6B64\u7AE0\u7684\u6574\u4E2A\u7AE0\u8282\u90FD\u662F \u4ECB\u7ECD\u6027\u7684\u5185\u5BB9\u3002 \u5982\u679C\u4F60\u662F\u5BF9\u5176\u4ED6make\u5DE5\u5177\u719F\u6089\uFF0C\u53EF\u4EE5\u9605\u8BFBFeatures of GNU make\u548C Incompatibilities and Missing Features\u8FD9\u4E24\u4E2A\u7AE0\u8282\u3002 \u5982\u679C\u5FEB\u901F\u770B\u4E00\u904D\u6982\u8981\uFF0C\u53BB\u770B\u3000Options Summary,\u3000Quick Reference\u548C Special Targets.</p><h2 id="_1-2-\u95EE\u9898\u548Cbug" tabindex="-1"><a class="header-anchor" href="#_1-2-\u95EE\u9898\u548Cbug" aria-hidden="true">#</a> 1.2 \u95EE\u9898\u548Cbug</h2><p>\u8FD9\u91CC\u4ECB\u7ECD\u5982\u4F55\u63D0\u51FAbug\u3002</p><ul><li>\u4E0D\u4FDD\u8BC1\u4E00\u5B9A\u89E3\u51B3\uFF0C\u4F46\u4E00\u822C\u4F1A\u4FEE\u590D</li><li>\u4ED4\u7EC6\u786E\u8BA4\u786E\u5B9E\u662Fbug</li><li>\u63D0\u4EA4bug\u8981\u63D0\u4F9B\u53EF\u4EE5\u590D\u73B0\u95EE\u9898\u7684\u6700\u5C0Fmakile\u6587\u4EF6\uFF0C\u5B8C\u6574\u7684\u9519\u8BEF\u8F93\u51FA\uFF0C\u7ED9\u51FA\u4F60\u7684\u671F\u671B\u7ED3\u679C</li><li>\u5E26\u4E0Amake\u5DE5\u5177\u7684\u7248\u672C\u53F7</li></ul><h1 id="_2-makefile\u6587\u4EF6\u7684\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_2-makefile\u6587\u4EF6\u7684\u4ECB\u7ECD" aria-hidden="true">#</a> 2. Makefile\u6587\u4EF6\u7684\u4ECB\u7ECD</h1><p>\u4F60\u9700\u8981\u7528\u88AB\u79F0\u4E3Amakfile\u7684\u6587\u4EF6\u544A\u8BC9make\u5DE5\u5177\u505A\u4EC0\u4E48\u3002\u4E00\u822C\u662F\u544A\u8BC9make\u5982\u4F55\u7F16\u8BD1\u548C\u94FE\u63A5\u7A0B\u5E8F\u3002</p><p>\u672C\u624B\u518C\u4F7F\u7528\u4E00\u4E2A\u793A\u4F8B\u7A0B\u5E8F\u4F5C\u4E3A\u4E66\u4E2D\u4F8B\u5B50\u7684\u64CD\u4F5C\u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u7A0B\u5E8F\u662F\u4E00\u4E2A\u6587\u672C\u7F16\u8F91\u5668\uFF0C\u5B83\u75318\u4E2A\u6E90\u4EE3\u7801 \u6587\u4EF6\u548C3\u4E2A\u5934\u6587\u4EF6\u6784\u6210\u3002</p><p>Q. \u8FD9\u4E2A\u7A0B\u5E8F\u7684\u6E90\u6587\u5728\u54EA\u91CC\uFF1F</p><blockquote><p>When make recompiles the editor, each changed C source file must be recompiled. If a header file has changed, each C source file that includes the header file must be recompiled to be safe. Each compilation produces an object file corresponding to the source file. Finally, if any source file has been recompiled, all the object files, whether newly made or saved from previous compilations, must be linked together to produce the new executable editor.</p></blockquote><p>\u672C\u7AE0\u6982\u8981\uFF1A</p><ul><li>Rule Introduction What a rule looks like.</li><li>Simple Makefile A simple makefile.</li><li>How Make Works How make processes this makefile.</li><li>Variables Simplify Variables make makefiles simpler.</li><li>make Deduces Letting make deduce the recipes.</li><li>Combine By Prerequisite Another style of makefile.</li><li>Cleanup Rules for cleaning the directory.</li></ul><h2 id="_2-1-what-a-rule-looks-like" tabindex="-1"><a class="header-anchor" href="#_2-1-what-a-rule-looks-like" aria-hidden="true">#</a> 2.1 What a Rule Looks Like</h2><p>makefile \u7684\u57FA\u672C\u7EC4\u6210\u5143\u7D20\u662F rule\u3002 \u4E00\u4E2A rule \u7531 targte\u3001prerequisite\u3001recipe \u4E09\u90E8\u5206\u6784\u6210\uFF0Ctarget \u662F\u5FC5\u987B\u7684\uFF0Cprerequisite \u548C recipe \u53EF\u4EE5\u7701\u7565\u5176\u4E00\uFF0C\u4F46\u4E0D\u8BB8\u540C\u65F6\u7701\u7565\u3002 rule \u8BF4\u660E\u4F55\u65F6\u4EE5\u53CA\u5982\u4F55\u66F4\u65B0target\u3002 target \u5206\u4E3A\u4E24\u79CD\uFF0C\u666E\u901A target \u5BF9\u5E94\u751F\u6210\u7684\u6587\u4EF6\uFF0Cphony target\uFF08\u4F2A\u76EE\u6807\uFF09\u6307\u5B9A\u8981\u6267\u884C\u7684\u52A8\u4F5C\u7684\u540D\u79F0\u3002 recipe \u4E2D\u7684\u6BCF\u4E00\u884C\u90FD\u5F97\u4EE5 tab \u5B57\u7B26\u5F00\u5934\u3002\u4E5F\u53EF\u4EE5\u6539\u4E3A\u5176\u5B83\u5B57\u7B26\u5F00\u5934\uFF0C\u8BBE\u7F6E .RECIPEPREFIX \u53D8\u91CF\u5373\u53EF\u3002</p><p>\u89C4\u5219\u7684\u6784\u6210\u5F62\u5F0F\u5982\u4E0B\uFF1A</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>target \u2026 : prerequisites \u2026
        recipe
        \u2026
        \u2026
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>A <code>target</code> is usually the name of a file that is generated by a program; examples of targets are executable or object files. A target can also be the name of an action to carry out, such as \u2018clean\u2019 (see Phony Targets).</p><p>A <code>prerequisite</code> is a file that is used as input to create the target. A target often depends on several files.</p><p>A <code>recipe</code> is an action that make carries out. A recipe may have more than one command, either on the same line or each on its own line. Please note: you need to put a tab character at the beginning of every recipe line! This is an obscurity that catches the unwary. If you prefer to prefix your recipes with a character other than tab, you can set the .RECIPEPREFIX variable to an alternate character (see Special Variables).</p><p>makefile \u53EF\u4EE5\u5305\u542B\u89C4\u5219\u4E4B\u5916\u7684\u5185\u5BB9\uFF0C\u4F46\u57FA\u7840\u7684makefile\u6587\u4EF6\u53EA\u9700\u8981\u5305\u542B\u89C4\u5219\u5C31\u591F\u4E86\u3002 \u5B9E\u9645\u7684makefile\u6BD4\u8FD9\u91CC\u7684\u793A\u4F8B\u8981\u590D\u6742\u4E00\u4E9B\uFF0C\u4F46\u539F\u7406\u90FD\u662F\u4E00\u6837\u7684\u3002</p><h2 id="_2-2-a-simple-makefile" tabindex="-1"><a class="header-anchor" href="#_2-2-a-simple-makefile" aria-hidden="true">#</a> 2.2 A Simple Makefile</h2><p>\u8FD9\u91CC\u662F\u4E00\u4E2A\u7B80\u5355\u7684makefile\u6587\u4EF6\uFF0C\u7528\u4E8E\u7F16\u8BD1\u672C\u672C\u624B\u518C\u4F7F\u7528\u7684\u793A\u4F8B\u7A0B\u5E8F\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">edit</span> <span class="token punctuation">:</span> main.o kbd.o command.o display.o \\
       insert.o search.o files.o utils.o
        cc -o edit main.o kbd.o command.o display.o \\
                   insert.o search.o files.o utils.o

<span class="token symbol">main.o</span> <span class="token punctuation">:</span> main.c defs.h
        cc -c main.c
<span class="token symbol">kbd.o</span> <span class="token punctuation">:</span> kbd.c defs.h command.h
        cc -c kbd.c
<span class="token symbol">command.o</span> <span class="token punctuation">:</span> command.c defs.h command.h
        cc -c command.c
<span class="token symbol">display.o</span> <span class="token punctuation">:</span> display.c defs.h buffer.h
        cc -c display.c
<span class="token symbol">insert.o</span> <span class="token punctuation">:</span> insert.c defs.h buffer.h
        cc -c insert.c
<span class="token symbol">search.o</span> <span class="token punctuation">:</span> search.c defs.h buffer.h
        cc -c search.c
<span class="token symbol">files.o</span> <span class="token punctuation">:</span> files.c defs.h buffer.h command.h
        cc -c files.c
<span class="token symbol">utils.o</span> <span class="token punctuation">:</span> utils.c defs.h
        cc -c utils.c
<span class="token symbol">clean</span> <span class="token punctuation">:</span>
        rm edit main.o kbd.o command.o display.o \\
           insert.o search.o files.o utils.o

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>\u5728\u884C\u672B\u7528 \\ \u53EF\u4EE5\u7EED\u884C\u3002</p><p>\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u7F16\u8BD1\u9879\u76EE\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u6E05\u7406\u76EE\u5F55\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> clean
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>When a target is a file, it needs to be recompiled or relinked if any of its prerequisites change. In addition, any prerequisites that are themselves automatically generated should be updated first. In this example, edit depends on each of the eight object files; the object file main.o depends on the source file main.c and on the header file defs.h.</p><p>recipe \u4E2D\u7684\u6BCF\u884C\u547D\u4EE4\u90FD\u5FC5\u987B\u4EE5tab\u5F00\u5934\u3002</p><p>\u8FD9\u91CC\u7684\u76EE\u6807<code>clean</code>\u4E0D\u662F\u6587\u4EF6\uFF0C\u800C\u4EC5\u662F\u67D0\u4E2A\u52A8\u4F5C\u7684\u540D\u79F0\u3002\u4E00\u822C\u4E0D\u8FD0\u884C\u6B64\u76EE\u6807\uFF0C\u6240\u4EE5\u5B83\u6CA1\u6709\u4F5C\u4E3A\u4EFB\u4F55 \u76EE\u6807\u7684\u524D\u7F6E\u6761\u4EF6\uFF0C\u6240\u4EE5\u4EC5\u5F53\u660E\u786E\u6307\u5B9A\u5B83\u7684\u65F6\u5019\uFF0Cclean\u76EE\u6807\u624D\u4F1A\u88AB\u6267\u884C\uFF1B\u540C\u65F6\u5B83\u6CA1\u6709\u4EFB\u4F55\u524D\u7F6E\u6761\u4EF6\uFF0C \u6240\u4EE5\u8FD9\u6761\u89C4\u5219\u7684\u552F\u4E00\u76EE\u7684\u5C31\u662F\u8FD0\u884C\u6307\u5B9A\u7684recipe\u3002 \u4E0D\u6307\u5411\u6587\u4EF6\uFF0C\u800C\u4EC5\u4F5C\u662F\u4E00\u4E2A\u52A8\u4F5C\u7684target\u53EB\u505A Phony Target\u3002</p><h2 id="_2-3-how-make-processes-a-makefile" tabindex="-1"><a class="header-anchor" href="#_2-3-how-make-processes-a-makefile" aria-hidden="true">#</a> 2.3 How make Processes a Makefile</h2><p>\u7B2C\u4E00\u6761\u89C4\u5219\u7684target\u53EB\u505A default goal\u3002 \u7279\u6B8A\u53D8\u91CF .DEFAULT_GOAL \u53EF\u4EE5\u6307\u5B9A\u81EA\u5B9A\u4E49\u7684 default goal\u3002</p><p>\u76F4\u63A5\u8F93\u5165make\uFF0C\u4E0D\u5E26\u4EFB\u4F55\u53C2\u6570\uFF0C\u5B83\u6267\u884C\u7684\u5C31\u662F default goal\u3002</p><p>\u4E0B\u9762\u4E00\u6BB5\uFF0C\u8BF4\u660E\u4E86\u6267\u884C make \u547D\u4EE4\u540E\u53D1\u751F\u7684\u4E8B\u60C5\u3002</p><p>Thus, when you give the command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>make reads the makefile in the current directory and begins by processing the first rule. In the example, this rule is for relinking edit; but before make can fully process this rule, it must process the rules for the files that edit depends on, which in this case are the object files. Each of these files is processed according to its own rule. These rules say to update each \u2018.o\u2019 file by compiling its source file. The recompilation must be done if the source file, or any of the header files named as prerequisites, is more recent than the object file, or if the object file does not exist.</p><p>The other rules are processed because their targets appear as prerequisites of the goal. If some other rule is not depended on by the goal (or anything it depends on, etc.), that rule is not processed, unless you tell make to do so (with a command such as make clean).</p><p>Before recompiling an object file, make considers updating its prerequisites, the source file and header files. This makefile does not specify anything to be done for them\u2014the \u2018.c\u2019 and \u2018.h\u2019 files are not the targets of any rules\u2014so make does nothing for these files. But make would update automatically generated C programs, such as those made by Bison or Yacc, by their own rules at this time.</p><p>After recompiling whichever object files need it, make decides whether to relink edit. This must be done if the file edit does not exist, or if any of the object files are newer than it. If an object file was just recompiled, it is now newer than edit, so edit is relinked.</p><p>Thus, if we change the file insert.c and run make, make will compile that file to update insert.o, and then link edit. If we change the file command.h and run make, make will recompile the object files kbd.o, command.o and files.o and then link the file edit.</p><h2 id="_2-4-variables-make-makefiles-simpler" tabindex="-1"><a class="header-anchor" href="#_2-4-variables-make-makefiles-simpler" aria-hidden="true">#</a> 2.4 Variables Make Makefiles Simpler</h2><p>\u8BF4\u4E0A\u9762\u8FD9\u4E2A\u7B80\u5355\u7684 Makefile \u8981\u624B\u52A8\u5217\u51FA\u6240\u6709 .o \u6587\u4EF6\uFF0C\u5217\u51FA\u4E86\u4E24\u6B21\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">edit</span> <span class="token punctuation">:</span> main.o kbd.o command.o display.o \\
              insert.o search.o files.o utils.o
        cc -o edit main.o kbd.o command.o display.o \\
                   insert.o search.o files.o utils.o
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u8FD9\u5BB9\u6613\u51FA\u9519\uFF0C\u6BD4\u5982\u5F53\u65B0\u589E\u4E00\u4E2A .o \u6587\u4EF6\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u53EF\u80FD\u53EA\u66F4\u65B0\u4E86\u5176\u4E2D\u4E00\u4E2A\u5730\u65B9\uFF0C\u800C\u5FD8\u8BB0\u66F4\u65B0\u53E6\u4E00\u4E2A\u5730\u65B9\u3002 \u53D8\u91CF\u5E2E\u52A9\u89E3\u964D\u4F4E\u8FD9\u65B9\u9762\u7684\u98CE\u9669\u3002\u53D8\u91CF\u53EF\u4EE5\u8BA9\u4E00\u4E2A\u5B57\u7B26\u4E32\u5728\u4E00\u5904\u5B9A\u4E49\u7136\u540E\u5728\u522B\u5904\u591A\u6B21\u5F15\u7528\u3002</p><p>\u6700\u4F73\u5B9E\u8DF5\uFF1A\u628A\u6240\u6709\u7684\u76EE\u6807\u6587\u4EF6\u540D\u653E\u5728\u4E00\u4E2A\u53EB\u505A objects \u7684\u53D8\u91CF\u4E2D\u3002 \u7136\u540E\u51E1\u662F\u7528\u5230\u76EE\u6807\u6587\u4EF6\u5217\u8868\u7684\u5730\u65B9\u90FD\u7528 $(objects) \u4EE3\u66FF\u3002</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>objects = main.o kbd.o command.o display.o \\
          insert.o search.o files.o utils.o
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>objects = main.o kbd.o command.o display.o \\
          insert.o search.o files.o utils.o

edit : $(objects)
        cc -o edit $(objects)
main.o : main.c defs.h
        cc -c main.c
kbd.o : kbd.c defs.h command.h
        cc -c kbd.c
command.o : command.c defs.h command.h
        cc -c command.c
display.o : display.c defs.h buffer.h
        cc -c display.c
insert.o : insert.c defs.h buffer.h
        cc -c insert.c
search.o : search.c defs.h buffer.h
        cc -c search.c
files.o : files.c defs.h buffer.h command.h
        cc -c files.c
utils.o : utils.c defs.h
        cc -c utils.c
clean :
        rm edit $(objects)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_2-5-letting-make-deduce-the-recipes" tabindex="-1"><a class="header-anchor" href="#_2-5-letting-make-deduce-the-recipes" aria-hidden="true">#</a> 2.5 Letting make Deduce the Recipes</h2><p>\u6CA1\u6709\u5FC5\u8981\u628A\u6240\u6709\u7F16\u8BD1\u5355\u4E2Ac\u6587\u4EF6\u7684\u89C4\u5219\u90FD\u6572\u51FA\u6765\uFF0C\u56E0\u4E3Amake\u4F1A\u81EA\u52A8\u5224\u65AD\u51FA\u7F16\u8BD1 .o \u6587\u4EF6\u7684\u65B9\u5F0F\uFF0C\u8FD9 \u5F52\u529F\u4E8E\u9690\u5F0F\u89C4\u5219(implicit rule)\u3002</p><p>\u8FD9\u91CC\u7528\u5230\u7684\u9690\u5F0F\u89C4\u5219\u4F1A\u81EA\u52A8\u628A .c \u6587\u4EF6\u6DFB\u52A0\u4E3A .o \u6587\u4EF6\u7684 prerequisite\uFF0C\u6240\u4EE5\u4E0D\u5FC5\u518D\u663E\u5F0F\u5217\u51FA .o \u6587\u4EF6\u4F9D\u8D56\u7684 .c \u6587\u4EF6\u4E86\u3002</p><p>\u7EFC\u5408\u53D8\u91CF\u548C\u9690\u5F0F\u89C4\u5219\uFF0C\u793A\u4F8B\u4E2D\u7684makefile\u53EF\u4EE5\u8FDB\u4E00\u6B65\u7CBE\u7B80\u4E3A\u4E0B\u9762\u8FD9\u6837\u3002</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>objects = main.o kbd.o command.o display.o \\
          insert.o search.o files.o utils.o

edit : $(objects)
        cc -o edit $(objects)

main.o : defs.h
kbd.o : defs.h command.h
command.o : defs.h command.h
display.o : defs.h buffer.h
insert.o : defs.h buffer.h
search.o : defs.h buffer.h
files.o : defs.h buffer.h command.h
utils.o : defs.h

.PHONY : clean
clean :
        rm edit $(objects)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u8FD9\u624D\u662F\u6211\u4EEC\u5B9E\u9645\u4F7F\u7528\u7684makefile\u7684\u6837\u5B50\u3002</p><p>\u9690\u5F0F\u89C4\u5219\u5341\u5206\u65B9\u4FBF\uFF0C\u4F60\u4F1A\u7ECF\u5E38\u7528\u5230\u4ED6\u4EEC\u3002\u6240\u4EE5\u8981\u638C\u63E1\u597D\u9690\u5F0F\u89C4\u5219\u3002</p><h2 id="_2-6-\u53E6\u4E00\u79CD\u98CE\u683C\u7684-makefile" tabindex="-1"><a class="header-anchor" href="#_2-6-\u53E6\u4E00\u79CD\u98CE\u683C\u7684-makefile" aria-hidden="true">#</a> 2.6 \u53E6\u4E00\u79CD\u98CE\u683C\u7684 makefile</h2><p>\u524D\u9762\u7684\u793A\u4F8B\u4E2D\uFF0C\u6309 .o \u6587\u4EF6\u7EC4\u7EC7\u89C4\u5219\u3002\u8FD8\u6709\u4E00\u79CD\u98CE\u683C\uFF0C\u6839\u636E\u88AB\u4F9D\u8D56\u7684 .h \u6587\u4EF6\u5206\u7EC4\u7EC4\u7EC7\u89C4\u5219\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>objects = main.o kbd.o command.o display.o \\
          insert.o search.o files.o utils.o

edit : $(objects)
        cc -o edit $(objects)

$(objects) : defs.h
kbd.o command.o files.o : command.h
display.o insert.o search.o files.o : buffer.h
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u54EA\u79CD\u98CE\u683C\u597D\uFF0C\u770B\u4E2A\u4EBA\u559C\u597D\u3002\u8FD9\u79CD\u98CE\u683C\u66F4\u7D27\u51D1\uFF0C\u4F46\u7B2C\u4E00\u79CD\u98CE\u683C\u628A\u76EE\u6807\u7684\u6240\u6709\u4F9D\u8D56\u90FD\u5217\u5728\u4E00\u5904\uFF0C\u6240\u4EE5\u66F4\u6E05\u6670\u3002</p><h2 id="_2-7-\u6E05\u7406\u76EE\u5F55\u7684\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_2-7-\u6E05\u7406\u76EE\u5F55\u7684\u89C4\u5219" aria-hidden="true">#</a> 2.7 \u6E05\u7406\u76EE\u5F55\u7684\u89C4\u5219</h2><p>\u9664\u4E86\u7F16\u8BD1\u7A0B\u5E8F\uFF0C\u6709\u65F6\u5019\u8FD8\u5E0C\u671B\u7528\u89C4\u5219\u5199\u70B9\u522B\u7684\u4EFB\u52A1\uFF0C\u6BD4\u5982\u6E05\u7406\u76EE\u5F55\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">clean</span><span class="token punctuation">:</span>
        rm edit <span class="token variable">$</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4E3A\u4E86\u66F4\u51C6\u786E\u5730\u8868\u8FBE\u6211\u4EEC\u7684\u610F\u56FE\uFF0C\u907F\u514D\u610F\u5916\u60C5\u51B5\uFF0C\u7A0D\u5FAE\u6539\u5199\u4E00\u4E0B</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> clean
<span class="token symbol">clean</span><span class="token punctuation">:</span>
        -rm edit <span class="token variable">$</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5F53\u771F\u7684\u5B58\u5728\u540D\u4E3A clean \u7684\u6587\u4EF6\u65F6\uFF0Cmake \u4F1A\u7591\u60D1\uFF0C\u6240\u4EE5\u7528<code>.PHONY: clean</code>\u544A\u8BC9make\u8FD9\u662F\u4E2A\u4F2A\u76EE\u6807\u3002 rm\u547D\u4EE4\u7B7E\u524D\u9762\u7684 - \u8868\u793A\u5FFD\u7565\u547D\u4EE4\u7684\u9519\u8BEF\u3002</p><h1 id="_3-writing-makefiles" tabindex="-1"><a class="header-anchor" href="#_3-writing-makefiles" aria-hidden="true">#</a> 3 Writing Makefiles</h1><blockquote><p>The information that tells make how to recompile a system comes from reading a data base called the makefile.</p></blockquote><h2 id="_3-1-makefile-\u5305\u542B\u7684\u5143\u7D20" tabindex="-1"><a class="header-anchor" href="#_3-1-makefile-\u5305\u542B\u7684\u5143\u7D20" aria-hidden="true">#</a> 3.1 Makefile \u5305\u542B\u7684\u5143\u7D20</h2><p>What Makefiles Contain</p><p>makefile \u5305\u542B\u4E94\u79CD\u9876\u7EA7\u8BED\u6CD5\u5143\u7D20\u3002</p><ul><li>Explicit rules</li><li>Implicit rules</li><li>Variable definitions</li><li>Directives</li><li>Comments</li></ul><p>\u7EED\u884C\u7B26\u4E0D\u53D7\u6CE8\u91CA\u7684\u5F71\u54CD\u3002 \u53D8\u91CF\u5F15\u7528\u548C\u51FD\u6570\u5F15\u7528\u4E2D\u7684\u4E95\u53F7\u4E0D\u505A\u6CE8\u91CA\u89E3\u91CA\u3002 recipe \u4E2D\u7684\u6CE8\u91CA\u4F1A\u539F\u6837\u4F20\u9012\u7ED9shell\u3002 define \u4E2D\u7684\u6CE8\u91CA\uFF0C\u4F1A\u5E26\u5230\u53D8\u91CF\u5B9A\u4E49\u4E2D\u3002</p>`,83),sa=a("An explicit rule says when and how to remake one or more files, called the rule\u2019s targets. It lists the other files that the targets depend on, called the prerequisites of the target, and may also give a recipe to use to create or update the targets. See "),na={href:"https://www.gnu.org/software/make/manual/make.html#Rules",title:"\u7B2C\u56DB\u7AE0",target:"_blank",rel:"noopener noreferrer"},ia=a("Writing Rules"),la=a("."),ta=a("An implicit rule says when and how to remake a class of files based on their names. It describes how a target may depend on a file with a name similar to the target and gives a recipe to create or update such a target. See "),ra={href:"https://www.gnu.org/software/make/manual/make.html#Implicit-Rules",title:"\u7B2C\u5341\u7AE0",target:"_blank",rel:"noopener noreferrer"},pa=a("Using Implicit Rules"),oa=a("."),ca=t("<li><p>A variable definition is a line that specifies a text string value for a variable that can be substituted into the text later. The simple makefile example shows a variable definition for objects as a list of all object files (see Variables Make Makefiles Simpler).</p></li><li><p>A directive is an instruction for make to do something special while reading the makefile. These include:</p><ul><li>Reading another makefile (see Including Other Makefiles).</li><li>Deciding (based on the values of variables) whether to use or ignore a part of the makefile (see Conditional Parts of Makefiles).</li><li>Defining a variable from a verbatim string containing multiple lines (see Defining Multi-Line Variables).</li></ul></li><li><p>makefile \u4E2D\u7528\u4E95\u53F7\uFF08<code>#</code>\uFF09\u505A\u5355\u884C\u6CE8\u91CA\u5B57\u7B26\u3002\u4E95\u53F7\u76F4\u5230\u884C\u672B\u90FD\u662F\u6CE8\u91CA\uFF0C\u5982\u679C\u884C\u672B\u6709\u672A\u8F6C\u4E49\u7684\u53CD\u659C\u6760\u7EED\u884C\uFF0C\u5219\u6CE8\u91CA\u4F1A\u8513\u5EF6\u5230\u591A\u884C\u3002 \u4EC5\u542B\u6CE8\u91CA\u7684\u884C\uFF08\u5F00\u5934\u53EF\u4EE5\u6709\u7A7A\u767D\u5B57\u7B26\uFF09\u7B49\u6548\u4E8E\u7A7A\u767D\uFF0C\u4F1A\u88AB\u5FFD\u7565\u3002\u8981\u5C06\u4E95\u53F7\u4F5C\u4E3A\u666E\u901A\u5B57\u7B26\u63D2\u5165\uFF0C\u53EF\u4EE5\u7528\u53CD\u659C\u6760\u8F6C\u4E49<code>\\#</code>\u3002 \u6CE8\u91CA\u53EF\u4EE5\u51FA\u73B0\u5728 makefile \u7684\u4EFB\u4F55\u4E00\u884C\uFF0C\u5C3D\u7BA1\u67D0\u4E9B\u5730\u65B9\u4F1A\u5BF9\u6CE8\u91CA\u505A\u7279\u6B8A\u5904\u7406\u3002</p><p>\u51FD\u6570\u8C03\u7528\u548C\u53D8\u91CF\u5F15\u7528\u4E2D\u7684\u4E95\u53F7\u4E0D\u7B97\u6CE8\u91CA\u3002</p><p>recipe \u4E2D\u7684\u6CE8\u91CA\u4F1A\u539F\u6837\u4F20\u9012\u7ED9 shell\uFF0C\u5230\u4E86shell\u4E2D\u662F\u5426\u662F\u6CE8\u91CA\u5219\u8981\u770Bshell\u7684\u8BED\u6CD5\u89C4\u5219\u3002</p><p>define \u6307\u4EE4\u4E2D\uFF0C\u6CE8\u91CA\u4E5F\u4F1A\u5305\u542B\u5728\u53D8\u91CF\u503C\u4E2D\uFF0C\u5F53\u53D8\u91CF\u5C55\u5F00\u7684\u65F6\u5019\uFF0C\u6CE8\u91CA\u4F1A\u4E00\u5E76\u5E26\u8FC7\u53BB\uFF0C\u7136\u540E\u6839\u636E\u53D8\u91CF\u5C55\u5F00 \u7684\u4F4D\u7F6E\u89E3\u91CA\u4E3Amakefile\u7684\u6CE8\u91CA\u6216\u8005recipe\u6587\u672C\u3002</p></li>",3),ua=t(`<h3 id="_3-1-1-\u7EED\u884C" tabindex="-1"><a class="header-anchor" href="#_3-1-1-\u7EED\u884C" aria-hidden="true">#</a> 3.1.1 \u7EED\u884C</h3><p>Splitting Long Lines</p><p>Makefile \u4E2D\uFF0C\u6362\u884C\u7B26\u6807\u5FD7\u8BED\u53E5\u7684\u7ED3\u675F\u3002\u4E0D\u9650\u5236\u884C\u7684\u957F\u5EA6\u3002</p><p>\u4E00\u884C\u592A\u957F\uFF0C\u4E0D\u4FBF\u4E8E\u9605\u8BFB\uFF0C\u6240\u4EE5\u63D0\u4F9B\u4E86\u7EED\u884C\u7684\u8BED\u6CD5\u3002 \u4E3A\u4E86\u533A\u5206\uFF0C\u5B9A\u4E49\u7269\u7406\u884C\u548C\u903B\u8F91\u884C\u3002</p><p><strong>\u659C\u6760+\u6362\u884C</strong>\u6784\u6210\u7EED\u884C\u3002\u5728 recipe \u4E2D\u548C recipe \u4E4B\u5916\u7684\u7EED\u884C\u5904\u7406\u7565\u6709\u4E0D\u540C\u3002</p><p>recipe \u4E4B\u5916\u7684\u5730\u65B9\u7684\u7EED\u884C\uFF08\u659C\u6760+\u6362\u884C\uFF09\u4F1A\u66FF\u6362\u4E3A\u5355\u4E2A\u7A7A\u683C\u3002\u5305\u62EC</p><ul><li>\u7EED\u884C\u524D\u540E\u7684\u7A7A\u767D</li><li>\u8FDE\u7EED\u7684\u7EED\u884C</li></ul><p>\u4F8B\u5982\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>foo=hello       \\
                world
bar=hello\\
world
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7B49\u4EF7\u4E8E</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>foo=hello world
bar=hello world
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u60F3\u8981\u53BB\u6389\u8FD9\u884C\u9020\u6210\u7684\u7A7A\u683C\uFF0C\u53EF\u4EE5\u4F7F\u7528\u8FD9\u6837\u4E00\u4E2A\u53D8\u901A\u7684\u6CD5\u5B50\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>var := one$\\
       word
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u7B49\u4EF7\u4E8E <code>var := one$ world</code> \u800C\u5176\u4E2D <code>$ </code> \u4F1A\u88AB\u89E3\u91CA\u4E3A\u53D8\u91CF\u66FF\u6362\uFF0C\u53D8\u91CF\u7684\u540D\u5B57\u662F\u5355\u4E2A\u7A7A\u4E2A\u5B57\u7B26\uFF0C \u8FD9\u4E2A\u53D8\u91CF\u672A\u5B9A\u4E49\uFF0C\u6240\u4EE5\u5C55\u5F00\u4E3A\u7A7A\u5B57\u7B26\uFF1A<code>var :=oneworld</code>\u3002</p>`,14),da=a("recipe \u4E2D\u7684\u7EED\u884C\uFF0C\u542B\u4E49\u6709\u4E9B\u4E0D\u540C\u3002\u53C2\u89C1 "),ma={href:"https://www.gnu.org/software/make/manual/make.html#Splitting-Recipe-Lines",target:"_blank",rel:"noopener noreferrer"},ha=a("5.1.1 Splitting Recipe Lines"),ba=t(`<h2 id="_3-2-\u6307\u5B9A-makefile-\u6587\u4EF6\u8DEF\u5F84" tabindex="-1"><a class="header-anchor" href="#_3-2-\u6307\u5B9A-makefile-\u6587\u4EF6\u8DEF\u5F84" aria-hidden="true">#</a> 3.2 \u6307\u5B9A makefile \u6587\u4EF6\u8DEF\u5F84</h2><p>\u9996\u5148\uFF0C\u53EF\u4EE5\u4F7F\u7528 -f --file \u6307\u5B9Amakefile\u7684\u540D\u5B57\u3002 \u5176\u6B21\uFF0C\u5982\u679C\u6CA1\u6709\u4F7F\u7528 -f \u9009\u9879\uFF0CGNU make \u4F1A\u4F9D\u6B21\u5C1D\u8BD5 GNUmakefile, Makefile, makefles\uFF0C</p><p>\u53EF\u4EE5\u591A\u6B21\u6307\u5B9A -f \u9009\u9879\uFF0Cmake \u4F1A\u628A\u8FD9\u4E9B\u6587\u4EF6\u7684\u5185\u5BB9\u6309\u987A\u5E8F\u62FC\u63A5\u8D77\u6765\u3002 \u4E00\u65E6\u6307\u5B9A -f \u9009\u9879\uFF0Cmake \u5C31\u4E0D\u4F1A\u5C1D\u8BD5\u9ED8\u8BA4\u6587\u4EF6\u540D\u3002</p><p>\u5982\u679C\u8FD9\u4E9B\u6587\u4EF6\u540D\u90FD\u4E0D\u5B58\u5728\uFF0Cmake \u4E0D\u4F1A\u4F7F\u7528\u4EFB\u4F55 makefile\uFF0C\u6B64\u65F6\u5FC5\u987B\u5728\u547D\u4EE4\u884C\u4E2D\u6307\u5B9A\u8981\u6784\u5EFA\u7684\u76EE\u6807\uFF0C make \u4F1A\u5C1D\u8BD5\u7528\u5185\u7F6E\u89C4\u5219\u6784\u5EFA\u6307\u5B9A\u7684\u76EE\u6807\u3002</p><p>PS\uFF1A\u5982\u679C\u627E\u4E0D\u5230\u6784\u5EFA\u76F8\u5173\u76EE\u6807\u7684\u89C4\u5219\uFF0C\u4F1A\u62A5\u9519:<code>make: *** No rule to make target &#39;foo&#39;. Stop.</code>\uFF1B PS\uFF1A\u66F4\u591A\u7EC6\u8282\uFF0C\u5F85\u6211\u6316\u6398\u3002</p><h2 id="_3-3-\u5305\u542B\u5176\u5B83makefile" tabindex="-1"><a class="header-anchor" href="#_3-3-\u5305\u542B\u5176\u5B83makefile" aria-hidden="true">#</a> 3.3 \u5305\u542B\u5176\u5B83makefile</h2><p>include \u6307\u4EE4\u7528\u4E8E\u5305\u542B\u5176\u4ED6makeilfe\u6587\u4EF6\u3002make \u5904\u7406\u5230include\u6307\u4EE4\u7684\u65F6\u5019\u4F1A\u6682\u505C\u5904\u7406\u5F53\u524D makefile\uFF0C\u8F6C\u800C\u8BFB\u53D6include\u6307\u5B9A\u7684makefile\uFF0C\u5F85\u5904\u7406\u5B8C\u6210\u540E\uFF0C\u4ECEinclude\u6307\u4EE4\u5904\u7EE7\u7EED\u5904\u7406\u5F53\u524D makefile\u3002</p><p>\u5305\u542B\u6307\u4EE4\u6837\u5B50\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>include filenames...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>\u7A7A\uFF1Afilesnames \u53EF\u4EE5\u662F\u7A7A\uFF0C\u4E0D\u4F1A\u62A5\u9519\uFF0Cmake \u4E0D\u8BFB\u4EFB\u4F55\u6587\u4EF6\u3002</li><li>\u7A7A\u683C\uFF1Ainlcude \u524D\u9762\u53EF\u4EE5\u6709\u7A7A\u683C\uFF0C\u4F1A\u88AB\u5FFD\u7565\u3002\u4F46\u5F00\u5934\u7B2C\u4E00\u4E2A\u5B57\u7B26\u4E0D\u53EF\u4EE5\u662Ftab\uFF08.RECIPEPREFIX\u5B57\u7B26\uFF09\u3002</li></ul><p>include \u548C\u5176\u540E\u7684\u6587\u4EF6\u540D\u4E4B\u95F4\u5FC5\u987B\u6709\u4E00\u4E2A\u7A7A\u683C\uFF0C\u591A\u4E2A\u6587\u4EF6\u540D\u4E4B\u95F4\u4E5F\u5FC5\u987B\u6709\u4E00\u4E2A\u7A7A\u683C\u3002\u4E00\u4E2A\u7A7A\u683C\u5C31\u591F\uFF0C \u4F46\u591A\u4E86\u4E5F\u6CA1\u95EE\u9898\u3002</p><ul><li>\u6CE8\u91CA\uFF1Ainclude\u6307\u4EE4\u884C\u7684\u672B\u5C3E\u53EF\u4EE5\u6709 # \u5F15\u5BFC\u7684\u6CE8\u91CA</li><li>\u53D8\u91CF\u548C\u51FD\u6570\uFF1A\u53D8\u91CF\u548C\u51FD\u6570\u5F15\u7528\u4F1A\u5C55\u5F00\u4E3A\u5BF9\u5E94\u7684\u6587\u4EF6\u540D\u540E\u518Dinclude\u3002</li></ul><p>\u5047\u8BBE\u6709\u4E09\u4E2A .mk \u6587\u4EF6\uFF1Aa.mk, b.mk, and c.mk, and $(bar) \u6269\u5C55\u4E3A bish bash\uFF0C\u5219</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">include</span> foo *.mk <span class="token variable">$</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7B49\u4EF7\u4E8E</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">include</span> foo a.mk b.mk c.mk bish bash
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u4F7F\u7528 include \u6307\u5B9A\u7684\u573A\u666F\u3002</p><ul><li>\u591A\u4E2A\u7A0B\u5E8F\u7528\u5728\u4E0D\u540C\u76EE\u5F55\u4E2D\u7528\u4E0D\u540C\u7684makefile\u6784\u5EFA\uFF0C\u4E14\u8FD9\u4E9Bmakefile\u6709\u516C\u5171\u7684\u53D8\u91CF\u8BBE\u7F6E\u6216\u6A21\u5F0F\u89C4\u5219\u8BBE\u7F6E\u3002 Q. \u662F\u6BCF\u4E2Amakefile\u90FD\u5305\u542B\u4E00\u6B21\u516C\u5171makefile\uFF0C\u8FD8\u662F\u628A\u516C\u5171\u914D\u7F6E\u653E\u5230\u4E3Bmakefile\u4E2D\u7136\u540E\u5305\u542B\u6240\u6709\u5B50makefile\uFF1F</li><li>\u5F53\u9700\u8981\u4ECE\u6E90\u6587\u4EF6\u81EA\u52A8\u8BA1\u7B97\u67D0\u4E9B\u4F9D\u8D56\u5173\u7CFB\u65F6\u3002\u6BD4\u5982 C \u7A0B\u5E8F\u7684\u5934\u6587\u4EF6\u5305\u542B\u90A3\u4E2A\u4F8B\u5B50\u3002</li></ul><p>\u5982\u679C\u5728 include \u540E\u9762\u6307\u5B9A\u7684\u6587\u4EF6\u540D\u4E0D\u662F\u7EDD\u5BF9\u8DEF\u5F84\u4E14\u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u4E0D\u5B58\u5728\uFF0Cmake \u4F1A\u4F9D\u6B21\u641C\u7D22\u5982\u4E0B\u76EE\u5F55</p><ul><li>\u9009\u9879 -I --include-dir \u6307\u5B9A\u7684\u76EE\u5F55</li><li>prefix/include (\u901A\u5E38\u662F /usr/local/include) /usr/gnu/include, /usr/local/include, /usr/include\uFF0C\u5982\u679C\u8FD9\u4E9B\u76EE\u5F55\u5B58\u5728\u7684\u8BDD</li></ul>`,20),ka=a("\u5982\u679C\u88AB\u5305\u542B\u7684\u6587\u4EF6\u4E0D\u5B58\u5728\uFF0C\u4F1A\u5148\u7ED9\u51FA\u8B66\u544A\uFF0C\u7136\u540E\u7EE7\u7EED\u5904\u7406\u5F53\u524Dmakefile\uFF0C\u7B49\u8BFB\u53D6\u5B8C\u6210\uFF0Cmake \u5C1D\u8BD5 \u66F4\u65B0\u6240\u6709\u8FC7\u65F6\u548C\u4E0D\u5B58\u5728\u7684makefile\uFF0C\u7136\u540E\u5982\u679C\u8FD8\u6709\u88AB\u5305\u542B\u7684makefile\u65E0\u6CD5\u627E\u5230\uFF0C\u5219\u62A5\u9519\u9000\u51FA\u3002 \u53C2\u8003"),fa={href:"https://www.gnu.org/software/make/manual/make.html#Remaking-Makefiles",title:"3.5 How Makefiles Are Remade",target:"_blank",rel:"noopener noreferrer"},ga=a("How Makefiles Are Remade"),va=t(`<p>\u5982\u679C\u5E0C\u671B\u88AB\u5305\u542B\u7684 makefile \u7F3A\u5931\u6216\u65E0\u6CD5 remade \u65F6\u4E0D\u62A5\u9519\u9000\u51FA\uFF0C\u53EA\u8981\u7528 <code>-include</code> \u4EE3\u66FF <code>include</code> \u6307\u4EE4\u5373\u53EF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">-include</span> filenames\u2026
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u8981\u4FDD\u6301\u4E0E\u5176\u5B83 make \u5DE5\u5177\u517C\u5BB9\uFF0C\u4F7F\u7528 sininclude \u66FF\u4EE3 -include\u3002</p><p>Q. - \u548C include \u4E2D\u95F4\u53EF\u4EE5\u6709\u7A7A\u683C\u5417\uFF1F Ans\uFF1A\u5728 GNU Make 4.3 \u5B9E\u6D4B\uFF0C\u4E0D\u53EF\u4EE5\u3002\u4F1A\u62A5\u9519<code>Makefile:2: *** missing separator. Stop.</code> \u53E6\u5916\uFF0C-include\uFF0C\u5F53\u6587\u4EF6\u4E0D\u5B58\u5728\u65F6\uFF0C\u4E0D\u4EC5\u4E0D\u62A5\u9519\uFF0C\u8FDE\u8B66\u544A\u90FD\u4E0D\u4F1A\u6709\u3002</p><h2 id="_3-4-\u53D8\u91CF-makefiles" tabindex="-1"><a class="header-anchor" href="#_3-4-\u53D8\u91CF-makefiles" aria-hidden="true">#</a> 3.4 \u53D8\u91CF MAKEFILES</h2><p>The Variable MAKEFILES</p><p>\u5982\u679C\u8BBE\u7F6E\u4E86\u73AF\u5883\u53D8\u91CF MAKEFILES \uFF0Cmake \u5148\u8BFB\u53D6\u6B64\u53D8\u91CF\u4E2D\u5217\u51FA\u7684 makefile \u6587\u4EF6\u540D\uFF08\u7528\u7A7A\u683C\u5206\u9694\uFF09\uFF0C\u5728\u4E3Bmakefile\u4E4B\u524D\u3002 \u5BF9\u6B64\u53D8\u91CF\u4E2D\u6587\u4EF6\u7684\u5904\u7406\u7C7B\u4F3C -include \u6307\u4EE4\uFF0C\u4F1A\u641C\u7D22\u76F8\u5173\u8DEF\u5F84\u3001\u6587\u4EF6\u7F3A\u5931\u4E5F\u4E0D\u4F1A\u62A5\u9519\u3002 \u53E6\u5916\uFF0Cmake \u4E0D\u4F1A\u4ECE MAKEFILES \u6307\u5B9A\u7684 makefile \u4EE5\u53CA\u5B83\u4EEC\u5305\u542B\u7684 makefile \u8BA1\u7B97 default goal\u3002 ps\uFF1A\u4F46\u662F\uFF0C\u53EF\u4EE5\u5728 MAKEFILES \u6307\u5B9A\u7684makefile\u4E2D\u8BBE\u7F6E\u7279\u6B8A\u53D8\u91CF .DEFAULT_GOAL\uFF0C\u8BBE\u7F6E default goal\u3002</p><p>Q. MAKEFILES \u4E2D\u7684\u6587\u4EF6\u627E\u4E0D\u5230\uFF0C\u4F1A\u5C1D\u8BD5 remake \u5417\uFF1F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> Makefile
<span class="token variable"><span class="token variable">$(</span>info reading Makefile<span class="token variable">)</span></span>
hello:
        @echo hello, world
<span class="token variable"><span class="token variable">$(</span>info end reading Makefile<span class="token variable">)</span></span>

$ <span class="token function">cat</span> <span class="token function">make</span>
<span class="token variable"><span class="token variable">$(</span>info reading <span class="token function">make</span><span class="token variable">)</span></span>
<span class="token variable"><span class="token variable">$(</span>info end reading <span class="token function">make</span><span class="token variable">)</span></span>
$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">MAKEFILES</span><span class="token operator">=</span>make

<span class="token comment"># \u53EF\u4EE5\u770B\u5230\uFF0Cmake \u5148\u4E8E Makefile \u8BFB\u53D6</span>
$ <span class="token function">make</span>
reading <span class="token function">make</span>
end reading <span class="token function">make</span>
reading Makefile
end reading Makefile
hello, world
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>MAKEFILES \u4E00\u822C\u7528\u5728\u9012\u5F52\u8C03\u7528 make \u65F6\u3002\u5F88\u5C11\u5728\u8C03\u7528\u9876\u7EA7 makefile \u7684\u65F6\u5019\u914D\u7F6E\u5B83\uFF0C\u56E0\u4E3A\u628A\u5916\u90E8makefile \u548C\u5F53\u524Dmakefile\u6DF7\u6742\u5728\u4E00\u8D77\u4E0D\u597D\u3002\u4F46\u662F\uFF0C\u672A\u6307\u5B9A\u7279\u5B9A\u7684 makefile \u800C\u8FD0\u884C make \u547D\u4EE4\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5 \u901A\u8FC7\u8BBE\u7F6E\u6B64\u53D8\u91CF\u6539\u826F\u5185\u7F6E\u9690\u5F0F\u89C4\u5219\u3002</p><p>\u6709\u4E9B\u7528\u6237\u4E60\u60EF\u5728\u767B\u5F55shell\u7684\u542F\u52A8\u811A\u672C\u4E2D\u914D\u7F6E\u6B64\u53D8\u91CF\uFF0C\u8FD9\u975E\u5E38\u4E0D\u597D\uFF0C\u56E0\u4E3A\u5199\u51FA\u6765\u7684makefile\u653E\u5728 \u522B\u4EBA\u8FD0\u884C\u65F6\u5C31\u4F1A\u62A5\u9519\uFF0C\u4F7F\u7528 include \u6307\u4EE4\u660E\u786E\u88AB\u5305\u542B\u7684makefile\u662F\u66F4\u597D\u7684\u9009\u62E9\u3002</p><h2 id="_3-5-remade-\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_3-5-remade-\u8FC7\u7A0B" aria-hidden="true">#</a> 3.5 Remade \u8FC7\u7A0B</h2><p>How Makefiles Are Remade</p><p>\u6709\u65F6\u53EF\u4EE5\u4ECE\u5176\u5B83\u9014\u5F84\u751F\u6210makefile\uFF0C\u4E5F\u5E0C\u671Bmake\u80FD\u7528\u4E0A\u6700\u65B0\u7684makefile\u3002</p><p>\u4E3A\u4E86\u5E94\u5BF9\u6B64\u9700\u6C42\uFF0Cmake \u63D0\u4F9Bremake\u673A\u5236\u3002\u5F53\u6240\u6709makefile\u90FD\u8BFB\u53D6\u5B8C\u6BD5\u540E\uFF0Cmake \u5C1D\u8BD5\u5206\u522B\u4EE5\u6BCF\u4E2A makefile \u6587\u4EF6\u540D\u4E3A\u76EE\u6807\uFF0C\u67E5\u627E\u53EF\u4EE5\u751F\u6210/\u66F4\u65B0\u5B83\u4EEC\u7684\u89C4\u5219\uFF0C\u5982\u679C\u6709\u5C31\u5E94\u7528\uFF0C\u5F53\u6240\u6709 makefile \u90FD \u68C0\u67E5\u4E00\u904D\u540E\uFF0C\u5982\u679C\u786E\u5B9E\u5B58\u5728\u67D0\u4E2Amakefile\u88AB\u66F4\u65B0\u4E86\uFF0Cmake \u4F1A\u4ECE\u5E72\u51C0\u7684\u72B6\u6001\u91CD\u65B0\u8BFB\u53D6makefile\uFF0C \u91CD\u65B0\u8BFB\u53D6\u540E\u4ECD\u65E7\u4F1A\u8FDB\u884C\u8FD9\u4E9B\u68C0\u67E5\uFF0C\u76F4\u5230\u67D0\u6B21\u68C0\u67E5\u540E\u6240\u6709makefile\u90FD\u6CA1\u6709\u53D8\u5316\u3002\u6BCF\u6B21\u91CD\u542F\uFF0Cmake \u4F1A\u66F4\u65B0\u7279\u6B8A\u53D8\u91CF MAKE_RESTARTS \u7684\u503C\u3002</p><p>ps\uFF1A\u663E\u7136\uFF0C\u5165\u53E3 makefile \u4E5F\u5728\u8FD9\u4E2A remake \u8FC7\u7A0B\u7684\u68C0\u67E5\u8303\u56F4\u4E4B\u5185\u3002</p><p>\u5982\u679C\u67D0\u4E2A makefile \u53EF\u4EE5\u7531\u67D0\u6761 double-colon rule \u751F\u6210\uFF0C\u800C\u6B64 double-colon rule \u53EA\u6709 recipe \u6CA1\u6709 prerequisite\uFF0C\u8FD9\u6837\u7684\u89C4\u5219\u6BCF\u6B21\u90FD\u4F1A\u6267\u884C\uFF0C\u90A3 make \u6BCF\u6B21\u68C0\u67E5\u90FD\u4F1A\u91CD\u65B0\u751F\u6210 makefile\uFF0C \u5BFC\u81F4\u6B7B\u5FAA\u73AF\uFF0C\u4E3A\u4E86\u907F\u5F00\u8FD9\u4E00\u70B9\uFF0C\u5728 remake \u7684\u65F6\u5019\uFF0C\u5982\u679C\u67D0\u4E2A makefile \u662F\u67D0\u6761\u53EA\u6709 recebe \u6CA1\u6709 prerequisite \u7684\u89C4\u5219\u7684 target\uFF0Cmake \u4E0D\u4F1A remake\u8FD9\u4E2A\u6587\u4EF6\u3002</p><blockquote><p>So, to avoid this, make will not attempt to remake makefiles which are specified as targets of a double-colon rule with a recipe but no prerequisites.</p></blockquote><p>\u5982\u679C\u6CA1\u6709\u6307\u5B9A makefile \uFF08-f \u9009\u9879\uFF09\uFF0Cmake \u4F1A\u4F9D\u6B21\u5C1D\u8BD5\u9ED8\u8BA4\u6587\u4EF6\u540D\uFF08GNUMakefile\uFF0Cmakefile\u3001 Makefile\uFF09\uFF0C\u5982\u679C\u8FD9\u4E9B\u9ED8\u8BA4\u6587\u4EF6\u540D\u90FD\u4E0D\u5B58\u5728\uFF0Cmake \u4F1A\u5C1D\u8BD5\u4F7F\u7528 make rule \u751F\u6210\u5B83\u4EEC\uFF0C\u5982\u679C\u4ECD\u65E7 \u4E0D\u80FD\u751F\u6210\uFF0C\u90A3\u5C31\u6CA1\u6709\uFF0C\u6CA1\u6709\u4E5F\u4E0D\u7B97\u62A5\u9519\uFF0C\u56E0\u4E3A makefile \u5E76\u4E0D\u662F\u5FC5\u987B\u7684\u3002</p><p>Q. \u5E76\u6CA1\u6709\u8BF4 -f \u6307\u5B9A\u7684\u6587\u4EF6\u540D\u4E0D\u5B58\u5728\u65F6\u662F\u5426\u4F1A\u5C1D\u8BD5\u6784\u5EFA\u3002 Ans: \u4F1A\uFF0C\u4E14\u65E0\u5BF9\u5E94\u89C4\u5219\u6216\u89C4\u5219\u65E0\u6CD5\u751F\u6210\u65F6\uFF0C\u4F1A\u62A5\u9519\u9000\u51FA\uFF0C\u76F8\u6BD4\u4E4B\u4E0B\uFF0C\u7F3A\u7701makefile\u6587\u4EF6\u5982\u679C \u6700\u7EC8\u7F3A\u5931\uFF0C\u5374\u4E0D\u4F1A\u62A5\u9519\u3002 \u5982\u4E0B\uFF0C\u62A5\u9519 No rule to make target &#39;Makefile2&#39;\uFF0C\u8BF4\u660E make \u786E\u5B9E\u5C1D\u8BD5\u751F\u6210\u5B83\u4E86\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> -f Makefile2 hello
make: Makefile2: No such <span class="token function">file</span> or directory
make: *** No rule to <span class="token function">make</span> target <span class="token string">&#39;Makefile2&#39;</span><span class="token builtin class-name">.</span>  Stop.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>-t \u9009\u9879\u4E0D\u4F1A\u5F71\u54CD makefile \u7684remake\u8FC7\u7A0B\uFF0C\u56E0\u4E3A\u82E5\u67D0\u4E2A makefile \u8FC7\u65F6\uFF0C-t \u9009\u9879\u7684\u8F93\u51FA\u5C31\u4F1A\u4E0D \u51C6\u786E\uFF0C\u8FD9\u662F\u4E0D\u884C\u7684\u3002\u540C\u7406\uFF0C-q \u548C -n \u9009\u9879\u4E5F\u4E0D\u4F1A\u5F71\u54CD makefile \u7684 remake \u8FC7\u7A0B\u3002</p><p>\u5982\u679C\u786E\u5B9E\u8981\u6C42 -t\u3001-q\u3001-n\u9009\u9879\u8FDE\u5E26\u7740 makefile \u7684 remake \u8FC7\u7A0B\u4E5F\u6291\u5236\uFF0C\u628A makefile \u540D\u4F5C\u4E3A \u76EE\u6807\u660E\u786E\u6307\u5B9A\u5728\u547D\u4EE4\u884C\u4E0A\u5C31\u884C\u4E86\u3002</p><blockquote><p>However, on occasion you might actually wish to prevent updating of even the makefiles. You can do this by specifying the makefiles as goals in the command line as well as specifying them as makefiles. When the makefile name is specified explicitly as a goal, the options \u2018-t\u2019 and so on do apply to them.</p></blockquote><p>\u8FD8\u4E3E\u4E86\u4E00\u4E2A\u4F8B\u5B50\u3002</p><blockquote><p>Thus, \u2018make -f mfile -n mfile foo\u2019 would read the makefile mfile, print the recipe needed to update it without actually running it, and then print the recipe needed to update foo without running that. The recipe for foo will be the one specified by the existing contents of mfile.</p></blockquote><h2 id="_3-6-\u8986\u76D6\u53E6\u4E00\u4E2Amakfile\u7684\u90E8\u5206\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#_3-6-\u8986\u76D6\u53E6\u4E00\u4E2Amakfile\u7684\u90E8\u5206\u5185\u5BB9" aria-hidden="true">#</a> 3.6 \u8986\u76D6\u53E6\u4E00\u4E2Amakfile\u7684\u90E8\u5206\u5185\u5BB9</h2><p>Overriding Part of Another Makefile</p><p>\u8FD9\u91CC\u7684\u573A\u666F\u662F\uFF1A\u5927\u90E8\u5206\u5185\u5BB9\u4E00\u6837\uFF0C\u4F46\u90E8\u5206\u89C4\u5219\u9700\u8981\u91CD\u5199\u3002</p><p>\u6CA1\u6709\u4E13\u95E8\u7684\u8BED\u6CD5\u5B9E\u73B0\u8FD9\u4E00\u70B9\uFF0C\u53EA\u662F\u901A\u8FC7\u67D0\u4E9B\u6280\u5DE7\u5B9E\u73B0\u8FD9\u4E00\u76EE\u7684\u3002</p><ul><li>ps\uFF1Ainclude \u6307\u4EE4\u65E0\u6CD5\u5B9E\u73B0\u8FD9\u4E00\u76EE\u7684\uFF0C\u56E0\u4E3A\u540C\u4E00\u4E2A target \u6709\u591A\u4E2A recipe \u4F1A\u62A5\u9519\u3002</li></ul><p>\u5047\u8BBE\u5DF2\u6709\u6587\u4EF6 Makefile\uFF0C\u5176\u5305\u542B\u6784\u9020\u76EE\u6807 foo \u7684\u89C4\u5219\u4EE5\u53CA\u5176\u5B83\u89C4\u5219\uFF0C\u8981\u65B0\u7F16\u5199\u6587\u4EF6 GNUMakefile\uFF0C \u5B83\u5927\u90E8\u5206\u4E0E Makefile \u89C4\u5219\u76F8\u540C\uFF0C\u53EA\u662F\u9700\u8981\u91CD\u5199 foo \u89C4\u5219\uFF0C\u5219\u6309\u5982\u4E0B\u65B9\u5F0F\u7F16\u5199 GNUMakefile</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment">#File: GNUMake</span>
<span class="token symbol">foo</span><span class="token punctuation">:</span>
        frobnicate &gt; foo

<span class="token symbol">%</span><span class="token punctuation">:</span> force
        <span class="token operator">@</span><span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> -f Makefile <span class="token variable">$@</span>
<span class="token symbol">force</span><span class="token punctuation">:</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol><li>\u7528 % \u89C4\u5219\u515C\u5E95\uFF0C\u8F6C\u53D1\u7ED9 Makefile</li><li>\u7528 force \u4F5C\u4E3A % \u7684 prerequisite\uFF0C\u786E\u4FDD % \u5FC5\u5B9A\u6267\u884C\uFF08\u786E\u4FDD\u5176\u4E0D\u4F1A\u56E0\u4E3A\u5B58\u5728\u540C\u540D\u6587\u4EF6\u800C\u5F97\u4E0D\u5230\u6267\u884C\uFF09</li><li>\u4E3A force \u63D0\u4F9B\u4E86\u7A7A\u7684 recipe\uFF0C\u907F\u514D force \u672C\u8EAB\u5339\u914D\u5230 % \u89C4\u5219\uFF0C\u5BFC\u81F4\u6B7B\u5FAA\u73AF\u3002</li></ol><h2 id="_3-7-\u8BFB\u53D6makefile-\u4E24\u9636\u6BB5" tabindex="-1"><a class="header-anchor" href="#_3-7-\u8BFB\u53D6makefile-\u4E24\u9636\u6BB5" aria-hidden="true">#</a> 3.7 \u8BFB\u53D6makefile\uFF1A\u4E24\u9636\u6BB5</h2><p>How make Reads a Makefile</p><p>make \u5206\u6210\u4E24\u4E2A\u9636\u6BB5\u5B8C\u6210\u5176\u5DE5\u4F5C\u3002\u5728\u7B2C\u4E00\u4E2A\u9636\u6BB5\uFF0Cmake \u8BFB\u53D6\u6240\u6709 makefile\u3001\u88AB\u5305\u542B\u7684makefile\u7B49\uFF0C \u521D\u59CB\u5316\u6240\u6709\u53D8\u91CF\u5B9A\u4E49\u3001\u53D8\u91CF\u503C\u3001\u9690\u5F0F\u89C4\u5219\u3001\u663E\u5F0F\u89C4\u5219\uFF0C\u5E76\u6784\u5EFA\u6240\u6709 target \u548C prerequisite \u7684 \u4F9D\u8D56\u56FE\u3002\u7B2C\u4E8C\u9636\u6BB5\uFF0Cmake \u6839\u636E\u4E0A\u8FF0\u6570\u636E\u68C0\u67E5\u3001\u786E\u8BA4\u9700\u8981\u66F4\u65B0\u7684 target \u5E76\u8FD0\u884C\u5FC5\u8981\u7684 recipe \u5B8C\u6210\u66F4\u65B0\u3002</p><p>ps\uFF1Aread-in phase, target-update phase\u3002</p><p>make \u7684\u4E24\u9636\u6BB5\u5DE5\u4F5C\u76F4\u63A5\u5F71\u54CD\u53D8\u91CF\u5C55\u5F00\u548C\u51FD\u6570\u5C55\u5F00\u7684\u65F6\u673A\uFF0C\u7406\u89E3\u8FD9\u4E9B\u5C31\u53EF\u4EE5\u7406\u89E3\u4E00\u4E9B\u6613\u6DF7\u6DC6\u7684\u7ED3\u6784\u3002</p><p>\u5C55\u5F00\u5206\u4E3A\u4E24\u79CD\uFF0C\u5728\u7B2C\u4E00\u9636\u6BB5\u53D1\u751F\u7684\u53EB\u7ACB\u5373\u5C55\u5F00\uFF08immediate\uFF09\uFF1A\u89E3\u6790makefile \u7684\u65F6\u5019\u6267\u884C\u5C55\u5F00\uFF1B \u4E0D\u662F\u7406\u89E3\u5C55\u5F00\u7684\u53EB\u5EF6\u8FDF\u5C55\u5F00\uFF08deferred\uFF09\uFF0C\u5B83\u4EEC\u5728\u4F7F\u7528\u7684\u65F6\u5019\u624D\u5C55\u5F00\uFF1A\u8981\u4E48\u5728\u7ACB\u5373\u5C55\u5F00\u4E0A\u4E0B\u6587\u4E2D\u88AB \u5F15\u7528\u7684\u65F6\u5019\uFF0C\u8981\u4E48\u5728\u7B2C\u4E8C\u9636\u6BB5\u88AB\u5F15\u7528\u7684\u65F6\u5019\u3002</p><blockquote><p>We say that expansion is immediate if it happens during the first phase: make will expand that part of the construct as the makefile is parsed. We say that expansion is deferred if it is not immediate. Expansion of a deferred construct part is delayed until the expansion is used: either when it is referenced in an immediate context, or when it is needed during the second phase.</p></blockquote><p>PS\uFF1A\u6559\u7A0B\u5217\u51FA\u4E86\u4E00\u4E9B\u7531\u6B64\u5E26\u6765\u7684\u5E38\u89C1\u7684\u6613\u6DF7\u6DC6\u7ED3\u6784\uFF0C\u5E76\u7ED9\u51FA\u4E86\u89E3\u91CA\u3002</p><p>\u8FD9\u91CC\u7684\u67D0\u4E9B\u8BED\u53E5\u6D89\u53CA\u5230\u964C\u751F\u7684\u8BED\u6CD5\uFF0C\u53EF\u4EE5\u719F\u6089\u4E4B\u540E\u518D\u6765\u56DE\u987E\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>immediate <span class="token operator">=</span> deferred
immediate <span class="token operator">?=</span> deferred
immediate <span class="token operator">:=</span> immediate
<span class="token symbol">immediate</span> <span class="token operator">::=</span> immediate
immediate <span class="token operator">+=</span> deferred or immediate
immediate <span class="token operator">!=</span> immediate
<span class="token keyword">define</span> immediate
  deferred
<span class="token keyword">endef</span>

<span class="token keyword">define</span> immediate <span class="token operator">=</span>
  deferred
<span class="token keyword">endef</span>

<span class="token keyword">define</span> immediate <span class="token operator">?=</span>
  deferred
<span class="token keyword">endef</span>

<span class="token keyword">define</span> immediate <span class="token operator">:=</span>
  immediate
<span class="token keyword">endef</span>

<span class="token symbol">define immediate</span> <span class="token operator">::=</span>
  immediate
<span class="token keyword">endef</span>

<span class="token keyword">define</span> immediate <span class="token operator">+=</span>
  deferred or immediate
<span class="token keyword">endef</span>

<span class="token keyword">define</span> immediate <span class="token operator">!=</span>
  immediate
<span class="token keyword">endef</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p><code>+=</code> \u64CD\u4F5C\u7B26\u53F3\u4FA7\u4F1A\u7ACB\u5373\u5C55\u5F00\u5982\u679C\u88AB\u5F15\u7528\u7684\u53D8\u91CF\u672C\u8EAB\u662F\u7B80\u5355\u53D8\u91CF\uFF08:= \u6216 ::=\u5B9A\u4E49\u7684\uFF09\uFF0C\u5426\u5219\u5EF6\u8FDF\u5C55\u5F00\u3002 <code>!=</code> \u64CD\u4F5C\u7B26\uFF08shell assignment operator\uFF09\uFF0C\u53F3\u4FA7\u4F1A\u7ACB\u5373\u5C55\u5F00\uFF0C\u4F20\u9012\u7ED9shell\uFF0C\u5E76\u628A\u7ED3\u679C\u5B58\u5165\u5DE6\u4FA7 \u53D8\u91CF\u4E2D\uFF0C\u540C\u65F6\u5DE6\u4FA7\u7684\u53D8\u91CF\u662F\u7B80\u5355\u53D8\u91CF\u3002</p><h3 id="\u6761\u4EF6\u6307\u4EE4\u7ACB\u5373\u5C55\u5F00" tabindex="-1"><a class="header-anchor" href="#\u6761\u4EF6\u6307\u4EE4\u7ACB\u5373\u5C55\u5F00" aria-hidden="true">#</a> \u6761\u4EF6\u6307\u4EE4\u7ACB\u5373\u5C55\u5F00</h3><p>\u6761\u4EF6\u6307\u4EE4\u5728\u89E3\u6790\u65F6\u7ACB\u5373\u5C55\u5F00\u3002\u8FD9\u610F\u5473\u7740\u6761\u4EF6\u6307\u4EE4\u4E2D\u65E0\u6CD5\u4F7F\u7528\u81EA\u52A8\u53D8\u91CF\uFF0C\u81EA\u52A8\u53D8\u91CF\u5728 recipe \u5B9E\u9645 \u6267\u884C\u7684\u65F6\u5019\u624D\u4F1A\u8BBE\u7F6E\u597D\u3002\u5982\u679C\u9700\u8981\uFF0C\u5C31\u628A\u6761\u4EF6\u5904\u7406\u903B\u8F91\u653E\u5230 recipe\u4E2D\uFF0C\u540C\u65F6\u7528 shell \u7684 if \u8BED\u53E5\u4EE3\u66FF\u3002</p><h3 id="\u89C4\u5219\u5B9A\u4E49" tabindex="-1"><a class="header-anchor" href="#\u89C4\u5219\u5B9A\u4E49" aria-hidden="true">#</a> \u89C4\u5219\u5B9A\u4E49</h3><p>\u89C4\u5219\u5B9A\u4E49\uFF0C\u4E0D\u8BBA\u5F62\u5F0F\uFF0C\u5176\u5C55\u5F00\u65F6\u673A\u5982\u4E0B\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">immediate</span> <span class="token punctuation">:</span> immediate <span class="token punctuation">;</span> deferred
        deferred
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4E5F\u5C31\u662F\u8BF4\uFF0Crule \u4E2D\u7684 target \u548C prerequisite \u90FD\u662F\u7ACB\u5373\u5C55\u5F00\uFF0C\u800C recipe \u603B\u662F\u5EF6\u8FDF\u5C55\u5F00\u3002 explicit rules, pattern rules, suffix rules, static pattern rules, \u548C simple prerequisite definitions \u90FD\u662F\u5982\u6B64\u3002</p><h2 id="_3-8-\u89E3\u6790makefile" tabindex="-1"><a class="header-anchor" href="#_3-8-\u89E3\u6790makefile" aria-hidden="true">#</a> 3.8 \u89E3\u6790Makefile</h2><p>How Makefiles Are Parsed</p><p>make \u9010\u884C\u89E3\u6790 makefile\uFF0C\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li>\u8BFB\u53D6\u4E00\u4E2A\u903B\u8F91\u884C</li><li>\u5220\u9664\u5176\u4E2D\u7684\u6CE8\u91CA</li><li>\u5982\u679C\u662F RECIPEPREFIX \u5F00\u5934\u4E14\u5728 rule context \u4E2D\uFF0C\u628A\u5F53\u524D\u884C\u52A0\u5165\u5F53\u524D recipe \u4E2D\uFF1B\u7136\u540E\u8BFB\u53D6\u4E0B\u4E00\u4E2A\u903B\u8F91\u884C</li><li>\u68C0\u67E5\u5176\u4E2D\u7684\u7ACB\u5373\u5C55\u5F00\u5143\u7D20\u5E76\u5C55\u5F00</li><li>\u641C\u7D22\u884C\u4E2D\u7684 : \u548C = \u5206\u9694\u7B26\uFF0C\u533A\u5206\u662F\u89C4\u5219\u5B9A\u4E49\u8FD8\u662F\u53D8\u91CF\u8D4B\u503C\uFF08\u539F\u6587\u662F macro assignment\uFF0C\u6211\u731C\u5C31\u662F\u6307\u53D8\u91CF\u5B9A\u4E49\uFF09</li><li>\u5904\u7406\u4E0B\u4E00\u884C</li></ol><p>\u57FA\u4E8E\u8FD9\u4E9B\u89C4\u5219\uFF0C\u4E00\u4E2A\u663E\u800C\u6613\u89C1\u7684\u63A8\u8BBA\u662F\uFF0C\u53EF\u901A\u8FC7\u53D8\u91CF\u5B9A\u4E49\u5355\u884C\u89C4\u5219\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>myrule <span class="token operator">=</span> target <span class="token punctuation">:</span> <span class="token punctuation">;</span> echo built

<span class="token variable">$</span><span class="token punctuation">(</span>myrule<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4F46\u662F\u4E0B\u9762\u8FD9\u4E00\u6BB5\u5C31\u4E0D\u884C\u4E86\uFF0C\u56E0\u4E3Amake\u4E0D\u4F1A\u5BF9\u5C55\u5F00\u7ED3\u679C\u62C6\u884C\u5904\u7406\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">define</span> myrule
<span class="token symbol">target</span><span class="token punctuation">:</span>
        echo built
<span class="token keyword">endef</span>

<span class="token variable">$</span><span class="token punctuation">(</span>myrule<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u5B9E\u9645\u7B49\u6548\u4E8E <code>target: ; echo built</code>\uFF0C\u5176\u4E2D\u7684\u6362\u884C\u7B26\u4ECD\u65E7\u4FDD\u7559\uFF0C\u4F46\u6548\u679C\u548C\u7A7A\u767D\u5B57\u7B26\u76F8\u540C\u3002</p><p>\u8981\u8BA9\u591A\u884C\u53D8\u91CF\u503C\u5C55\u5F00\u4E3A\u89C4\u5219\uFF0C\u9700\u8981\u7528 eval \u51FD\u6570\u3002</p><h2 id="_3-9-secondary-expansion-\u5F85\u7EED" tabindex="-1"><a class="header-anchor" href="#_3-9-secondary-expansion-\u5F85\u7EED" aria-hidden="true">#</a> 3.9 Secondary Expansion \u5F85\u7EED</h2><p>make \u6709\u4E24\u4E2A\u5DE5\u4F5C\u9636\u6BB5\uFF0Cread-in phase \u548C target-update phase\u3002 GNU Make \u8FD8\u652F\u6301\u4E8C\u6B21\u5C55\u5F00\uFF08secondary expansion\uFF09\uFF0C\u4E8C\u6B21\u5C55\u5F00\u662F\u6307\uFF0C\u5728 read-in phase \u4E4B\u540E\uFF0C\u5BF9\u67D0\u4E9B\u6216\u6240\u6709 target \u5BF9\u5E94\u7684 prerequisite \u90E8\u5206\u8FDB\u884C\u4E00\u6B21\u5C55\u5F00\u3002\u8981\u542F\u7528\u8FD9\u4E2A\u7279\u6027\uFF0C \u5F97\u501F\u52A9\u7279\u6B8A target .SECONDEXPANSION\u3002</p><blockquote><p>In order for this second expansion to occur, the special target .SECONDEXPANSION must be defined before the first prerequisite list that makes use of this feature.</p></blockquote><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.SECONDEXPANSION</span><span class="token punctuation">:</span>
ONEVAR <span class="token operator">=</span> onefile
TWOVAR <span class="token operator">=</span> twofile
<span class="token symbol">myfile</span><span class="token punctuation">:</span> <span class="token variable">$</span><span class="token punctuation">(</span>ONEVAR<span class="token punctuation">)</span> <span class="token variable">$$</span><span class="token punctuation">(</span>TWOVAR<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u4E00\u4E9B\u4F7F\u7528\u573A\u666F\uFF0C\u4E00\u4E9B\u201C\u8FB9\u754C\u201D\u60C5\u666F\u3002</p><p>\u81EA\u52A8\u53D8\u91CF\u5728 prerequisite \u4E2D\u662F\u65E0\u6CD5\u4F7F\u7528\u7684\uFF0C\u4F46\u501F\u52A9\u4E8C\u6B21\u5C55\u5F00\u5C31\u53EF\u4EE5\u7528\u4E0A\uFF0C\u53EA\u4E0D\u8FC7\u9700\u8981\u7528 $$ \u4EE3\u66FF $\u3002 ps\uFF1A\u636E\u6587\u6863\u6240\u8BF4\uFF0C\u8FD9\u6B63\u662F\u4E8C\u6B21\u5C55\u5F00\u7684\u5A01\u529B\u6240\u5728\u3002\u4F46\u6211\u76EE\u524D\u4E0D\u9700\u8981\u5B66\u8FD9\u4E48\u6DF1\u5165\uFF0C\u77E5\u9053\u6709\u8FD9\u56DE\u4E8B\u5C31\u884C\u3002</p><h1 id="_4-\u4E66\u5199\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_4-\u4E66\u5199\u89C4\u5219" aria-hidden="true">#</a> 4. \u4E66\u5199\u89C4\u5219</h1><p>Writing Rules</p><p>\u89C4\u5219\u7684 target\u3001prerequisite\u3001recipe\u3002</p><p>\u89C4\u5219\u5728\u6587\u4EF6\u4E2D\u7684\u987A\u5E8F\u65E0\u5173\u7D27\u8981\uFF0C\u552F\u4E00\u548C\u987A\u5E8F\u6709\u5173\u7684\uFF0C\u662F\u786E\u8BA4 default goal \u7684\u65F6\u5019\u3002</p><p>\u4E24\u6761\u4F8B\u5916\uFF1A\u53E5\u70B9\u5F00\u5934\u7684target \u4EE5\u53CApattern rule \u4E0D\u53C2\u4E0E default goal\u3002</p><h2 id="_4-1-\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_4-1-\u793A\u4F8B" aria-hidden="true">#</a> 4.1 \u793A\u4F8B</h2><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo.o</span> <span class="token punctuation">:</span> foo.c defs.h       <span class="token comment"># module for twiddling the frobs</span>
        cc -c -g foo.c
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8FD9\u662F\u4E00\u6761\u89C4\u5219\uFF0C</p><ul><li>foo.o \u662F target</li><li>foo.c \u548C defs.h \u662F prerequisite</li><li>cc -c -g foo.c \u662F recipe</li></ul><p>\u8FD9\u89C4\u5219\u8BF4\u660E\u4E24\u4EF6\u4E8B\uFF1A</p><ol><li>\u66F4\u65B0 target \u7684\u65F6\u673A\uFF1A\u5F53 foo.o \u4E0D\u5B58\u5728\uFF0C\u6216\u8005 foo.o \u6BD4 foo.c\u3001defs.h \u4E2D\u7684\u4EFB\u4F55\u4E00\u4E2A\u66F4\u65E7\u65F6\u9700\u8981\u751F\u6210/\u66F4\u65B0</li><li>\u5982\u4F55\u751F\u6210/\u66F4\u65B0 target\uFF1A\u7528\u547D\u4EE4 cc-c -g foo.c \u751F\u6210/\u66F4\u65B0\u76EE\u6807 foo.o</li></ol><h2 id="_4-2-\u89C4\u5219\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#_4-2-\u89C4\u5219\u8BED\u6CD5" aria-hidden="true">#</a> 4.2 \u89C4\u5219\u8BED\u6CD5</h2><p>\u89C4\u5219\u7684\u4E00\u822C\u5F62\u5F0F\u4E3A\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">targets</span> <span class="token punctuation">:</span> prerequisites
        recipe
        \u2026
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u6216\u8005</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">targets</span> <span class="token punctuation">:</span> prerequisites <span class="token punctuation">;</span> recipe
        recipe
        \u2026
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>`,83),_a=a("targets \u662F\u6587\u4EF6\u540D\u5217\u8868\uFF0C\u7A7A\u683C\u505A\u5206\u9694\u7B26\u3002\u6587\u4EF6\u540D\u4E2D\u53EF\u4EE5\u4F7F\u7528\u901A\u914D\u7B26\uFF08\u53C2\u89C1"),ya={href:"https://www.gnu.org/software/make/manual/make.html#Wildcards",title:"4.4 Using Wildcard Characters in File Names",target:"_blank",rel:"noopener noreferrer"},wa=a("Using Wildcard Characters in File Names"),xa=a("\uFF09\u3002 a(m) \u5F62\u5F0F\u7684 target \u5BF9\u5E94\u5F52\u6863\u6587\u4EF6 a \u4E2D\u7684\u6210\u5458 m\uFF08\u53C2\u89C1"),Aa={href:"https://www.gnu.org/software/make/manual/make.html#Archive-Members",title:"11.1 Archive Members as Targets",target:"_blank",rel:"noopener noreferrer"},Ea=a("Archive Members as Targets"),Sa=a(")\u3002\u901A\u5E38\u4E00\u4E2A\u89C4\u5219\u4E2D\u5199\u4E00\u4E2A target\uFF0C\u4F46 \u53EF\u4EE5\u5199\u591A\u4E2A\u3002"),$a=a("recipe \u8981\u6C42\u6BCF\u4E00\u884C\u7684\u5F00\u5934\u5FC5\u987B\u662F tab \u5B57\u7B26\uFF08\u6216\u8005"),La={href:"https://www.gnu.org/software/make/manual/make.html#Special-Variables",title:"6.14 Other Special Variables",target:"_blank",rel:"noopener noreferrer"},qa=a("\u7279\u6B8A\u53D8\u91CF"),Ma=a(" .RECIPEPREFIX \u503C\u7684\u7B2C\u4E00\u4E2A\u5B57\u7B26\uFF09\u3002 recipe \u53EF\u4EE5\u5728 prerequisite \u7684\u540E\u9762\u65B0\u5F00\u4E00\u884C\uFF08\u4EE5 tab \u5B57\u7B26\u5F00\u5934\uFF09\uFF0C\u6216\u8005\u7D27\u8DDF\u7740 prerequisite\uFF0C\u4EE5\u5206\u53F7\u5206\u9694\uFF0C\u4E8C\u8005\u662F\u4E00\u6837\u7684\u6548\u679C\u3002 recipe \u6709\u4E0D\u540C\u5F62\u5F0F\u7684\u8BED\u6CD5\u3002\u53C2\u89C1 "),Ia={href:"https://www.gnu.org/software/make/manual/make.html#Recipes",title:"5 Writing Recipes in Rules",target:"_blank",rel:"noopener noreferrer"},Ra=a("Writing Recipes in Rules"),Fa=a("."),Ta=e("p",null,"$ \u5B57\u7B26\u7528\u4E8E\u5F00\u542F\u53D8\u91CF\u5F15\u7528\uFF0C\u6240\u4EE5\u82E5\u8981\u5728 target \u6216 prerequisite \u4E2D\u4F7F\u7528\u5E38\u91CF $ \u5B57\u7B26\uFF0C\u9700\u8981\u4E24\u4E2A $$\u3002 \u82E5\u5F00\u542F\u4E86 secondary expansion\uFF0C\u5C31\u9700\u8981\u56DB\u4E2A\u6362\u4E00\u4E2A $$$$\u3002",-1),Pa=e("p",null,"\u53EF\u4EE5\u5728\u884C\u672B\u7528 \\ \u7EED\u884C\u3002makefile \u4E0D\u9650\u5236\u7269\u7406\u884C\u7684\u957F\u5EA6\uFF0C\u4E4B\u6240\u4EE5\u7EED\u884C\uFF0C\u662F\u4E3A\u4E86\u65B9\u4FBF\u9605\u8BFB\uFF0C\u800C\u975E\u8BED\u6CD5\u8981\u6C42\u3002",-1),Ca=e("blockquote",null,[e("p",null,"A rule tells make two things: when the targets are out of date, and how to update them when necessary.")],-1),Oa=e("p",null,"target \u8FC7\u671F\u7684\u6807\u51C6\u4EE5 prerequisite \u7684\u5F62\u5F0F\u5448\u73B0\uFF0Cprerequisite \u662F\u6587\u4EF6\u540D\u5217\u8868\uFF0C\u6587\u4EF6\u540D\u4E4B\u95F4\u7528\u7A7A\u683C\u5206\u9694\uFF08\u6B64\u5904\u4E5F\u652F\u6301\u901A\u914D\u7B26\u548C archive member\uFF09\u3002 \u5F53 target \u4E0D\u5B58\u5728\u6216\u8005\u6BD4 prerequiiste \u4E2D\u7684\u4EFB\u610F\u4E00\u4E2A\u66F4\u65E7\uFF08\u7528\u6700\u540E\u4FEE\u6539\u65F6\u95F4\u6BD4\u8F83\uFF09\uFF0C\u5219 target \u662F\u8FC7\u671F\u7684\uFF08\u9700\u8981\u66F4\u65B0\u7684\uFF09\u3002 \u8FD9\u5176\u4E2D\u7684\u601D\u60F3\u662F\uFF0Ctarget \u4E2D\u7684\u6587\u4EF6\u662F\u6839\u636E prerequiste \u4E2D\u7684\u6587\u4EF6\u4F5C\u4E3A\u4FE1\u606F\u6765\u6E90\u751F\u6210\u7684\uFF0C\u6240\u4EE5 prerequisite \u4E2D\u7684\u4EFB\u610F\u4E00\u4E2A\u6587\u4EF6\u53D1\u751F\u53D8\u5316\uFF0C target \u90FD\u9700\u8981\u91CD\u65B0\u751F\u6210\u3002",-1),Ha=e("blockquote",null,[e("p",null,[a("The criterion for being out of date is specified in terms of the prerequisites, which consist of file names separated by spaces. A target is out of date if it does not exist or if it is older than any of the prerequisites (by comparison of last-modification times). PS: \u6839\u636E "),e("code",null,"if it is older than any of the prerequisites"),a("\uFF0C \u5982\u679C\u67D0\u4E2A target \u7684 prerequisite \u4E3A\u7A7A\uFF0C\u90A3\u8FD9\u4E2A target \u662F out of date \u5F53\u4E14\u4EC5\u5F53 target \u4E0D\u5B58\u5728\u3002 \u53E6\u4E00\u65B9\u9762\uFF0C\u5982\u679C\u4E00\u4E2A target \u4E0D\u5B58\u5728 prerequiste\uFF0C\u90A3\u5C31\u4E0D\u4F9D\u8D56\u4EFB\u4F55\u5176\u5B83\u4E1C\u897F\uFF0C\u90A3\u53EA\u8981\u751F\u6210\u4E4B\u540E\uFF0C\u5C31\u4E0D\u5FC5\u66F4\u65B0\uFF0C\u8FD9\u4E5F\u662F\u5408\u7406\u7684\u3002")])],-1),Ga=a("\u5982\u4F55\u751F\u6210 target\uFF1F\u8FD9\u5C31\u662F recipe \u7684\u89D2\u8272\u3002recipe \u4E2D\u6BCF\u884C\u90FD\u5728\u5355\u72EC\u7684 shell \u4E2D\u6267\u884C\uFF08\u901A\u5E38\u662F sh\uFF09\uFF0C\u5F53\u7136\uFF0C\u8FD8\u6709\u4E00\u4E9B\u9644\u52A0\u7279\u6027\uFF0C \u53C2\u89C1 "),Na={href:"https://www.gnu.org/software/make/manual/make.html#Recipes",title:"5 Writing Recipes in Rules",target:"_blank",rel:"noopener noreferrer"},ja=a("Writing Recipes in Rules"),Ka=a("\u3002"),Da=t(`<h2 id="_4-3-prerequisite-\u7684\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#_4-3-prerequisite-\u7684\u5206\u7C7B" aria-hidden="true">#</a> 4.3 prerequisite \u7684\u5206\u7C7B</h2><p>4.3 Types of Prerequisites</p><p>\u5176\u5B9E prerequisite \u5206\u4E24\u7C7B\uFF0Cnormal prerequisite \u548C order only prerequisite\u3002</p><p>\u4E0A\u4E00\u8282\u4ECB\u7ECD\u7684\u5176\u5B9E\u5C31\u662F normal prerequisite\uFF0C\u6B64\u7C7B prerequisite \u9648\u8FF0\u4E86\u4E24\u4EF6\u4E8B\uFF1A</p><ol><li>\u5B83\u9690\u542B\u8BF4\u660E\u4E86\u76F8\u5173\u89C4\u5219\u7684 recipe \u4E4B\u95F4\u7684\u6267\u884C\u7684\u5148\u540E\u987A\u5E8F\uFF1Atarget \u7684 prerequisite \u5BF9\u5E94 recipe \u8981\u5148\u4E8E target \u81EA\u8EAB\u7684 recipe \u6267\u884C</li><li>\u5B83\u6307\u660E\u4E86\u4F9D\u8D56\u5173\u7CFB\uFF1Aprerequisite \u6709\u53D8\u5316\uFF0C\u5219\u5BF9\u5E94\u7684 target \u5C31\u9700\u8981\u66F4\u65B0</li></ol><p>\u7EDD\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u8FD9\u6B63\u662F\u6240\u671F\u671B\u7684\u884C\u4E3A\u3002\u4F46\u6709\u4E9B\u65F6\u5019\u5E0C\u671B\u53EA\u6307\u5B9A\u89C4\u5219\u987A\u5E8F\uFF0C\u800C\u4E0D\u9700\u8981 target \u968F prerequisite \u7684\u53D8\u5316\u800C\u66F4\u65B0\u3002 \u8FD9\u53EF\u4EE5\u901A\u8FC7 order-only prerequisite \u5B9E\u73B0\u3002prerequisite \u5217\u8868\u4E2D\uFF0C\u7BA1\u9053\u7B26\u540E\u9762\u7684 prerequisite \u662F order-only prerequisite\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">targets</span> <span class="token punctuation">:</span> normal-prerequisites <span class="token operator">|</span> order-only-prerequisites
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>normal-prerequisite \u53EF\u4EE5\u4E3A\u7A7A\u3002\u540C\u4E00\u4E2A\u76EE\u6807\u53EF\u4EE5\u5206\u591A\u6761\u89C4\u5219\u6307\u5B9A prerequisite\uFF0C\u5176\u4E2D\u7684 normal-prerequisite \u548C order-only prerequisite \u5206\u522B\u53E0\u52A0\uFF0C\u4E0D\u4F1A\u6DF7\u4E71\u3002\u5982\u679C\u540C\u4E00\u4E2A prerequisite \u540C\u65F6\u51FA\u73B0\u5728 normal prerequisite \u548C order-only prerequisite \u4E2D\uFF0C\u4EE5 normal prerequisite \u4F18\u5148\u7EA7\u66F4\u9AD8\u3002</p><p>\u5E94\u7528\u573A\u666F\u3002 \u5148\u5EFA\u7ACB\u76EE\u5F55\uFF0C\u518D\u5B58\u5165\u76EE\u6807\u6587\u4EF6\u3002\u76EE\u5F55\u4E0B\uFF0C\u589E\u5220\u6587\u4EF6\u90FD\u4F1A\u5BFC\u81F4\u76EE\u5F55\u7684\u6700\u540E\u4FEE\u6539\u65F6\u95F4\u53D8\u52A8\uFF0C\u4F46\u6B64\u65F6\u4E0D\u9700\u8981\u91CD\u65B0\u751F\u6210\u76EE\u6807\u6587\u4EF6\u3002 \u4E00\u79CD\u5904\u7406\u65B9\u6848\uFF0C\u5C31\u662F\u501F\u52A9 order only prerequisite\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>OBJDIR <span class="token operator">:=</span> objdir
OBJS <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>addprefix <span class="token variable">$</span><span class="token punctuation">(</span>OBJDIR<span class="token punctuation">)</span>/,foo.o bar.o baz.o<span class="token punctuation">)</span>

<span class="token symbol"><span class="token variable">$</span>(OBJDIR)/%.o</span> <span class="token punctuation">:</span> %.c
        <span class="token variable">$</span><span class="token punctuation">(</span>COMPILE.c<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>OUTPUT_OPTION<span class="token punctuation">)</span> <span class="token variable">$&lt;</span>

<span class="token symbol">all</span><span class="token punctuation">:</span> <span class="token variable">$</span><span class="token punctuation">(</span>OBJS<span class="token punctuation">)</span>

<span class="token symbol"><span class="token variable">$</span>(OBJS)</span><span class="token punctuation">:</span> <span class="token operator">|</span> <span class="token variable">$</span><span class="token punctuation">(</span>OBJDIR<span class="token punctuation">)</span>

<span class="token symbol"><span class="token variable">$</span>(OBJDIR)</span><span class="token punctuation">:</span>
        mkdir <span class="token variable">$</span><span class="token punctuation">(</span>OBJDIR<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>\u666E\u901A\u4F9D\u8D56\uFF0C A \u4F9D\u8D56 D\uFF0C\u4E14 D \u6CA1\u6709\u5176\u4ED6\u4F9D\u8D56\uFF0C\u5219</p><ol><li>\u6267\u884C make A \u65F6\uFF0C\u82E5 D \u4E0D\u5B58\u5728\uFF0C\u6267\u884C D \u5BF9\u5E94\u7684 recipe\uFF0C\u7136\u540E\u66F4\u65B0 A</li><li>\u6267\u884C make A \u65F6\uFF0C\u82E5 D \u5B58\u5728\uFF0C\u4E0D\u6267\u884C D \u7684 recipe\uFF0C\u4F46\u82E5 D \u6BD4 A \u65B0\uFF0C\u5219\u9700\u8981\u66F4\u65B0 A</li></ol><p>\u5BF9\u4E8E order-only \u4F9D\u8D56\uFF0C\u540C\u6837\u7684\u4F9D\u8D56\u5173\u7CFB\uFF0C\u5219</p><ol><li>\u6267\u884C make A \u65F6\uFF0C\u82E5 D \u4E0D\u5B58\u5728\uFF0C\u6267\u884C D \u5BF9\u5E94\u7684 recipe\uFF0C\u7136\u540E\u66F4\u65B0 A</li><li>\u6267\u884C make A \u65F6\uFF0C\u82E5 D \u5B58\u5728\uFF0C\u4E0D\u6267\u884C D \u7684 recipe\uFF0C\u4F46\u5373\u4F7F D \u6BD4 A \u65B0\uFF0C\u4E5F\u4E0D\u4F1A\u56E0\u4E3A D \u53BB\u66F4\u65B0 A</li></ol><p>Q. \u5982\u679C D \u6709\u666E\u901A\u4F9D\u8D56\uFF0C\u4E14D\u7684\u8FD9\u4E2A\u4F9D\u8D56\u66F4\u65B0\u4E86\u5462\uFF1F Ans\uFF1A\u6211\u731C\uFF0CD \u4F1A\u56E0\u6B64\u66F4\u65B0\uFF0C\u800C A \u4E0D\u4F1A\u56E0\u6B64\u66F4\u65B0\u3002</p><h2 id="_4-4-\u5728\u6587\u4EF6\u540D\u4E2D\u4F7F\u7528\u901A\u914D\u7B26" tabindex="-1"><a class="header-anchor" href="#_4-4-\u5728\u6587\u4EF6\u540D\u4E2D\u4F7F\u7528\u901A\u914D\u7B26" aria-hidden="true">#</a> 4.4 \u5728\u6587\u4EF6\u540D\u4E2D\u4F7F\u7528\u901A\u914D\u7B26</h2><p>\u5355\u4E2A\u6587\u4EF6\u540D\u9879\u53EF\u4EE5\u5BF9\u5E94\u591A\u4E2A\u6587\u4EF6\uFF0C\u53EA\u8981\u4F7F\u7528\u901A\u914D\u7B26\u3002make \u4E2D\u7684\u901A\u914D\u7B26\u5305\u62EC * ? [...]\uFF0C\u5C31\u548C shell \u4E2D\u7684\u8BED\u6CD5\u4E00\u6837\u3002 make \u4E5F\u652F\u6301 ~ \u5BB6\u76EE\u5F55\u6269\u5C55\uFF0C\u4E5F\u548C shell \u4E2D\u7684\u8BED\u6CD5\u4E00\u81F4\uFF0C\u5728\u6CA1\u6709\u5BB6\u76EE\u5F55\u6982\u5FF5\u7684\u7CFB\u7EDF\u4E0A\uFF08\u5982 DOS\u548CWindows\uFF09\uFF0C\u53EA\u6D88\u8BBE\u7F6E \u73AF\u5883\u53D8\u91CFHOME\u5C31\u540C\u6837\u53EF\u4EE5\u4F7F\u5BB6\u76EE\u5F55\u6269\u5C55\u751F\u6548\u3002 ps\uFF1A\u663E\u7136\u662F\u6269\u5C55\u4E3A HOME \u53D8\u91CF\u5BF9\u5E94\u7684\u503C\u3002</p><p>\u5728 target \u548C prerequisite \u4E2D\u7684\u901A\u914D\u7B26\uFF0C\u7531 make \u8D1F\u8D23\u6269\u5C55\uFF0C\u5728 recipe \u4E2D\u7684\u901A\u914D\u7B26\u7531shell\u8D1F\u8D23\u6269\u5C55\uFF0C \u5728\u5176\u5B83\u4E0A\u4E0B\u6587\u4E2D\uFF0C\u5F53\u4E14\u4EC5\u5F53\u4F7F\u7528\u4E86 wildcard \u51FD\u6570\uFF0C\u901A\u914D\u7B26\u6269\u5C55\u624D\u4F1A\u751F\u6548\u3002</p><p>\u8981\u53D6\u6D88\u901A\u914D\u7B26\u5B57\u7B26\u7684\u7279\u6B8A\u542B\u4E49\uFF0C\u7528\u53CD\u659C\u6760\u8F6C\u4E49\u5373\u53EF\u3002<code>foo\\*bar</code>\u3002</p><p>Q. $ \u5B57\u7B26\u7684\u7279\u6B8A\u542B\u4E49\u53EF\u4EE5\u7528\u53CD\u659C\u6760\u5904\u7406\u5417\uFF1F Ans: \u5B9E\u6D4B\u4E0D\u80FD\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>file<span class="token operator">=</span>hello.c

<span class="token symbol">hello2</span><span class="token punctuation">:</span> \\<span class="token variable">$</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> hello2
make: *** No rule to <span class="token function">make</span> target <span class="token string">&#39;\\hello.c&#39;</span>, needed by <span class="token string">&#39;hello2&#39;</span><span class="token builtin class-name">.</span>  Stop.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5982\u679C\u786E\u5B9E\u53D6\u6D88\u4E86 $ \u7684\u7279\u6B8A\u542B\u4E49\uFF0C\u5219\u5E94\u5F53\u63D0\u793A\u627E\u4E0D\u5230\u6587\u4EF6 <code>$(file)</code>\uFF1B\u5982\u679C\u4ECD\u65E7\u66FF\u6362\u4E86\u53D8\u91CF\u503C\uFF0C \u624D\u4F1A\u63D0\u793A\u627E\u4E0D\u5230\u6587\u4EF6 <code>\\hello.c</code>\u3002</p><h3 id="_4-4-1-\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_4-4-1-\u793A\u4F8B" aria-hidden="true">#</a> 4.4.1 \u793A\u4F8B</h3><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">print</span><span class="token punctuation">:</span> *.c
        lpr -p <span class="token variable">$?</span>
        touch print
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>`,25),Va=a("\u6BCF\u6B21\uFF0C\u90FD\u4F1A\u6253\u5370\u81EA\u4E0A\u6B21\u6253\u5370\u4EE5\u6765\u53D1\u751F\u53D8\u5316\u7684 c \u6587\u4EF6\u3002print \u662F\u4E00\u4E2A\u7A7A\u6587\u4EF6\uFF0C\u53C2\u8003 "),Ua={href:"https://www.gnu.org/software/make/manual/make.html#Empty-Targets",title:"4.8 Empty Target Files to Record Events",target:"_blank",rel:"noopener noreferrer"},Ba=a("Empty Target Files to Record Events"),Wa=a("."),Qa=t(`<h3 id="_4-4-2-\u9677\u9631" tabindex="-1"><a class="header-anchor" href="#_4-4-2-\u9677\u9631" aria-hidden="true">#</a> 4.4.2 \u9677\u9631</h3><p>make \u548C shell \u7684\u81EA\u52A8\u901A\u914D\u7B26\u6269\u5C55\uFF0C\u5F53\u6CA1\u6709\u4EFB\u4F55\u5339\u914D\u7684\u6587\u4EF6\u540D\u65F6\uFF0C\u6A21\u5F0F\u4F1A\u4FDD\u6301\u4E0D\u53D8\uFF0C\u5904\u7406\u4E0D\u5F53\u5C31\u4F1A\u51FA\u95EE\u9898\u3002\u7528 wildcard \u51FD\u6570\u53EF\u4EE5\u89E3\u51B3\u3002 \u5F53\u4E0D\u5B58\u5728\u4E0E\u6A21\u5F0F\u5339\u914D\u7684\u6587\u4EF6\u540D\u65F6\uFF0Cwildcard \u51FD\u6570\u4F1A\u6269\u5C55\u4E3A\u7A7A\u3002 \u4F8B\u5982\uFF0C\u4E0B\u9762\u7684\u89C4\u5219\u4F1A\u7528\u5DE5\u4F5C\u76EE\u5F55\u4E0B\u7684\u6240\u6709 .o \u6587\u4EF6\u6784\u5EFA\u751F\u6210\u53EF\u6267\u884C\u7A0B\u5E8F foo\uFF0C\u5F53\u67D0\u4E2A .o \u6587\u4EF6\u53D1\u751F\u53D8\u5316\uFF0C\u8FD8\u4F1A\u6B63\u786E\u66F4\u65B0 foo \u6587\u4EF6\u3002 \u95EE\u9898\u6765\u4E86\uFF0C\u5982\u679C\u6240\u6709\u7684 .o \u6587\u4EF6\u90FD\u88AB\u5220\u9664\u4E86\uFF0C<code>*.o</code> \u5C31\u4FDD\u6301\u4E0D\u53D8\uFF0Cfoo \u4F1A\u4F9D\u8D56\u540D\u4E3A <code>*.o</code> \u7684\u6587\u4EF6\uFF0C\u8FD9\u4E2A\u6587\u4EF6\u5927\u6982\u7387\u4E0D\u5B58\u5728\uFF0C\u8FDB\u800C \u5BFC\u81F4\u62A5\u9519 \u627E\u4E0D\u5230\u6587\u4EF6 <code>*.o</code>\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo</span><span class="token punctuation">:</span> *.o
  cc -o <span class="token variable">$@</span> <span class="token variable">$^</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>windows \u548C dos \u7CFB\u7EDF\u4E0A\uFF0C\u8DEF\u5F84\u5206\u9694\u7B26\u662F\u53CD\u659C\u6760\uFF0C\u5728\u8FD9\u4E9B\u7CFB\u7EDF\u884C\uFF0Cmake \u540C\u65F6\u652F\u6301\u4E24\u79CD\u98CE\u683C\u7684\u8DEF\u5F84\u5206\u9694\u7B26\uFF0C\u5982 <code>C:\\foo\\bar</code> \u548C <code>C:/foo/bar</code> \u5728 make \u4E2D\u662F\u7B49\u540C\u7684\uFF0C\u4F46\u5982\u679C\u4F7F\u7528\u4E86\u901A\u914D\u7B26\uFF0C\u5C31\u53EA\u80FD\u4F7F\u7528 unix \u98CE\u683C\u7684\u8DEF\u5F84\u5206\u9694\u7B26\uFF0C \u5982 <code>C:/foo/*.c</code>\uFF0C\u56E0\u4E3A\u901A\u914D\u7B26\u914D\u53CD\u659C\u6760\uFF0C\u4F1A\u88AB\u53D6\u6D88\u901A\u914D\u529F\u80FD\u3002</p><h3 id="_4-4-3-wildcard-\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#_4-4-3-wildcard-\u51FD\u6570" aria-hidden="true">#</a> 4.4.3 wildcard \u51FD\u6570</h3><p>wildcard \u8BED\u6CD5 <code>$(wildcard patern patern ...)</code>\u3002</p><p>\u8FD8\u662F\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u6B63\u786E\u7684\u65B9\u5F0F\u5982\u4E0B</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>objects<span class="token operator">:=</span><span class="token variable">$</span><span class="token punctuation">(</span><span class="token keyword">patsubst</span> %.c,%.o, <span class="token variable">$</span><span class="token punctuation">(</span>whildcard *.c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token symbol">foo</span><span class="token punctuation">:</span> <span class="token variable">$</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$^</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7528\u6240\u6709\u7684 .c \u6587\u4EF6\u5F97\u5230\u5BF9\u5E94\u7684 .o \u6587\u4EF6\u540D\u3002 \u501F\u52A9\u9690\u5F0F\u89C4\u5219\uFF0C\u7528 .c -&gt; .o \u7684\u7F16\u8BD1\uFF0C\u4E0D\u9700\u8981\u663E\u793A\u5217\u51FA\u3002</p><h2 id="_4-5-prerequisite-\u7684\u641C\u7D22\u8DEF\u5F84-\u5F85\u7EED" tabindex="-1"><a class="header-anchor" href="#_4-5-prerequisite-\u7684\u641C\u7D22\u8DEF\u5F84-\u5F85\u7EED" aria-hidden="true">#</a> 4.5 prerequisite \u7684\u641C\u7D22\u8DEF\u5F84 \u5F85\u7EED</h2><p>Searching Directories for Prerequisites</p><p>\u5728\u6BD4\u8F83\u5927\u7684\u8F6F\u4EF6\u7CFB\u7EDF\u4E2D\uFF0C\u5E38\u5E38\u4F1A\u628A\u6E90\u4EE3\u7801\u653E\u7F6E\u5728\u4E0D\u540C\u7684\u8DEF\u5F84\u4E0B\uFF08ps\uFF1A\u6BD4\u5982 .c \u548C .h \u5206\u5F00\u5B58\u653E\uFF09\u3002 make \u5DE5\u5177\u63D0\u4F9B\u76EE\u5F55\u641C\u7D22\uFF08directory search\uFF09\u529F\u80FD\uFF0C\u5F53\u76EE\u5F55\u8C03\u6574\u76EE\u5F55\u7ED3\u6784\u65F6\uFF0C\u65E0\u9700\u66F4\u6539\u5177\u4F53 \u7684\u89C4\u5219\uFF0C\u53EA\u9700\u8981\u8C03\u6574\u4E00\u4E0B\u641C\u7D22\u8DEF\u5F84\u5C31\u884C\u3002</p><p>\u8BBE\u7F6E\u641C\u7D22\u8DEF\u5F84\uFF0C\u6709\u4E24\u79CD\u65B9\u5F0F\uFF0CVPATH \u53D8\u91CF\u8BBE\u7F6E\u5168\u5C40\u641C\u7D22\u8DEF\u5F84\uFF0Cvpath \u6307\u4EE4\u5BF9\u4E0D\u540C\u6A21\u5F0F\u7684\u6587\u4EF6\u8BBE\u7F6E\u4E0D\u540C\u7684\u641C\u7D22\u8DEF\u5F84\u3002</p><p>PS\uFF1A\u6211\u53EF\u4EE5\u628A\u76EE\u5F55\u8BBE\u7F6E\u4E3A\u53D8\u91CF\uFF0C\u5199\u5165\u5230\u89C4\u5219\u4E2D\u554A\uFF0C\u514D\u5F97\u641C\u7D22\u4E86\u3002 Ans\uFF1A1. \u8BBE\u7F6E\u53D8\u91CF\uFF0C\u53D8\u91CF\u5C31\u53D8\u591A\u4E86\u30022. \u62C6\u6210\u4E24\u4E2A\u76EE\u5F55\uFF0C\u9700\u8981\u4E24\u4E2A\u53D8\u91CF\uFF0C\u5C06\u6765\u9700\u8981\u6539\u6210\u4E09\u4E2A\u76EE\u5F55\u7684\u65F6\u5019\u5C31\u8981\u589E\u52A0\u4E00\u4E2A\u53D8\u91CF\uFF0C\u8FD8\u662F\u5F97\u4FEE\u6539\u89C4\u5219\u3002</p><h3 id="_4-5-1-vpath-\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_4-5-1-vpath-\u53D8\u91CF" aria-hidden="true">#</a> 4.5.1 VPATH \u53D8\u91CF</h3><p>VPATH \u53D8\u91CF\u6307\u5B9A make \u5DE5\u5177\u4F7F\u7528\u7684\u641C\u7D22\u76EE\u5F55\u5217\u8868\u3002\u901A\u5E38\uFF0C\u8FD9\u4E9B\u641C\u7D22\u8DEF\u5F84\u7528\u4E8E\u641C\u7D22\u4E0D\u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u7684 prerequisite\uFF0C\u800C\u5B9E\u9645\u4E0A\uFF0Cmake \u4F1A\u5728\u8FD9\u4E9B\u76EE\u5F55\u4E2D\u540C\u65F6\u641C\u7D22\u4E0D\u5728\u5F53\u524D\u76EE\u5F55\u7684 target \u548C prerequisite\u3002</p><p>\u5982\u679C\u5F53\u524D\u76EE\u5F55\u4E0B\u627E\u4E0D\u5230\u6307\u5B9A\u7684 target \u6216 prerequisite\uFF0Cmake \u4F1A\u5728 VPATH \u5217\u51FA\u7684\u76EE\u5F55\u4E2D\u641C\u7D22\uFF0C \u5982\u679C\u627E\u5230\u4E86\uFF0Cmake \u5C31\u628A\u5B83\u7528\u4F5C prerequisite\uFF0C\u800C\u89C4\u5219\u7684 target \u6216 prerequisite \u4E2D\uFF0C\u53EF\u4EE5 \u628A\u8FD9\u4E2A\u6587\u4EF6\u89C6\u4E3A\u5B58\u5728\u4E8E\u5F53\u524D\u76EE\u5F55\u4E0B\u90A3\u6837\u6307\u5B9A\u6587\u4EF6\u540D\u3002</p><p>VPATH \u53D8\u91CF\u6307\u5B9A\u76EE\u5F55\u5217\u8868\uFF0C\u5404\u4E2A\u76EE\u5F55\u9879\u7528\u7A7A\u767D\u6216\u8005\u5192\u53F7\u505A\u5206\u9694\u7B26\uFF08DOS\u548CWindows\u4E0B\u7528\u5206\u53F7\u4EE3\u66FF\u5192\u53F7\uFF09\u3002 make \u641C\u7D22\u65F6\uFF0C\u4F1A\u6309\u7167\u5217\u8868\u4E2D\u7684\u5148\u540E\u987A\u5E8F\u641C\u7D22\uFF0C\u627E\u5230\u540E\u5373\u4E0D\u518D\u641C\u7D22\u540E\u7EED\u76EE\u5F55\u3002</p><p>\u5047\u8BBE src \u76EE\u5F55\u4E0B\u6709\u6E90\u4EE3\u7801\u6587\u4EF6 foo.c\uFF0C\u5219\u5982\u4E0B\u89C4\u5219</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>VPATH <span class="token operator">=</span> src<span class="token punctuation">:</span>../headers

<span class="token symbol">foo.o</span> <span class="token punctuation">:</span> foo.c
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u6548\u679C\u4E0A\u7B49\u540C\u4E8E</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo.o</span> <span class="token punctuation">:</span> src/foo.c
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="_4-5-2-vpath-\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#_4-5-2-vpath-\u6307\u4EE4" aria-hidden="true">#</a> 4.5.2 vpath \u6307\u4EE4</h3><p>vpath \u6BD4 VPATH \u66F4\u7075\u6D3B\uFF0C\u5B83\u5141\u8BB8\u4E3A\u4E0D\u540C\u7C7B\u522B\u7684\u6587\u4EF6\u6307\u5B9A\u4E0D\u540C\u641C\u7D22\u8DEF\u5F84\u3002</p><ul><li>vpath pattern directories \u4E3A\u7B26\u5408\u6307\u5B9A\u6A21\u5F0F\u7684\u6587\u4EF6\u6307\u5B9A\u641C\u7D22\u8DEF\u5F84</li><li>vpath pattern \u6E05\u7A7A\u6307\u5B9A\u6A21\u5F0F\u7684\u641C\u7D22\u76EE\u5F55</li><li>vpath \u6E05\u7A7A\u6240\u6709\u6A21\u5F0F\u7684\u641C\u7D22\u76EE\u5F55</li></ul><p>patern \u4F7F\u7528 % \u4F5C\u4E3A\u7279\u6B8A\u5B57\u7B26\uFF0C\u5B83\u5339\u914D\u4EFB\u610F\u957F\u5EA6\u7684\u5B57\u7B26\u5E8F\u5217\uFF08\u5305\u62EC\u96F6\u4E2A\uFF09\u3002\u53CD\u659C\u6760\u8F6C\u4E49\u53EF\u4EE5\u53D6\u6D88 \u5176\u7279\u6B8A\u542B\u4E49\uFF08%\uFF09\u3002</p><p>\u5982\u679C\u4E00\u4E2A\u6587\u4EF6\u5339\u914D\u591A\u4E2A vpath \u6307\u5B9A\u7684\u6A21\u5F0F\uFF0C\u5219\u8FD9\u4E9B\u6A21\u5F0F\u7684\u6587\u672C\u987A\u5E8F\u4F9D\u6B21\u5E94\u7528\uFF0C\u4F7F\u7528\u7B2C\u4E00\u4E2A\u641C\u7D22\u6210\u529F\u7684\u6A21\u5F0F\u3002</p><p>\u4E3E\u4E2A\u4F8B\u5B50</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">vpath %.h src/include/</span><span class="token punctuation">:</span><span class="token keyword">include</span>/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>Q. \u540C\u65F6\u6709 VPATH \u548C vpath \u5462\uFF1F</p><h3 id="_4-5-3-\u76EE\u5F55\u641C\u7D22\u662F\u5982\u4F55\u6267\u884C\u7684" tabindex="-1"><a class="header-anchor" href="#_4-5-3-\u76EE\u5F55\u641C\u7D22\u662F\u5982\u4F55\u6267\u884C\u7684" aria-hidden="true">#</a> 4.5.3 \u76EE\u5F55\u641C\u7D22\u662F\u5982\u4F55\u6267\u884C\u7684</h3><p>\u6709\u8FD9\u4E48\u4E00\u4E2A\u95EE\u9898\uFF0C\u89C4\u5219 <code>foo.o: foo.c</code>\uFF0C\u800C foo.c \u5728 src/ \u4E0B\u641C\u7D22\u5230\u4E86\uFF0C\u90A3\u4E48 make \u4F7F\u7528 \u8FD9\u4E2A\u6587\u4EF6\u7684\u65F6\u5019 foo.c \u7684\u65F6\u5019\u662F foo.c \u8FD8\u662F src/foo.c\uFF1F\u4E5F\u5C31\u662F\u641C\u7D22\u8DEF\u5F84\u8981\u4E0D\u8981\u52A0\u4E0A\u53BB\uFF1F</p><p>make \u6709\u5BF9\u5E94\u7684\u89C4\u5219</p><ol><li>\u5982\u679C\u5F53\u524D\u76EE\u5F55\u4E0B\u627E\u4E0D\u5230 target file\uFF0C\u5C31\u5230\u641C\u7D22\u76EE\u5F55\u4E0B\u67E5\u627E</li><li>\u5982\u679C\u627E\u5230\u4E86\uFF0C\u5C31\u6682\u65F6\u7528\u5B9E\u9645\u8DEF\u5F84\u505A target file \u7684\u8DEF\u5F84\uFF0C\u6BD4\u5982\u7528 obj/foo.o \u505A target foo.o \u7684\u8DEF\u5F84</li><li>\u8FD9\u4E2A target file \u7684\u6240\u6709 prerequisite \u4E5F\u662F\u5982\u6B64\u5904\u7406</li><li>\u5904\u7406\u5B8C target file\u7684\u6240\u6709 prerequisite\u4E4B\u540E</li></ol><ul><li>\u82E5 target \u4E0D\u9700\u8981\u66F4\u65B0\uFF0C\u5219\u6240\u6709\u4EE5\u5F53\u524D target file \u505A prerequisite \u7684\u89C4\u5219\u4E2D\uFF0C\u4F7F\u7528\u641C\u7D22\u5230\u7684\u5B8C\u6574\u8DEF\u5F84\u505A prerequisite \u8DEF\u5F84\u540D</li><li>\u82E5 target \u9700\u8981\u66F4\u65B0\uFF0C\u5219\u4E22\u5F03\u641C\u7D22\u8DEF\u5F84\uFF0C\u76F4\u63A5\u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u6784\u5EFA target</li></ul><p>\u89C4\u5219\u7565\u663E\u590D\u6742\uFF0C\u4F46\u5927\u591A\u6570\u65F6\u5019\u8FD9\u6B63\u662F\u6240\u671F\u671B\u7684\u884C\u4E3A\u3002</p><p>\u5176\u5B83\u7248\u672C\u7684 make \u5DE5\u5177\u4F7F\u7528\u66F4\u7B80\u5355\u7684\u89C4\u5219\uFF1A\u5982\u679C\u5728\u76EE\u5F55\u641C\u7D22\u8FC7\u7A0B\u4E2D\u627E\u5230\u4E86 target file\uFF0C\u90A3\u603B\u662F\u4F7F\u7528\u641C\u7D22\u5230\u7684 pathname\u3002 \u5982\u679C\u8FD9\u662F\u671F\u671B\u7684\u884C\u4E3A\uFF0C\u53EA\u9700\u8981\u628A\u8FD9\u4E9B\u641C\u7D22\u76EE\u5F55\u6DFB\u52A0\u5230 GPATH \u53D8\u91CF\u4E2D\u5373\u53EF\u3002\u8FD9\u4E2A\u53D8\u91CF\u7684\u8BBE\u7F6E\u89C4\u5219\u540CVPATH\u3002</p><p>PS: \u6211\u8865\u5145\u4E00\u4E2A\u793A\u4F8B\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">vpath</span> %.o build/obj
<span class="token keyword">vpath</span> %.c src
<span class="token symbol">foo</span><span class="token punctuation">:</span> foo.o
  <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$^</span> -o <span class="token variable">$@</span>
<span class="token symbol">foo.o</span><span class="token punctuation">:</span> foo.c
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u6267\u884C\u547D\u4EE4 <code>make foo</code>\uFF0C\u5982\u679C\u5B58\u5728\u6587\u4EF6 build/obj/foo.o \u4E14\u4E0D\u9700\u8981\u66F4\u65B0\uFF0C\u5219 foo: foo.o \u4E2D\uFF0C<code>$^</code> \u4F1A\u53D8\u6210 build/obj/foo.o\uFF1B\u5982\u679C \u6587\u4EF6\u4E0D\u5B58\u5728\uFF0C\u5219\u4F1A\u4F7F\u7528 src/foo.c \u7F16\u8BD1\u751F\u6210 ./foo.o\uFF0C\u7136\u540E\u89C4\u5219 foo: foo.o \u4E2D <code>$^</code> \u4F1A\u53D8\u6210 foo.o\u3002</p><p>PS\uFF1A</p><h3 id="_4-5-4-\u4E66\u5199\u53EF\u4EE5\u9002\u914D-directory-search-\u7684-recipe" tabindex="-1"><a class="header-anchor" href="#_4-5-4-\u4E66\u5199\u53EF\u4EE5\u9002\u914D-directory-search-\u7684-recipe" aria-hidden="true">#</a> 4.5.4 \u4E66\u5199\u53EF\u4EE5\u9002\u914D Directory Search \u7684 recipe</h3><p>\u4E00\u53E5\u8BDD\uFF0C\u9700\u8981\u501F\u52A9\u81EA\u52A8\u53D8\u91CF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo.o</span> <span class="token punctuation">:</span> foo.c
        cc -c <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$^</span> -o <span class="token variable">$@</span>
VPATH <span class="token operator">=</span> src<span class="token punctuation">:</span>../headers
<span class="token symbol">foo.o</span> <span class="token punctuation">:</span> foo.c defs.h hack.h
        cc -c <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$&lt;</span> -o <span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-5-5-directory-search-\u548C-implicit-rule" tabindex="-1"><a class="header-anchor" href="#_4-5-5-directory-search-\u548C-implicit-rule" aria-hidden="true">#</a> 4.5.5 Directory Search \u548C implicit rule</h3><p>\u8C08\u5230\u76EE\u5F55\u641C\u7D22\uFF0C\u9690\u5F0F\u89C4\u5219\u548C\u663E\u5F0F\u89C4\u5219\u4E00\u6837\u4F1A\u5C1D\u8BD5\u641C\u7D22\u3002</p><p>\u6BD4\u5982\uFF0C\u5982\u679C\u6CA1\u6709\u660E\u786E\u6307\u5B9A\u751F\u6210 foo.o \u7684\u89C4\u5219\uFF0C\u4F1A\u5C1D\u8BD5\u9690\u5F0F\u89C4\u5219\uFF0C\u5148\u67E5\u770B\u5F53\u524D\u76EE\u5F55\u662F\u5426\u5B58\u5728 .c \u6587\u4EF6\uFF0C \u5982\u679C\u6CA1\u6709\uFF0C\u4F1A\u67E5\u770BVPATH\u3001vpath \u8BBE\u7F6E\u5B9A\u76EE\u5F55\u4E2D\u6709\u6CA1\u6709\uFF0C\u5982\u679C\u6709\uFF0C\u5C31\u5339\u914D\u4E0A\u4E86\u3002</p><h3 id="_4-5-6-directory-search-\u548C\u94FE\u63A5\u5E93-\u7565" tabindex="-1"><a class="header-anchor" href="#_4-5-6-directory-search-\u548C\u94FE\u63A5\u5E93-\u7565" aria-hidden="true">#</a> 4.5.6 Directory Search \u548C\u94FE\u63A5\u5E93 \u7565</h3><p>\u5BF9\u4E8E\u94FE\u63A5\u5E93\uFF0Cmake \u4F1A\u505A\u7279\u6B8A\u5904\u7406\u3002 ps\uFF1A\u7528\u5230\u7684\u65F6\u5019\u518D\u8BE6\u67E5\u624B\u518C\u3002</p><p>\u6BD4\u5982\uFF0C\u8981\u7528\u5230 curses \u5E93\uFF0C\u4E0D\u662F\u6307\u5B9A libcurses.so\uFF0C\u800C\u662F\u4EE5 -lcurses \u7684\u5F62\u5F0F\u6307\u5B9A\u4F9D\u8D56\uFF0Cmake\u4F1A\u77E5\u9053 \u8FD9\u662F\u5E93\u6587\u4EF6\u4F9D\u8D56\uFF0C\u5C31\u4F1A\u641C\u7D22 libcurse.so\uFF0C\u627E\u4E0D\u5230\u4F1A\u7EE7\u7EED\u5C1D\u8BD5 libcurse.a\u3002 \u8FD8\u4F1A\u5C1D\u8BD5\u5404\u79CD\u7CFB\u7EDF\u5185\u7F6E\u8DEF\u5F84\u2026\u2026</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo</span> <span class="token punctuation">:</span> foo.c -lcurses
        cc <span class="token variable">$^</span> -o <span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_4-6-phony-target" tabindex="-1"><a class="header-anchor" href="#_4-6-phony-target" aria-hidden="true">#</a> 4.6 Phony target</h2><blockquote><p>A phony target is one that is not really the name of a file; rather it is just a name for a recipe to be executed when you make an explicit request. There are two reasons to use a phony target: to avoid a conflict with a file of the same name, and to improve performance.</p></blockquote><p>\u4F2A\u76EE\u6807\u6709\u4E24\u4E2A\u597D\u5904\uFF1A</p><ol><li>\u660E\u786E\u67D0\u4E2A target \u53EA\u662F\u4E00\u4E2A\u52A8\u4F5C\uFF0C\u4E0D\u4EE3\u8868\u5B9E\u9645\u7684\u6587\u4EF6</li><li>\u56E0\u6B64\u53EF\u4EE5\u63D0\u5347\u6027\u80FD\uFF1A\u4E0D\u4F1A\u5BF9\u4F2A\u76EE\u6807\u641C\u7D22\u9690\u5F0F\u89C4\u5219\uFF0C\u4E0D\u4F1A\u5BF9\u4F2A\u76EE\u6807\u6D4B\u8BD5\u5BF9\u5E94\u7684\u6587\u4EF6\u7684\u4FEE\u6539\u65F6\u95F4</li></ol><p>\u4F2A\u76EE\u6807\u4E0D\u5E94\u5F53\u4F5C\u4E3A\u771F\u5B9E\u76EE\u6807\u7684\u4F9D\u8D56\uFF0C\u4E0D\u7136\u7684\u8BDD\uFF0C\u6BCF\u6B21\u68C0\u6D4B\u8FD9\u4E2A\u771F\u5B9E\u76EE\u6807\uFF0C\u5B83\u90FD\u9700\u8981\u6267\u884C\u3002</p><p>Q. \u771F\u8FD9\u4E48\u505A\u4E86\uFF0C\u4F1A\u5982\u4F55\uFF1F</p><p>\u4F2A\u76EE\u6807\u53EF\u4EE5\u6709\u4F9D\u8D56\uFF0C\u6BD4\u5982\uFF0C\u5E38\u5E38\u7528\u4F2A\u76EE\u6807 all \u4E00\u6B21\u6027\u6784\u5EFA\u9879\u76EE\u7684\u6240\u6709\u7A0B\u5E8F\u3002 \u4F2A\u76EE\u6807\u4E0D\u4F1A\u4F20\u9012\uFF1A\u4F2A\u76EE\u6807\u7684 prerequisite \u4E0D\u4F1A\u81EA\u52A8\u6210\u4E3A\u4F2A\u76EE\u6807\uFF0C\u9664\u975E\u660E\u786E\u58F0\u660E\u4E3A\u4F2A\u76EE\u6807\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">all</span> <span class="token punctuation">:</span> prog1 prog2 prog3
<span class="token builtin">.PHONY</span> <span class="token punctuation">:</span> all

<span class="token symbol">prog1</span> <span class="token punctuation">:</span> prog1.o utils.o
        cc -o prog1 prog1.o utils.o

<span class="token symbol">prog2</span> <span class="token punctuation">:</span> prog2.o
        cc -o prog2 prog2.o

<span class="token symbol">prog3</span> <span class="token punctuation">:</span> prog3.o sort.o utils.o
        cc -o prog3 prog3.o sort.o utils.o
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u4F2A\u76EE\u6807\u53EF\u4EE5\u4F5C\u4E3A\u53E6\u4E00\u4E2A\u4F2A\u76EE\u6807\u7684\u4F9D\u8D56\uFF0C\u6B64\u65F6\u4F5C\u4E3A prerequisite \u7684\u4F2A\u76EE\u6807\u626E\u6F14\u5B50\u7A0B\u5E8F\u7684\u89D2\u8272\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.PHONY</span><span class="token punctuation">:</span> cleanall cleanobj cleandiff

<span class="token symbol">cleanall</span> <span class="token punctuation">:</span> cleanobj cleandiff
        rm program

<span class="token symbol">cleanobj</span> <span class="token punctuation">:</span>
        rm *.o

<span class="token symbol">cleandiff</span> <span class="token punctuation">:</span>
        rm *.diff
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_4-7-\u65E2\u6CA1\u6709-recipe-\u53C8\u6CA1\u6709-prerequisite-\u7684\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_4-7-\u65E2\u6CA1\u6709-recipe-\u53C8\u6CA1\u6709-prerequisite-\u7684\u89C4\u5219" aria-hidden="true">#</a> 4.7 \u65E2\u6CA1\u6709 recipe \u53C8\u6CA1\u6709 prerequisite \u7684\u89C4\u5219</h2><p>\u5982\u679C\u4E00\u4E2A\u89C4\u5219\u65E2\u6CA1\u6709 prerequisite \u4E5F\u6CA1\u6709 recipe\uFF0C\u4E14\u6B64\u89C4\u5219\u7684 target \u4E0D\u5BF9\u5E94\u5B9E\u9645\u5B58\u5728\u7684\u6587\u4EF6\uFF0C \u5219\u6BCF\u6B21\u6267\u884C\u6B64\u89C4\u5219\u7684\u65F6\u5019\uFF0C make \u90FD\u8BA4\u4E3A\u6B64\u89C4\u5219\u7684 target \u5904\u4E8E\u5DF2\u66F4\u65B0\u72B6\u6001\u3002\u4E00\u4E2A\u63A8\u8BBA\u662F\uFF0C \u6240\u6709\u4F9D\u8D56\u6B64target\u7684\u89C4\u5219\uFF0C\u5176 recipe \u603B\u662F\u4F1A\u6267\u884C\u3002</p><blockquote><p>If a rule has no prerequisites or recipe, and the target of the rule is a nonexistent file, then make imagines this target to have been updated whenever its rule is run. This implies that all targets depending on this one will always have their recipe run.</p></blockquote><p>\u4E0B\u9762\u8FD9\u4E2A\u4F8B\u5B50\uFF0C\u548C\u4F7F\u7528 <code>.PHONY: clean</code> \u7684\u6548\u679C\u662F\u4E00\u6837\u7684\uFF0C\u4F46\u4F7F\u7528 .PHONY \u66F4\u80FD\u660E\u786E\u8868\u8FBE\u610F\u56FE\uFF0C \u540C\u65F6\u6027\u80FD\u66F4\u9AD8\u3002\u4E0D\u8FC7\u6709\u4E9B make \u5DE5\u5177\u4E0D\u652F\u6301 .PHONY \u4F2A\u76EE\u6807\uFF0C\u6240\u4EE5\u53EF\u4EE5\u7528\u8FD9\u4E2A\u65B9\u5F0F\u4EE3\u66FF\u3002 FORCE \u8FD9\u4E2A\u540D\u79F0\u6CA1\u6709\u7279\u6B8A\u542B\u4E49\uFF0C\u53EA\u4E0D\u8FC7\u5927\u5BB6\u90FD\u8FD9\u4E48\u7528\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">clean</span><span class="token punctuation">:</span> FORCE
        rm <span class="token variable">$</span><span class="token punctuation">(</span>objects<span class="token punctuation">)</span>
<span class="token symbol">FORCE</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Q. \u539F\u6587 <code>Rules without Recipes or Prerequisites</code>\uFF0C\u5982\u4F55\u7406\u89E3\uFF1F</p><ol><li>\u662F\u6307 \u65E2\u6CA1\u6709 recipe \u53C8\u6CA1\u6709 prerequisite\uFF1F</li><li>\u8FD8\u662F\u6307\u5982\u4E0B\u4EFB\u610F\u4E00\u79CD\u60C5\u5F62\uFF1A - \u6CA1\u6709 recipe\uFF0C\u4F46\u6709 prerequisite - \u6709 recipe\uFF0C\u4F46\u6CA1\u6709 prerequisite - \u65E2\u6CA1\u6709 recipe\uFF0C\u53C8\u6CA1\u6709 prerequisite Ans\uFF1A\u6309\u65B9\u5F0F 1 \u7406\u89E3\u3002</li></ol><p>\u9644\uFF1A\u82F1\u8BED\u7528\u6CD5 \u4E0B\u9762\u56DB\u8BED\uFF1A</p><ul><li>without A and B</li><li>without A and without B</li><li>without A or B</li><li>without A or without B</li></ul><p>\u7B2C\u4E00\u79CD\u8868\u8FBE\u65B9\u5F0F\u3001\u7B2C\u4E8C\u79CD\u8868\u8FBE\u65B9\u5F0F\u548C\u7B2C\u4E09\u79CD\u8868\u8FBE\u65B9\u5F0F\u610F\u601D\u76F8\u540C\uFF0C\u90FD\u662FA \u548C B \u90FD\u6CA1\u6709\u3002 \u7B2C\u56DB\u79CD\u8868\u8FBE\u65B9\u5F0F\u662F\u201C\u6CA1\u6709 A \u6216\u6CA1\u6709 B\u201D\uFF0C\u5C31\u662F\u201C\u6CA1\u6709 A \u800C\u6709 B\uFF0C\u6216\u6CA1\u6709 B \u800C\u6709 A \u201D\u3002 \u8BF4 A \u548C B \u90FD\u6CA1\u6709\u4E0D\u8BE5\u7528\u7B2C\u56DB\u79CD\u8868\u8FBE\u65B9\u5F0F\u3002</p><h2 id="_4-8-\u7528\u7A7A\u7684target\u6587\u4EF6\u8BB0\u5F55\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#_4-8-\u7528\u7A7A\u7684target\u6587\u4EF6\u8BB0\u5F55\u4E8B\u4EF6" aria-hidden="true">#</a> 4.8 \u7528\u7A7A\u7684target\u6587\u4EF6\u8BB0\u5F55\u4E8B\u4EF6</h2><p>\u8FD9\u79CD\u7528\u6CD5\u662F\u4F2A\u76EE\u6807\u7684\u53D8\u79CD\u3002\u8FD9\u91CC\u5BF9\u5E94\u7684\u76EE\u6807\u6587\u4EF6\u53EF\u4EE5\u5B9E\u9645\u5B58\u5728\uFF0C\u6587\u4EF6\u5185\u5BB9\u65E0\u6240\u8C13\uFF0C\u4E00\u822C\u662F\u7A7A\u6587\u4EF6\u3002 \u6587\u4EF6\u7684\u6700\u540E\u4FEE\u6539\u65F6\u95F4\u624D\u662F\u91CD\u8981\u7684\u3002\u8FD9\u79CD target \u5E94\u5F53\u6709 prerequisite\uFF0C\u5982\u679C prerequisite \u662F\u7A7A\u7684\uFF0C\u8FD9\u6761\u89C4\u5219\u5C31\u6CA1\u6709\u610F\u4E49\u3002</p><p>\u4E0B\u9762\u8FD9\u4E2A\u4F8B\u5B50\uFF0Cmake print \u7528\u4E8E\u6253\u5370\u81EA\u4E0A\u6B21\u6253\u5370\u4E4B\u540E\u53D8\u5316\u4E86\u7684\u6587\u4EF6\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">print</span><span class="token punctuation">:</span> foo.c bar.c
        lpr -p <span class="token variable">$?</span>
        touch print
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_4-9-\u6709\u7279\u6B8A\u610F\u4E49\u7684\u5185\u7F6Etarget-\u90E8\u5206" tabindex="-1"><a class="header-anchor" href="#_4-9-\u6709\u7279\u6B8A\u610F\u4E49\u7684\u5185\u7F6Etarget-\u90E8\u5206" aria-hidden="true">#</a> 4.9 \u6709\u7279\u6B8A\u610F\u4E49\u7684\u5185\u7F6Etarget : \u90E8\u5206</h2><p>\u6709\u4E9B target \u7684\u540D\u79F0\u6709\u7279\u6B8A\u542B\u4E49\uFF0C\u5982\u679C\u51FA\u73B0\u5728 makefile \u4E2D\u3002</p><p>\u7528\u5230\u7684\u65F6\u5019\u67E5\u624B\u518C\u3002</p>`,78),Xa=e("li",null,[e("p",null,".PHONY \u6B64\u76EE\u6807\u7684\u4F9D\u8D56\u53EB\u505A\u4F2A\u76EE\u6807")],-1),Ya=e("li",null,[e("p",null,".SECONDEXPANSION \u5982\u679C\u5B9A\u4E49\u4E86\u6B64\u76EE\u6807\uFF0C\u4ECE\u5B9A\u4E49\u51FA\u5F80\u540E\uFF0C\u6240\u6709\u7684\u89C4\u5219\u7684prerequisite\u90FD\u5F00\u542F\u4E8C\u6B64\u6269\u5C55\u3002")],-1),za=a(".SILENT \u4F5C\u4E3A\u6B64\u76EE\u6807\u4F9D\u8D56\u7684target\uFF0C\u6267\u884C\u65F6\u4E0D\u4F1A\u56DE\u663E\u5B83\u7684 recipe .SILENT \u7684 recipe \u88AB\u5FFD\u7565\u3002\u5982\u679C .SILENT \u6CA1\u6709\u4F9D\u8D56\uFF0C\u5219\u6240\u6709\u89C4\u5219\u7684 recipe \u90FD\u4E0D\u56DE\u663E\u3002 \u66F4\u7CBE\u5DE7\u7684\u63A7\u5236\uFF0C\u53C2\u8003 "),Ja={href:"https://www.gnu.org/software/make/manual/make.html#Echoing",title:"5.2 Recipe Echoing",target:"_blank",rel:"noopener noreferrer"},Za=a("Recipe Echoing"),es=e("li",null,[e("p",null,".ONESHELL \u53EA\u8981\u5B9A\u4E49\u4E86\u8FD9\u4E2A target\u3002\u6240\u6709\u7684\u89C4\u5219\u90FD\u4F7F\u7528\u5355\u8FDB\u7A0B\uFF0C\u4E5F\u5C31\u662F \u6BCF\u4E2A\u89C4\u5219\u7684 recipe \u5728\u4E00\u4E2A shell \u8FDB\u7A0B\u4E2D\u6267\u884C\u3002\u9ED8\u8BA4\u662F recipe \u7684\u6BCF\u4E00\u884C\u4F7F\u7528\u4E00\u4E2Ashell\u8FDB\u7A0B\u3002")],-1),as=t(`<p>ps\uFF1A\u7279\u6B8A\u89C4\u5219\u90FD\u4EE5\u53E5\u70B9\u5F00\u5934\uFF0C\u5E76\u975E\u8BED\u6CD5\u89C4\u5219\u7684\u8981\u6C42\uFF0C\u800C\u662F\u6CBF\u88AD\u4E86\u76F8\u5E94\u7684\u4F20\u7EDF\u3002\u53C2\u8003\u624B\u518C\u3002</p><h2 id="_4-10-\u4E00\u4E2A\u89C4\u5219\u591A\u4E2A-target" tabindex="-1"><a class="header-anchor" href="#_4-10-\u4E00\u4E2A\u89C4\u5219\u591A\u4E2A-target" aria-hidden="true">#</a> 4.10 \u4E00\u4E2A\u89C4\u5219\u591A\u4E2A target</h2><p>\u4E00\u6761\u663E\u5F0F\u89C4\u5219\u53EF\u4EE5\u5199\u591A\u4E2A target\uFF0C\u8FD9\u591A\u4E2A target \u7684\u5173\u7CFB\u5206\u4E3A\u4E24\u79CD\uFF0C\u72EC\u7ACB\u7684 target \u548C grouped target(\u7EC4\u5408target)\uFF0C\u533A\u5206\u8FD9\u4E8C\u8005\u7684\u65B9\u5F0F\u662F target \u5217\u8868\u540E\u7684\u5206\u9694\u7B26\uFF0C\u666E\u901A\u5192\u53F7\u5206\u9694\u7B26 \u662F\u72EC\u7ACBtarget\uFF0C<code>&amp;:</code>\u662F\u7EC4\u5408target\uFF0C&amp; \u7684\u542B\u4E49\u662F all\u3002</p><p>\u72EC\u7ACB target \u6CA1\u6709\u7279\u522B\u7684\u610F\u4E49\uFF0C\u53EF\u4EE5\u770B\u4F5C\u4E00\u79CD\u7B80\u5199\u65B9\u5F0F\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u7B49\u4EF7\u4E8E target \u5206\u5F00\u5199\uFF0C \u7136\u540E\u91CD\u590D prerequisite \u548C recipe \u90E8\u5206\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo.o bar.o baz.o</span><span class="token punctuation">:</span> common.h
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7B49\u4EF7\u4E8E</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo.o</span><span class="token punctuation">:</span> common.h
<span class="token symbol">bar.o</span><span class="token punctuation">:</span> common.h
<span class="token symbol">baz.o</span><span class="token punctuation">:</span> common.h
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u7EC4\u5408 target \u5219\u4E0D\u540C\uFF0C\u5B83\u544A\u8BC9 make\uFF0C\u53EA\u8981\u6267\u884C\u6B64\u89C4\u5219\u5BF9\u5E94\u7684 recipe\uFF0C\u540C\u4E00\u7EC4\u5185\u7684\u6240\u6709 target \u90FD\u4F1A\u88AB\u66F4\u65B0\uFF0C\u8FD9\u5728\u8BA1\u7B97\u4F9D\u8D56\u5173\u7CFB\u7684\u65F6\u5019\uFF0Cmake \u8981\u8003\u8651\u5230\u3002\u8FD9\u6709\u4EC0\u4E48\u7528\u5904\u5462\uFF1F\u6BD4\u5982\uFF0C\u53EF\u80FD\u5355\u4E2A\u547D\u4EE4 \u4F1A\u4E00\u6B21\u6027\u751F\u6210\u591A\u4E2A\u6587\u4EF6\uFF0C\u5C31\u53EF\u4EE5\u7528\u7EC4\u5408 target \u544A\u8BC9 make \u8FD9\u4E9B\u6587\u4EF6\u76F4\u63A5\u7684\u5173\u8054\u5173\u7CFB\u3002</p><p>\u4E3A\u4E86\u6F14\u793A\u4E00\u4E0B\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo bar biz &amp;</span><span class="token punctuation">:</span> baz boz
    echo <span class="token variable">$^</span> &gt; foo
    echo <span class="token variable">$^</span> &gt; bar
    echo <span class="token variable">$^</span> &gt; biz
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u7EC4\u5408 target \u4E2D\uFF0C\u81EA\u52A8\u53D8\u91CF <code>$@</code> \u7684\u5C55\u5F00\u7ED3\u679C\u662F\u89E6\u53D1 recipe \u6267\u884C\u7684\u90A3\u4E2A target\uFF0C \u800C\u4E0D\u662F\u901A\u5E38\u671F\u671B\u7684\u6BCF\u6B21\u5C55\u5F00\u4E3A\u4E00\u4E2A target\u3002</p><p>\u7EC4\u5408 target \u5FC5\u987B\u5305\u542B recipe\u3002\u7EC4\u5408 target \u4E2D\u7684\u67D0\u4E2A target \u8FD8\u53EF\u4EE5\u540C\u65F6\u662F\u53E6\u4E00\u4E2A\u89C4\u5219 \u4E2D\u7684\u72EC\u7ACB target\uFF0C\u53EA\u8981\u53E6\u5916\u7684\u90A3\u4E2A\u89C4\u5219\u6CA1\u6709 recipe\u3002</p><p>\u7EC4\u5408 target \u4E2D\u7684 target \u53EA\u9700\u51FA\u73B0\u5728\u4E00\u4E2A\u7EC4\u5185\uFF0C\u53EA\u9700\u6709\u4E00\u4E2A recipe\u3002 \u5982\u679C\u4F5C\u4E3A\u7EC4\u5408 target \u7684 target \u540C\u65F6\u4F5C\u4E3A\u53E6\u4E00\u4E2A\u89C4\u5219\u7684\u7684\u72EC\u7ACB target \u6216\u8005\u53E6\u4E00\u4E2A\u5E26\u6709 recipe \u7684\u89C4\u5219\u7684\u7EC4\u5408 target \u7684\u6210\u5458\uFF0C\u5219\u4F1A\u7ED9\u51FA\u8B66\u544A\u6700\u7EC8\u540E\u9762\u7684 recipe \u751F\u6548\uFF0C\u53E6\u5916\uFF0C \u8FD8\u4F1A\u628A\u8FD9\u4E2A target \u4ECE\u524D\u4E00\u4E2A\u7EC4\u5408\u4E2D\u5220\u9664\uFF0C\u53EA\u4F5C\u4E3A\u540E\u9762\u7EC4\u5408 target \u7684\u6210\u5458\u3002</p><p>\u82E5\u8981\u8BA9\u4E00\u4E2A target \u540C\u65F6\u4F5C\u4E3A\u591A\u4E2A\u7EC4\u5408target \u7684\u6210\u5458\uFF0C\u8981\u7528 double colon grouped target \u8BED\u6CD5 <code>&amp;::</code>\u3002</p><h2 id="_4-11-\u4E00\u4E2A-target-\u591A\u4E2A\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_4-11-\u4E00\u4E2A-target-\u591A\u4E2A\u89C4\u5219" aria-hidden="true">#</a> 4.11 \u4E00\u4E2A target \u591A\u4E2A\u89C4\u5219</h2><p>\u591A\u6761\u89C4\u5219\u53EF\u4EE5\u6709\u5171\u540C\u7684 target\uFF0C\u5BF9\u4E8E\u8FD9\u4E2A target \u6765\u8BF4\uFF0C\u5B83\u7684 prerequisite \u662F\u6240\u6709\u8FD9\u4E9B\u89C4\u5219 \u7684 prerequisite \u62FC\u63A5\u5230\u4E00\u8D77\u7EC4\u5408\u800C\u6765\u3002</p>`,16),ss=a("\u4E00\u4E2A target \u53EA\u8BB8\u6709\u4E00\u4E2A recipe\uFF0C\u5982\u679C\u627E\u5230\u4E86\u591A\u4E2A\u89C4\u5219\u90FD\u6709 recipe\uFF0C\u5219\u53D6\u6700\u540E\u4E00\u4E2A recipe \u4F5C\u4E3A\u6700\u7EC8\u7684 recipe\uFF0C\u540C\u65F6\u4F1A\u7ED9\u51FA\u62A5\u9519\u4FE1\u606F\u3002\u4E00\u79CD\u4F8B\u5916\u60C5\u5F62\u662F target \u4EE5\u53E5\u70B9\u5F00\u5934\uFF0C\u4F46\u8FD9\u4E2D\u4E0D\u89C4\u8303 \u7684\u884C\u4E3A\u662F\u4E3A\u4E86\u517C\u5BB9\u522B\u7684\u7248\u672C\u7684 makefile\u3002\u5982\u679C\u786E\u5B9E\u5E0C\u671B\u7528\u591A\u4E2A\u89C4\u5219\u5171\u540C\u7ED9\u540C\u4E00\u4E2A target \u63D0\u4F9B \u5B8C\u6574\u7684recipe\uFF0C\u4F7F\u7528 "),ns={href:"https://www.gnu.org/software/make/manual/make.html#Double_002dColon",title:"4.13 Double-Colon Rules",target:"_blank",rel:"noopener noreferrer"},is=a("double colon rule"),ls=a("\u3002"),ts=t(`<p>\u8FD9\u79CD\u8BED\u6CD5\u7684\u4E00\u79CD\u573A\u666F\u5982\u4E0B\uFF0C\u4E5F\u5C31\u662F\u4E00\u6B21\u6027\u4E3A\u4E00\u7EC4\u6587\u4EF6\u6307\u5B9A\u5C11\u91CF\u7684\u516C\u5171\u4F9D\u8D56\u9879\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>objects <span class="token operator">:=</span> foo.o bar.o

<span class="token symbol"><span class="token variable">$</span>(objects)</span><span class="token punctuation">:</span> common.h
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u53E6\u4E00\u79CD\u5E38\u7528\u60C5\u666F\u5982\u4E0B\uFF0C\u53EF\u4EE5\u901A\u8FC7\u547D\u4EE4\u884C\u6307\u5B9A\u989D\u5916\u7684\u4F9D\u8D56\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>extral_deps<span class="token operator">:=</span>
<span class="token symbol">foo.o</span> <span class="token punctuation">:</span> <span class="token variable">$</span><span class="token punctuation">(</span>extral_deps<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8C03\u7528 make \u547D\u4EE4\u65F6\uFF0C<code>make extral_deps=bar.h</code>\uFF0C\u5219 foo.o \u4F1A\u6709\u989D\u5916\u4F9D\u8D56 bar.h\uFF0C\u800C \u5355\u7EAF\u6267\u884C <code>make</code> \u547D\u4EE4\u5219\u4E0D\u4F1A\u3002</p><p>\u5982\u679C\u6CA1\u6709\u663E\u5F0F\u89C4\u5219\u4E3A target \u63D0\u4F9B recipe\uFF0Cmake \u4F1A\u5C1D\u8BD5\u641C\u7D22\u9690\u5F0F\u89C4\u5219\u3002</p><h2 id="_4-12-\u9759\u6001\u6A21\u677F\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_4-12-\u9759\u6001\u6A21\u677F\u89C4\u5219" aria-hidden="true">#</a> 4.12 \u9759\u6001\u6A21\u677F\u89C4\u5219</h2><p>static pattern rules</p><p>\u9759\u6001\u6A21\u677F\u89C4\u5219\u662F\u8FD9\u6837\u7684\u89C4\u5219\uFF0C\u6307\u5B9A\u591A\u4E2A target\uFF0C\u57FA\u4E8E\u6BCF\u4E2A target \u5BF9\u5E94\u4E0D\u540C\u7684 prerequisite\u3002 \u5B83\u6BD4\u591A\u4E2A target \u7684\u666E\u901A\u89C4\u5219\u66F4\u901A\u7528\uFF0C\u56E0\u4E3A\u540E\u8005\u7684\u6240\u6709 target \u7684 prerequisite \u76F8\u540C\uFF0C \u800C\u9759\u6001\u6A21\u677F\u89C4\u5219\u7684 target \u5BF9\u5E94\u7684 prerequisite \u662F\u7C7B\u4F3C\u800C\u4E0D\u5B8C\u5168\u76F8\u540C\u3002</p><h3 id="_4-12-1-\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#_4-12-1-\u8BED\u6CD5" aria-hidden="true">#</a> 4.12.1 \u8BED\u6CD5</h3><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">targets ...</span> <span class="token punctuation">:</span> target-pattern <span class="token punctuation">:</span> prereq-patterns ...
    recipe...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u793A\u4F8B</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>objects<span class="token operator">:=</span>foo.o bar.o baz.o

<span class="token symbol"><span class="token variable">$</span>(objects)</span><span class="token punctuation">:</span> %.o<span class="token punctuation">:</span> %.c
      <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$&lt;</span> -o <span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>targets \u5217\u51FA\u6240\u6709 target\uFF0C\u4E0E\u666E\u901A\u89C4\u5219\u65E0\u5F02\u3002target-pattern \u6307\u5B9A\u4E86\u5982\u4F55\u4ECE target \u4E2D\u63D0\u53D6 \u5176\u4E2D\u7684\u6A21\u5F0F\u5339\u914D\u7684\u90E8\u5206\uFF0C\u8FD9\u4E00\u90E8\u5206\u53EB\u505A stem\uFF0C\u901A\u5E38\uFF0Ctarget-pattern \u4E2D\u6709\u4E14\u4EC5\u6709\u4E00\u4E2A % \u505A\u901A \u914D\u7B26\uFF0C\u5B83\u53EF\u4EE5\u5339\u914D\u4EFB\u610F\u957F\u5EA6\u7684\u5B57\u7B26\u4E32\uFF0Cpattern \u7684\u5269\u4F59\u90E8\u5206\u8981\u6C42\u548C target \u7684\u5269\u4F59\u90E8\u5206\u7CBE\u786E\u5339\u914D\u3002 prereq-pattern \u6307\u51FA\u5982\u4F55\u5229\u7528 stem \u6784\u9020\u5BF9\u5E94\u7684prerequisite\u3002prereq-pattern \u4E5F\u5305\u542B\u901A\u914D \u7B26 %\uFF0C\u628A % \u66FF\u6362\u4E3A stem \u5F97\u5230\u6700\u7EC8\u7684 prerequisite\u3002</p><p>prereq-pattern \u53EF\u4EE5\u4E0D\u5305\u542B\u901A\u914D\u7B26\uFF0C\u6B64\u65F6\u6240\u6709\u7684 target \u4F7F\u7528\u8FD9\u540C\u4E00\u4E2A prerequisite\u3002</p><p>\u8FD9\u4E24\u4E2A pattern \u4E2D\u7684\u901A\u914D\u7B26 % \u53EF\u4EE5\u7528\u53CD\u659C\u6760\u8F6C\u4E49 <code>\\%</code>\uFF0C\u4F7F\u5176\u5931\u53BB\u901A\u914D\u6548\u679C\uFF0C\u8FDB\u4E00\u6B65\uFF0C\u53CD\u659C\u6760\u53EF\u4EE5\u628A \u53CD\u659C\u6760\u8F6C\u4E49\uFF0C\u4F7F\u5176\u4E0D\u81F3\u4E8E\u5C06 % \u7684\u901A\u914D\u6548\u679C\u53D6\u6D88 <code>\\\\%</code>\u3002</p><p>\u5982\u679C\u67D0\u4E2A target \u4E0D\u80FD\u5339\u914D target-pattern\uFF0C\u4F1A\u7ED9\u51FA\u8B66\u544A\u4FE1\u606F\u3002\u7528 filter \u51FD\u6570\uFF0C\u53EF\u4EE5\u628A\u4E0D\u5339\u914D\u7684 target \u8FC7\u6EE4\u6389\u3002\u6BD4\u5982</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>files<span class="token operator">:=</span>foo.o bar.o biz.elc

<span class="token symbol"><span class="token variable">$</span>(filter %.o, <span class="token variable">$</span>(files))</span><span class="token punctuation">:</span> %.o<span class="token punctuation">:</span> %.c
        <span class="token variable">$</span><span class="token punctuation">(</span>CC<span class="token punctuation">)</span> -c <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> <span class="token variable">$&lt;</span> -o <span class="token variable">$@</span>
<span class="token symbol"><span class="token variable">$</span>(filter %.elc, <span class="token variable">$</span>(files))</span><span class="token punctuation">:</span>%.elc<span class="token punctuation">:</span> %.el
        emacs -f batch-byte-compile <span class="token variable">$&lt;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u5982\u679C\u4E00\u4E2A target \u540C\u65F6\u5339\u914D\u591A\u6761\u9759\u6001\u6A21\u677F\u89C4\u5219\uFF0C\u4F1A\u62A5\u9519\u3002</p><h3 id="_4-12-2-\u4E0E\u9690\u5F0F\u89C4\u5219\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#_4-12-2-\u4E0E\u9690\u5F0F\u89C4\u5219\u5BF9\u6BD4" aria-hidden="true">#</a> 4.12.2 \u4E0E\u9690\u5F0F\u89C4\u5219\u5BF9\u6BD4</h3><p>\u9690\u5F0F\u89C4\u5219\u751F\u6548\u7684\u6761\u4EF6\uFF1A\u5F53\u4E14\u4EC5\u5F53\u6CA1\u6709\u5176\u5B83\u89C4\u5219\u80FD\u4E3A\u67D0\u4E2A target \u63D0\u4F9B\u5BF9\u5E94\u7684 recipe\uFF0C\u4E14\u5B58\u5728\u5BF9\u5E94\u7684 prerequisite\u3002 \u5982\u679C\u591A\u4E2A\u9690\u5F0F\u89C4\u5219\u540C\u65F6\u5339\u914D\u4E0A\uFF0C\u5C31\u770B\u5B83\u4EEC\u7684\u5148\u540E\u987A\u5E8F\uFF0C\u5728\u524D\u9762\u7684\u89C4\u5219\u5148\u751F\u6548\u3002</p><p>\u9759\u6001\u6A21\u677F\u89C4\u5219\u5219\u4E0D\u7136\uFF0C\u5B83\u53EF\u4EE5\u770B\u4F5C\u662F\u663E\u5F0F\u89C4\u5219\u7684\u7B80\u5199\u5F62\u5F0F\u3002\u53EA\u5339\u914D\u660E\u786E\u5217\u51FA\u7684 target\u3002</p><p>\u9759\u6001\u6A21\u677F\u89C4\u5219\u6BD4\u9690\u5F0F\u89C4\u5219\u66F4\u9760\u8C31\u3002\u6BD4\u5982\uFF0C\u5982\u679C\u65E0\u6CD5\u786E\u5B9A Makefile \u6240\u5728\u7684\u76EE\u5F55\u4F1A\u6709\u54EA\u4E9B\u65E0\u5173\u7684\u6587\u4EF6\uFF0C \u5C31\u6709\u53EF\u80FD\u5B58\u5728\u67D0\u4E9B\u6587\u4EF6\uFF0C\u4F7F\u5F97\u610F\u6599\u4E4B\u5916\u7684\u67D0\u4E2A\u9690\u5F0F\u89C4\u5219\u751F\u6548\u4E86\u3002</p><h2 id="_4-13-\u53CC\u5192\u53F7\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_4-13-\u53CC\u5192\u53F7\u89C4\u5219" aria-hidden="true">#</a> 4.13 \u53CC\u5192\u53F7\u89C4\u5219</h2><p>double-colon rules</p><p>\u53CC\u5192\u53F7\u89C4\u5219\u7684 target \u5217\u8868\u540E\u7528 <code>::</code> \u505A\u5206\u9694\u7B26\uFF0C\u53CC\u5192\u53F7\u662F\u663E\u5F0F\u89C4\u5219\u7684\u4E00\u79CD\u3002 \u666E\u901A\u7684\u663E\u5F0F\u89C4\u5219\u7684 target \u7528<code>:</code>\u5206\u9694\u3002</p><p>\u5F53\u4E00\u4E2A target \u51FA\u73B0\u5728\u591A\u4E2A rule \u4E2D\u65F6\uFF0C\u53CC\u5192\u53F7\u89C4\u5219\u548C\u666E\u901A\u89C4\u5219\u7684\u5904\u7406\u903B\u8F91\u76F8\u5DEE\u5F88\u5927\u3002</p><p>\u4E00\u4E2A target \u7684\u6240\u6709\u663E\u5F0F\u89C4\u5219\u7684\u7C7B\u578B\u5FC5\u987B\u76F8\u540C\uFF1A\u8981\u4E48\u90FD\u662F\u666E\u901A\u89C4\u5219\uFF0C\u8981\u4E48\u90FD\u662F\u53CC\u5192\u53F7\u89C4\u5219\u3002</p><p>\u540C\u4E00\u4E2A target \u7684\u591A\u6761\u53CC\u5192\u53F7\u89C4\u5219\u4E4B\u95F4\u4E92\u76F8\u72EC\u7ACB\uFF0C\u90A3\u4E2A\u89C4\u5219\u7684 prerequisite \u53D1\u751F\u4E86\u53D8\u5316\u5C31\u6267\u884C \u8FD9\u4E2A\u89C4\u5219\u5BF9\u5E94\u7684 recipe\u3002\u5982\u679C\u67D0\u4E2A\u53CC\u5192\u53F7\u89C4\u5219\u6CA1\u6709 prerequisite\uFF0C\u90A3\u8FD9\u4E2A\u89C4\u5219\u603B\u662F\u4F1A\u6267\u884C\uFF0C\u5373\u4F7F \u5BF9\u5E94\u7684 target \u5DF2\u7ECF\u5B58\u5728\u4E5F\u6267\u884C\u3002\u6240\u4EE5\u540C\u4E00\u4E2A target \u7684\u53CC\u5192\u53F7\u89C4\u5219\u53EF\u80FD\u6267\u884C 0 \u6761\u3001\u82E5\u5E72\u6761\u3001\u5168\u90E8\u6267\u884C\u3002</p><p>\u82E5\u540C\u4E00\u4E2A target \u7684\u6709\u591A\u4E2A\u53CC\u5192\u53F7\u9700\u8981\u66F4\u65B0\uFF0C\u6309\u5148\u540E\u987A\u5E8F\u4F9D\u6B21\u6267\u884C\u3002\u4F46\u662F\uFF0C\u53CC\u5192\u53F7\u89C4\u5219\u9002\u7528\u7684\u573A\u666F \u4E2D\uFF0C\u4E0D\u5E94\u5F53\u4F9D\u8D56\u89C4\u5219\u7684\u6267\u884C\u987A\u5E8F\u3002</p><p>\u53CC\u5192\u53F7\u89C4\u5219\u7684\u884C\u4E3A\u4E0D\u5927\u5408\u7406\uFF0C\u5E94\u7528\u573A\u666F\u4E5F\u5F88\u5C11\uFF0C\u4E00\u79CD\u9002\u7528\u4F46\u5F88\u7A00\u5C11\u7684\u573A\u666F\u662F\uFF0C\u4E00\u4E2A\u76EE\u6807\uFF0C\u4E0D\u540C\u7684\u4F9D\u8D56 \u53D1\u751F\u53D8\u5316\uFF0C\u8981\u4F7F\u7528\u4E0D\u540C\u7684\u547D\u4EE4\u66F4\u65B0\u3002</p><p>\u5982\u679C\u67D0\u4E2A\u53CC\u5192\u53F7\u89C4\u5219\u6CA1\u6709 recipe\uFF0C\u4F1A\u5C1D\u8BD5\u7528\u9690\u5F0F\u89C4\u5219\u53BB\u5339\u914D\u3002</p><h2 id="_4-14-\u81EA\u52A8\u751F\u6210\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#_4-14-\u81EA\u52A8\u751F\u6210\u4F9D\u8D56" aria-hidden="true">#</a> 4.14 \u81EA\u52A8\u751F\u6210\u4F9D\u8D56</h2><p>Generating Prerequisites Automatically</p><p>\u8BF4\u7684\u662F\uFF0Cc \u8BED\u8A00\u5934\u6587\u4EF6\u4F9D\u8D56\u5173\u7CFB\uFF0C\u53EF\u4EE5\u501F\u52A9\u7F16\u8BD1\u5668\u7684 -M \u7ED3\u5408 GNU make \u7684 remake \u673A\u5236\u81EA\u52A8\u751F\u6210\u3002\u5982\u679C\u662F GNU \u7684 C \u7F16\u8BD1\u5668\uFF0C\u8FD8\u53EF\u4EE5\u7528 -MM \u66FF\u6362 -M\u3002</p><p>\u5728\u6CA1\u6709 remake \u673A\u5236\u7684 make \u5DE5\u5177\u4E0B\uFF0C\u5E38\u89C1\u7684\u5B9E\u8DF5\u65B9\u5F0F\u662F\u5148 make depend\uFF0C\u628A\u6240\u6709\u7684\u5934\u6587\u4EF6\u4F9D\u8D56 \u751F\u6210\u5230\u540D\u4E3A depend \u7684\u6587\u4EF6\u4E2D\uFF0C\u7136\u540E\u5728 Makefile \u4E2D\u6709\u4E00\u6761 -include depend \u6307\u4EE4\u3002</p><h1 id="_5-\u89C4\u5219\u4E2D\u7684-recipe" tabindex="-1"><a class="header-anchor" href="#_5-\u89C4\u5219\u4E2D\u7684-recipe" aria-hidden="true">#</a> 5 \u89C4\u5219\u4E2D\u7684 recipe</h1><p>Writing Recipes in Rules</p><h2 id="_5-1-\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#_5-1-\u8BED\u6CD5" aria-hidden="true">#</a> 5.1 \u8BED\u6CD5</h2><p>Recipe Syntax</p><p>make \u6587\u4EF6\u672C\u8EAB\u662F\u4E00\u79CD\u8BED\u6CD5\uFF0C\u800C recipe \u5219\u662F shell \u811A\u672C\u7684\u8BED\u6CD5\uFF0C\u4E00\u4E2A\u6587\u4EF6\u6709\u4E24\u79CD\u622A\u7136\u4E0D\u540C\u7684\u8BED\u6CD5\uFF0C \u8FD9\u662F Makefile \u7684\u4E00\u4E2A\u4E0D\u540C\u5BFB\u5E38\u7684\u5730\u65B9\u3002make \u672C\u8EAB\u5E76\u4E0D\u7406\u89E3 shell \u811A\u672C\uFF0C\u4EC5\u5728\u628A\u5185\u5BB9\u4F20\u9012\u7ED9 shell \u4E4B\u524D\u505A\u5C11\u91CF\u7684\u5904\u7406\u3002</p><p>PS\uFF1Ashell \u811A\u672C\u8FD8\u80FD\u5185\u5D4C\u522B\u7684\u8BED\u8A00\u7247\u6BB5\u5462\u3002</p><p>recipe \u4E2D\u7684\u6BCF\u4E00\u884C\u5FC5\u987B\u4EE5 tab \u5B57\u7B26\u5F00\u5934\uFF08\u6216\u8005\u7279\u6B8A\u53D8\u91CF .RECIPEPREFIX \u6307\u5B9A\u7684\u7B2C\u4E00\u4E2A\u5B57\u7B26\uFF09\uFF0C \u552F\u4E00\u7684\u4F8B\u5916\u662Frecipe\u7684\u7B2C\u4E00\u884C\uFF0C\u5B83\u53EF\u4EE5\u51FA\u73B0\u5728 target-and-prerequisite \u7684\u672B\u5C3E\uFF0C\u7528\u5206\u53F7\u5206\u9694\u3002 \u4EFB\u4F55\u5728\u89C4\u5219\u4E0A\u4E0B\u6587\u4E2D\u4E14\u4EE5 tab \u5B57\u7B26\u5F00\u5934\u7684\u884C\u90FD\u662F recipe line\uFF0Crecipe line \u4E4B\u95F4\u53EF\u4EE5\u6709 \u7A7A\u767D\u884C\u548C\u6CE8\u91CA\u884C\uFF0C\u5B83\u4EEC\u88AB\u76F4\u63A5\u5FFD\u7565\u3002\u89C4\u5219\u4E0A\u4E0B\u6587\u662F\u6307 target-and-prerequisite \u4E4B\u540E\uFF0C\u4E0B\u4E00\u4E2A \u89C4\u5219\u5B9A\u4E49\u6216\u8005\u53D8\u91CF\u8D4B\u503C\u4E4B\u524D\uFF0C\u8FD9\u4E4B\u95F4\u7684\u533A\u57DF\u3002</p><p>\u6709\u5982\u4E0B\u7ED3\u8BBA</p><ul><li>tab \u5B57\u7B26\u5F00\u5934\u7684\u7A7A\u884C\u4E0D\u662F\u7A7A\u767D\uFF0C\u800C\u662F empty recipe</li><li>recipe \u4E2D\u7684\u6CE8\u91CA\u4E0D\u662Fmakefile\u4E2D\u7684\u6CE8\u91CA\uFF0C\u5B83\u4F1A\u88AB\u539F\u6837\u4F20\u9012\u7ED9 shell</li><li>rule context \u4E0B\uFF0C\u4EE5 tab \u5B57\u7B26\u5F00\u5934\u7684\u53D8\u91CF\u5B9A\u4E49\u4F1A\u88AB\u4F20\u9012\u7ED9shell\uFF0C\u800C\u975Emakefile\u4E2D\u7684\u53D8\u91CF\u5B9A\u4E49</li><li>rule context\u4E0B\uFF0C\u4EE5tab\u5B57\u7B26\u5F00\u5934\u7684\u6761\u4EF6\u8BED\u53E5\uFF0C\u4F1A\u88AB\u4F20\u9012\u7ED9shell\uFF0C\u800C\u975Emakefile\u7684\u6761\u4EF6\u8BED\u53E5</li></ul><h3 id="_5-1-1-recipe-\u4E2D\u7684\u7EED\u884C" tabindex="-1"><a class="header-anchor" href="#_5-1-1-recipe-\u4E2D\u7684\u7EED\u884C" aria-hidden="true">#</a> 5.1.1 recipe \u4E2D\u7684\u7EED\u884C</h3><p>Splitting Recipe Lines</p><p>makefile \u5BF9 recipe \u6267\u884C\u7684\u4E3A\u6570\u4E0D\u591A\u7684\u5904\u7406\u8FC7\u7A0B\uFF0C\u5176\u4E2D\u4E00\u4E2A\u5C31\u662F\u7EED\u884C\u3002</p><p>makefile \u4E2D\uFF0Crecipe \u90E8\u5206\u7684\u7EED\u884C\uFF0C\u5176\u542B\u4E49\u4ECD\u7136\u662F\u591A\u4E2A\u7269\u7406\u884C\u5408\u5E76\u4E3A\u4E00\u4E2A\u903B\u8F91\u884C\uFF0C\u4E0D\u540C\u7684\u662F</p><ul><li>\u4E0D\u4F1A\u628A\u659C\u6760+\u6362\u884C\u66FF\u6362\u4E3A\u7A7A\u767D\uFF0C\u800C\u662F\u4FDD\u7559\u5E76\u4F20\u9012\u7ED9 shell</li><li>\u5982\u679C \u659C\u6760+\u6362\u884C \u7684\u4E0B\u4E00\u884C\u7684\u5F00\u5934\u662F RECIPEPREFIX \u5B57\u7B26\uFF0Cmake \u4F1A\u628A\u8FD9\u4E2A\u5B57\u7B26\u5220\u9664\uFF08\u4E14\u4EC5\u5220\u9664\u8FD9\u4E00\u4E2A\u5B57\u7B26\uFF09</li></ul><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">all</span> <span class="token punctuation">:</span>
        <span class="token operator">@</span>echo no\\
space
        <span class="token operator">@</span>echo no\\
        space
        <span class="token operator">@</span>echo one \\
        space
        <span class="token operator">@</span>echo one\\
         space
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u5BF9\u5E94\u7684\u8F93\u51FA\u5982\u4E0B</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>nospace
nospace
one space
one space
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>PS\uFF1A\u8FD9\u4E2A\u793A\u4F8B\u8FD8\u8868\u660E\uFF0Crecipe \u4E2D\u7684\u7EED\u884C\u7B26\u7684\u4E0B\u4E00\u884C\u4E0D\u5FC5\u987B\u4EE5 RECIPEPREFIX \u5B57\u7B26\u5F00\u5934\u3002 PPS\uFF1A\u7EED\u884C\u7B26\uFF0C\u6307 \u659C\u6760+\u6362\u884C</p><p>PS\uFF1A\u7531\u6B64\uFF0C\u8981\u4F7F\u7528\u7EED\u884C\u4F7F\u5F97make\u5728\u4E00\u4E2Ashell\u4E2D\u4E00\u4E2Arecipe\u5185\u7684\u6267\u884C\u591A\u4E2A\u547D\u4EE4\uFF0C\u5C31\u8981\u5728\u6BCF\u4E2A\u547D\u4EE4\u540E\u52A0\u4E0A\u5206\u53F7\uFF0C\u7ED9shell\u770B\u3002</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>var-kept:
    export foo=bar; \\
    echo &quot;foo=[$$foo]&quot;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5982\u679C\u5E0C\u671B\u8BA9 make \u628A\u7EED\u884C\u7B26\u66FF\u6362\u6210\u7A7A\u683C\uFF0C\u4E00\u79CD\u65B9\u5F0F\u662F\u7528makefile\u7684\u53D8\u91CF\u505A\u4E00\u6B21\u4E2D\u8F6C</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>HELLO <span class="token operator">=</span> <span class="token string">&#39;hello \\
world&#39;</span>

<span class="token symbol">all</span> <span class="token punctuation">:</span> <span class="token punctuation">;</span> <span class="token operator">@</span>echo <span class="token variable">$</span><span class="token punctuation">(</span>HELLO<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>shell \u63A5\u6536\u5230\u7684\u547D\u4EE4\u5C31\u4F1A\u53D8\u6210 <code>echo hello world</code>\u3002</p><h3 id="_5-1-2-\u5728-recipe-\u4E2D\u4F7F\u7528\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_5-1-2-\u5728-recipe-\u4E2D\u4F7F\u7528\u53D8\u91CF" aria-hidden="true">#</a> 5.1.2 \u5728 recipe \u4E2D\u4F7F\u7528\u53D8\u91CF</h3><p>makefile \u5BF9 recipe \u8FDB\u884C\u7684\u53E6\u4E00\u4E2A\u5904\u7406\u662F\u53D8\u91CF\u66FF\u6362\u3002\u53D8\u91CF\u66FF\u6362\uFF0C\u5728\u8BFB\u53D6\u5B8C\u6240\u6709\u7684 makefile \u5E76 \u786E\u5B9A\u4E86 target \u4E3A out of date \u540E\u624D\u8FDB\u884C\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u4E0D\u9700\u8981\u66F4\u65B0\u7684 target\uFF0C\u5176\u5BF9\u5E94\u7684 recipe \u4E0D\u4F1A\u53D1\u751F\u53D8\u91CF\u6269\u5C55\u3002</p><p>\u9996\u5148\uFF0Crecipe \u4E2D\u7684\u53D8\u91CF\u5F15\u7528\u548C\u51FD\u6570\u5F15\u7528\u8BED\u6CD5\u4E0E\u5176\u5B83\u5730\u65B9\u76F8\u540C\uFF0C\u90FD\u662F $(xxx ) \u7684\u5F62\u5F0F\u3002\u5176\u6B21\uFF0C \u5927\u591A\u6570shell\uFF08\u5305\u62EC\u9ED8\u8BA4/bin/sh\uFF09\uFF0C\u4E5F\u4F7F\u7528 $ \u4F5C\u4E3A\u53D8\u91CF\u5F15\u7528\u6807\u5FD7\uFF0C\u6240\u4EE5\uFF0C\u8981\u8BA9 $ \u51FA\u73B0\u5728 shell \u4E2D\uFF0C\u5C31\u5F97\u7528\u4E24\u4E2A $$\uFF0C\u548C\u5176\u5B83\u5730\u65B9\u4E00\u6837\u3002\u7F16\u5199 makefile \u7684\u65F6\u5019\u4E00\u5B9A\u8981\u641E\u6E05\u695A\u8981\u5F15\u7528\u7684\u662F makefile \u4E2D\u7684\u53D8\u91CF\u8FD8\u662F shell \u53D8\u91CF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>LIST <span class="token operator">=</span> one two three
<span class="token symbol">all</span><span class="token punctuation">:</span>
        for i in <span class="token variable">$</span><span class="token punctuation">(</span>LIST<span class="token punctuation">)</span><span class="token punctuation">;</span> do \\
            echo <span class="token variable">$$i;</span> \\
        done
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_5-2-recipe-\u7684\u56DE\u663E" tabindex="-1"><a class="header-anchor" href="#_5-2-recipe-\u7684\u56DE\u663E" aria-hidden="true">#</a> 5.2 recipe \u7684\u56DE\u663E</h2><p>\u9ED8\u8BA4\uFF0Cmake \u4F1A\u8F93\u51FA\u6267\u884C\u7684\u6BCF\u4E00\u884C recipe\u3002\u5982\u679C\u67D0\u884C\u4EE5 @ \u5F00\u5934\uFF0C\u8FD9\u4E00\u884C\u5C31\u4E0D\u4F1A\u56DE\u663E\u3002\u901A\u5E38\uFF0C@\u5B57\u7B26 \u7528\u4E8E\u5173\u95ED\u5355\u7EAF\u8F93\u51FA\u4FE1\u606F\u7684\u547D\u4EE4</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo</span><span class="token punctuation">:</span>
      <span class="token operator">@</span>echo hello
      <span class="token comment"># do something</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>-n --just-print \u9009\u9879\uFF0C\u7528\u4E8E\u8F93\u51FA\u8981\u6267\u884C\u7684\u547D\u4EE4\u800C\u4E0D\u771F\u6B63\u6267\u884C\uFF0C\u8FD9\u4E2A\u9009\u9879\u5728debug\u7684\u65F6\u5019\u5F88\u6709\u5E2E\u52A9\u3002 \u8FD9\u4E2A\u9009\u9879\u8F93\u51FA\u7684\u65F6\u5019\uFF0C\u4EE5@\u5F00\u5934\u7684recipe line \u540C\u6837\u4F1A\u88AB\u8F93\u51FA\u3002</p><p>\u9009\u9879 -s --silent \u7528\u4E8E\u5173\u95ED\u6240\u6709\u56DE\u663E\uFF0C\u5C31\u597D\u50CF\u6BCF\u4E2A recipe line \u90FD\u4EE5 @ \u5B57\u7B26\u5F00\u5934\u4F3C\u7684\u3002 \u7279\u6B8A <code>.SILENT:</code>\uFF0C\u5F53\u5B83\u7684 prerequisite \u4E3A\u7A7A\u65F6\uFF0C\u6548\u679C\u7B49\u4EF7\u4E8E -s\u3002</p><p>Q. @ \u548C\u7EED\u884C\uFF1F Ans\uFF1A@ \u5BF9\u903B\u8F91\u884C\u5173\u95ED\u56DE\u663E\uFF0C\u6240\u4EE5\uFF0C\u7EED\u884C\u7B26\u540E\u9762\u7684\u4E00\u6837\u4E0D\u4F1A\u56DE\u663E\u3002</p><h2 id="_5-3-\u6267\u884C-recipe" tabindex="-1"><a class="header-anchor" href="#_5-3-\u6267\u884C-recipe" aria-hidden="true">#</a> 5.3 \u6267\u884C recipe</h2><p>\u5F53\u9700\u8981\u6267\u884C\u89C4\u5219\u7684 recipe \u4EE5\u66F4\u65B0 target \u65F6\uFF0Crecipe \u4E2D\u7684\u6BCF\u4E00\u884C\uFF0Cmake \u90FD\u7528\u4E00\u4E2A\u65B0\u7684 \u5B50shell\u8FDB\u7A0B\u6267\u884C\uFF0C\u9664\u975E\u8BBE\u7F6E\u4E86 <code>.ONESHELL:</code> \u8FD9\u4E2A\u7279\u6B8A target\u3002</p><p>\u4E00\u4E2A\u76F4\u767D\u7684\u63A8\u8BBA\u662F\uFF0C\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF\u3001\u6267\u884C cd \u547D\u4EE4\u5207\u6362\u76EE\u5F55\u7B49\u7279\u5B9A\u4E8Eshell\u8FDB\u7A0B\u7684\u64CD\u4F5C\uFF0C\u5BF9\u540E\u7EED\u7684 recipe \u884C\u4E0D\u751F\u6548\u3002\u5982\u679C\u8981 cd \u547D\u4EE4\u5BF9\u4E0B\u4E00\u6761shell\u8BED\u53E5\u751F\u6548\uFF0C\u628A\u4ED6\u4EEC\u5408\u5E76\u5230\u4E00\u884C\uFF0C\u5982\u4E0B\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo</span> <span class="token punctuation">:</span> bar/lose
        cd <span class="token variable">$(&lt;D)</span> &amp;&amp; gobble <span class="token variable">$(&lt;F)</span> &gt; ../<span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_5-3-1-\u4F7F\u7528\u4E00\u4E2A-shell" tabindex="-1"><a class="header-anchor" href="#_5-3-1-\u4F7F\u7528\u4E00\u4E2A-shell" aria-hidden="true">#</a> 5.3.1 \u4F7F\u7528\u4E00\u4E2A shell</h3><p>\u6709\u65F6\u5019\uFF0C\u786E\u5B9E\u9700\u8981\u7528\u5355\u4E2Ashell\u6267\u884C\u5355\u4E2A recipe \u4E2D\u7684\u6240\u6709\u884C\u3002\u597D\u5904\u6709\u4E24\u70B9\uFF0C\u4E00\u662F\u63D0\u5347\u6027\u80FD\uFF0C\u56E0\u4E3A \u521B\u5EFA\u7684\u5B50\u8FDB\u7A0B\u5C11\u4E86\uFF0C\u4E8C\u662F\u4FDD\u7559 recipe \u7684\u6362\u884C\u7B26\u3002</p><p>\u5982\u679C makefile \u7684\u4EFB\u4F55\u4F4D\u7F6E\u8BBE\u7F6E\u4E86\u7279\u6B8A target <code>.ONESHELL:</code>\uFF0C\u6BCF\u4E2A target \u7684 recipe \u7684\u6240\u6709 \u884C\u90FD\u4F1A\u5728\u4E00\u4E2A\u5B50 shell \u4E2D\u6267\u884C\uFF0C\u540C\u65F6\uFF0Crecipe \u5185\u7684\u6362\u884C\u7B26\u4FDD\u7559\u3002</p><p>\u4F8B\u5982\uFF0C\u4E0B\u9762\u7684\u4EE3\u7801\u6BB5\u884C\u4E3A\u53EF\u4EE5\u7B26\u5408\u9884\u671F\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.ONESHELL</span><span class="token punctuation">:</span>
<span class="token symbol">foo</span> <span class="token punctuation">:</span> bar/lose
        cd <span class="token variable">$(@D)</span>
        gobble <span class="token variable">$(@F)</span> &gt; ../<span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5F53\u8BBE\u7F6E\u4E86 <code>.ONESHELL:</code>\uFF0C\u4F1A\u68C0\u67E5 recipe \u7684\u7B2C\u4E00\u884C\uFF08\u4E14\u4EC5\u68C0\u67E5\u7B2C\u4E00\u884C\uFF09\uFF0C\u5E76\u5728\u628Arecipe\u4F20\u9012\u7ED9 SHELL \u4E4B\u524D\u79FB\u9664\u7B2C\u4E00\u884C\u5F00\u5934\u7684\u7279\u6B8A\u5B57\u7B26\uFF08@\u3001+\u3001-\uFF09\u3002 \u5982\u4E0B\uFF0C\u8FD9\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u610F\u56FE\u7528\u7ED9 perl \u4F20\u5165\u4E00\u4E2A\u4E24\u884C\u6784\u6210\u7684\u7A0B\u5E8F\uFF0C\u4F46\u56E0\u4E3A\u4F7F\u7528\u4E86 <code>.ONESHELL:</code>\uFF0C \u7B2C\u4E00\u884C\u7684\u53D8\u91CF\u5B9A\u4E49 @f \u7684 @ \u4F1A\u88AB\u79FB\u9664\uFF0C\u8FD9\u662F\u8BED\u6CD5\u9519\u8BEF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.ONESHELL</span><span class="token punctuation">:</span>
SHELL <span class="token operator">=</span> /usr/bin/perl
.SHELLFLAGS <span class="token operator">=</span> -e
<span class="token symbol">show</span> <span class="token punctuation">:</span>
        <span class="token operator">@</span>f <span class="token operator">=</span> qw<span class="token punctuation">(</span>a b c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        print <span class="token string">&quot;@f\\n&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u53EF\u4EE5\u5728 recipe \u7684\u5730\u4E00\u6837\u63D2\u5165\u4E00\u884C\u6CE8\u91CA\uFF08\u6216\u7C7B\u4F3C\u7684\u65B9\u5F0F\uFF09\u907F\u5F00\u8FD9\u4E00\u95EE\u9898</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.ONESHELL</span><span class="token punctuation">:</span>
SHELL <span class="token operator">=</span> /usr/bin/perl
.SHELLFLAGS <span class="token operator">=</span> -e
<span class="token symbol">show</span> <span class="token punctuation">:</span>
        <span class="token comment"># Make sure &quot;@&quot; is not the first character on the first line</span>
        <span class="token operator">@</span>f <span class="token operator">=</span> qw<span class="token punctuation">(</span>a b c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        print <span class="token string">&quot;@f\\n&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u6216\u8005</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.ONESHELL</span><span class="token punctuation">:</span>
SHELL <span class="token operator">=</span> /usr/bin/perl
.SHELLFLAGS <span class="token operator">=</span> -e
<span class="token symbol">show</span> <span class="token punctuation">:</span>
        my <span class="token operator">@</span>f <span class="token operator">=</span> qw<span class="token punctuation">(</span>a b c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        print <span class="token string">&quot;@f\\n&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u4F5C\u4E3A\u4E00\u4E2A\u7279\u4F8B\uFF0C\u82E5 SHELL \u662F POSIX \u98CE\u683C\u7684 shell\uFF0C\u5219\u6240\u6709\u7684 recipe \u884C\u5F00\u5934\u7684\u7279\u6B8A\u5B57\u7B26\u90FD\u4F1A\u79FB\u9664\u3002 \u8FD9\u662F\u4E3A\u4E86\u8BA9\u5DF2\u6709\u7684 makefile \u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528 .ONESHELL \u7279\u6027\uFF0C\u800C\u4E0D\u7834\u574F\u5176\u529F\u80FD\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin">.ONESHELL</span><span class="token punctuation">:</span>
<span class="token symbol">foo</span> <span class="token punctuation">:</span> bar/lose
        <span class="token operator">@</span>cd <span class="token variable">$(@D)</span>
        <span class="token operator">@</span>gobble <span class="token variable">$(@F)</span> &gt; ../<span class="token variable">$@</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u5373\u4F7F\u5982\u6B64\uFF0C\u8FD8\u4F1A\u6709\u5176\u5B83\u95EE\u9898\uFF0C\u4F8B\u5982\uFF0C\u67D0\u4E2A\u4E2D\u95F4\u7684\u547D\u4EE4\u5931\u8D25\uFF0Cmake \u65E0\u6CD5\u6355\u83B7\u5931\u8D25\u4FE1\u606F\uFF0C\u5BF9\u5E94\u7684\u89E3\u51B3 \u65B9\u6848\u662F\u8BBE\u7F6E <code>.SHELLFLAGS=-e</code>\uFF0C\u8FD9\u6837\uFF0Cshell\u4F1A\u5728\u9047\u5230\u5931\u8D25\u547D\u4EE4\u540E\u7ACB\u5373\u9000\u51FA\uFF0C\u4F46\u8FD9\u672C\u8EAB\u4F1A\u6539\u53D8 recipe \u7684\u884C\u4E3A\u3002\u603B\u800C\u8A00\u4E4B\uFF0C\u4F7F\u7528 .ONEHSELL\uFF0C\u5C31\u5FC5\u987B\u8981\u5728 recipe \u4E2D\u505A\u51FA\u5BF9\u5E94\u7684\u53D8\u5316\u3002</p><h3 id="_5-3-2-\u9009\u62E9-shell" tabindex="-1"><a class="header-anchor" href="#_5-3-2-\u9009\u62E9-shell" aria-hidden="true">#</a> 5.3.2 \u9009\u62E9 shell</h3><p>\u53D8\u91CF SHELL \u6307\u5B9A\u4E86 make \u6267\u884C recipe \u6240\u7528\u7684 shell\uFF0C\u5982\u679C\u6CA1\u6709\u5728makefile\u4E2D\u8BBE\u7F6E\u6B64\u53D8\u91CF\uFF0C make \u4F7F\u7528 /bin/sh \u6267\u884C recipe\u3002\u53D8\u91CF .SHELLFLAGS \u6307\u5B9A\u4F20\u9012\u7ED9 shell \u7684\u9009\u9879\uFF0C\u5176\u9ED8\u8BA4\u503C\u662F -c\uFF0CPOSIX \u6A21\u5F0F\u4E0B\u662F -ec\u3002</p><p>PS\uFF1A\u6216\u8005\u8BF4\uFF0Cmake \u53D8\u91CF SHELL \u7684\u9ED8\u8BA4\u503C\u662F /bin/sh\u3002\u89C1\u540E\u6587demo\u3002</p><p>\u4E0D\u540C\u4E8E\u5176\u4ED6\u53D8\u91CF\uFF0CSHELL \u53D8\u91CF\u4E0D\u4F1A\u7EE7\u627F\u73AF\u5883\u53D8\u91CF\u4E2D\u7684 SHELL\u3002\u8FD9\u662F\u56E0\u4E3A Linux shell \u57FA\u672C\u90FD\u4F1A\u8BBE\u7F6E \u53D8\u91CF SHELL \u8868\u660E\u5F53\u524D\u7684 shell \u7C7B\u578B\uFF0C\u82E5 makefile \u53D7\u8FD9\u4E2A\u73AF\u5883\u53D8\u91CF\u7684\u5F71\u54CD\uFF0C\u5C31\u5B83\u4E0D\u7A33\u5B9A\u4E86\u3002</p><p>\u540C\u65F6\uFF0Crecipe \u4E2D\u7EE7\u627F\u7684\u73AF\u5883\u53D8\u91CF SHELL\uFF0C\u4E0D\u662F makefile \u7684SHELL\u53D8\u91CF\uFF0C\u800C\u662F\u771F\u5B9E\u7684\u7528\u6237\u53D8\u91CF SHELL\u3002</p><p>\u5728 MS-DOS \u548C MS-Windows \u4E0A\uFF0Cmakefile \u53CD\u800C\u53C8\u4F1A\u7528\u73AF\u5883\u53D8\u91CF SHELL \u4F5C\u4E3A\u81EA\u5DF1\u7684 SHELL \u53D8\u91CF\uFF0C \u8FD9\u662F\u56E0\u4E3A dos \u7CFB\u7EDF\u4E00\u822C\u4E0D\u8BBE\u7F6E\u8FD9\u4E2A\u53D8\u91CF\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E86\uFF0C\u5927\u6982\u7387\u5C31\u662F\u4E3A\u4E86\u7ED9 makefile \u6307\u5B9A shell\u3002\u5728 MS-DOS \u4E0A\uFF0C\u5982\u679C\u4E0D\u65B9\u4FBF\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF SHELL\uFF0C\u53EF\u7528\u73AF\u5883\u53D8\u91CF MAKESHELL \u6307\u5B9A makefile \u4E2D\u7684 SHELL\uFF0C\u5B83\u6BD4 SHELL \u4F18\u5148\u7EA7\u66F4\u9AD8\u3002</p><p>demo\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> Makefile

<span class="token comment"># SHELL \u7684\u503C</span>
<span class="token variable"><span class="token variable">$(</span>info $<span class="token punctuation">{</span><span class="token environment constant">SHELL</span><span class="token punctuation">}</span><span class="token variable">)</span></span>

hello:<span class="token punctuation">;</span> @echo <span class="token variable">\${<span class="token environment constant">SHELL</span>}</span>,$<span class="token variable">\${<span class="token environment constant">SHELL</span>}</span>

$ <span class="token function">make</span>
/bin/sh
/bin/sh,/bin/bash
$ <span class="token function">make</span> -e <span class="token assign-left variable"><span class="token environment constant">SHELL</span></span><span class="token operator">=</span>f
f
make: f: No such <span class="token function">file</span> or directory
make: *** <span class="token punctuation">[</span>Makefile:5: hello<span class="token punctuation">]</span> Error <span class="token number">127</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>\u4E5F\u5C31\u662F\u8BF4\uFF0C\u540C\u6837\u7684\u53D8\u91CF\uFF0CSHELL\uFF0C\u6709\u4E24\u4E2A\u3002</p><h4 id="\u5728dos\u548Cwindows\u4E2D\u9009\u62E9shell-\u7565" tabindex="-1"><a class="header-anchor" href="#\u5728dos\u548Cwindows\u4E2D\u9009\u62E9shell-\u7565" aria-hidden="true">#</a> \u5728DOS\u548Cwindows\u4E2D\u9009\u62E9shell \uFF08\u7565)</h4><h2 id="_5-4-\u5E76\u53D1\u6267\u884C" tabindex="-1"><a class="header-anchor" href="#_5-4-\u5E76\u53D1\u6267\u884C" aria-hidden="true">#</a> 5.4 \u5E76\u53D1\u6267\u884C</h2><p>\u9ED8\u8BA4\uFF0Cmake \u987A\u5E8F\u6267\u884C recipe\uFF0C\u5982\u679C\u6307\u5B9A\u4E86 -j \u9009\u9879\uFF0Cmake \u4F1A\u5E76\u53D1\u6267\u884C recipe\u3002 -j \u540E\u8DDF\u6574\u6570\uFF0C\u5219\u9650\u5236\u5E76\u53D1\u7684 recipe \u6570\uFF0C\u5982\u679C\u4E0D\u8DDF\u6574\u6570\uFF0C\u5219\u8868\u793A\u4E0D\u9650\u5236\u3002\u5982\u679C\u4E0D\u6307\u5B9A -j \u9009\u9879\uFF0C \u7B49\u6548\u4E8E -j 1\uFF0C\u4E5F\u5C31\u662F\u9ED8\u8BA4\u884C\u4E3A\u3002</p><p>-j N \u6307\u5B9A\u7684\u662F\u540C\u65F6\u6267\u884C\u7684 recipe \u7684\u6570\u91CF\uFF0C\u8FD9\u53EB\u505A job slots\u3002</p>`,100),rs=a("\u5E76\u53D1\u6267\u884C\u7684\u65F6\u5019\uFF0C\u9012\u5F52\u8C03\u7528 make \u9700\u8981\u505A\u4E9B\u5904\u7406\uFF0C\u5426\u5219\u4F1A\u6709\u95EE\u9898\uFF0C\u8BE6\u60C5\u53C2\u8003 "),ps={href:"https://www.gnu.org/software/make/manual/make.html#Options_002fRecursion",title:"5.7.3 Communicating Options to a Sub-make",target:"_blank",rel:"noopener noreferrer"},os=a("Communicating Options to a Sub-make"),cs=a("."),us=t(`<p>\u5982\u679C recipe \u6267\u884C\u5931\u8D25\uFF0C\u4E14\u672A\u5FFD\u7565\u9519\u8BEF\uFF0C\u5219 make \u4F1A\u7EC8\u6B62\u6B64 recipe \u7684\u6267\u884C\uFF08\u4E5F\u5C31\u662F\u4E0D\u4F1A\u7EE7\u7EED\u6267\u884C\u540E\u9762\u7684\u884C\uFF09\u3002 \u5982\u679C recipe \u6267\u884C\u5931\u8D25\uFF0C\u540C\u65F6\u53C8\u672A\u6307\u5B9A -k --keep-going \u9009\u9879\uFF0C\u5219 make \u4F1A\u7EC8\u6B62\u6267\u884C\u3002 \u5982\u679C make \u56E0\u67D0\u79CD\u539F\u56E0\u8981\u7EC8\u6B62\u6267\u884C\uFF08\u5305\u62EC\u6536\u5230 SIGINT\u4FE1\u53F7\uFF09\uFF0C\u540C\u65F6\u6709\u6B63\u5728\u6267\u884C\u7684\u5B50\u8FDB\u7A0B\uFF0Cmake \u4F1A\u7B49\u5F85\u8FD9\u4E9B\u5B50\u8FDB\u7A0B\u6267\u884C\u5B8C\u6BD5\u3002</p><p>\u9009\u9879 -l --max-load \u7528\u4E8E\u6307\u5B9A\u7CFB\u7EDF\u8D1F\u8F7D\u9650\u5236\u3002\u5F53\u7CFB\u7EDF\u8D1F\u8F7D\u9AD8\u4E8E\u6B64\u6C34\u5E73\u4E14make\u5DF2\u7ECF\u6709\u81F3\u5C11\u4E00\u4E2A job \u5728\u8FD0\u884C\uFF0Cmake \u5C31\u4E0D\u4F1A\u5F00\u542F \u65B0\u7684job\uFF0C\u9664\u975E\u7CFB\u7EDF\u8D1F\u8F7D\u964D\u4F4E\u5230\u6307\u5B9A\u7684\u9650\u5236\u4E0B\u3002\u9ED8\u8BA4\uFF0C\u6CA1\u6709\u9650\u5236\u3002</p><h3 id="_5-4-1-\u5E76\u53D1\u65F6\u7684\u8F93\u51FA" tabindex="-1"><a class="header-anchor" href="#_5-4-1-\u5E76\u53D1\u65F6\u7684\u8F93\u51FA" aria-hidden="true">#</a> 5.4.1 \u5E76\u53D1\u65F6\u7684\u8F93\u51FA</h3><p>\u9ED8\u8BA4\uFF0Crecipe \u8F93\u51FA\u7684\u4FE1\u606F\u4F1A\u88AB\u7ACB\u5373\u8F93\u51FA\u5230\u6807\u51C6\u8F93\u51FA\u4E0A\uFF0C\u5728\u5E76\u53D1\u6267\u884C\u7684\u65F6\u5019\uFF0C\u591A\u4E2A recipe \u4E4B\u95F4\u7684 \u8F93\u51FA\u4F1A\u6DF7\u6742\u5728\u4E00\u8D77\uFF0C\u751A\u81F3\u6DF7\u5728\u5728\u4E00\u884C\u4E2D\uFF0C\u4F7F\u5F97\u9605\u8BFB\u56F0\u96BE\u3002</p><p>\u7528 -o --output-sync \u9009\u9879\u53EF\u4EE5\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u3002\u6307\u5B9A -o \u9009\u9879\u540E\uFF0Cmake \u4F1A\u7F13\u5B58\u6BCF\u4E2A recipe\u7684\u8F93\u51FA\uFF0C \u7B49 recipe \u6267\u884C\u5B8C\u6BD5\u540E\u518D\u4E00\u6B21\u6027\u6253\u5370\u51FA\u6765\uFF0C\u786E\u4FDD\u5176\u5B8C\u6574\u3002\u6307\u5B9A -o \u9009\u9879\u540E\uFF0C\u591A\u4E2A\u540C\u65F6\u6267\u884C\u7684 \u9012\u5F52 make \u4F1A\u534F\u8C03\u4E00\u81F4\uFF0C\u786E\u4FDD\u4E0D\u4F1A\u4F7F\u8F93\u51FA\u6DF7\u4E71\u3002</p><p>\u5982\u679C\u5F00\u542F\u4E86\u5DE5\u4F5C\u76EE\u5F55\u6253\u5370\uFF08--print-directory\u9009\u9879\uFF09\uFF0C\u6BCF\u7EC4\u4FE1\u606F\u7684\u5F00\u5934\u548C\u7ED3\u675F\u90FD\u4F1A\u9644\u52A0\u4E0A\u4E00\u6761 enter/leave \u6D88\u606F\u3002 \u8981\u5173\u95ED\u8FD9\u4E2A\u6D88\u606F\uFF0C\u4F7F\u7528 --no-print-directory \u9009\u9879\uFF0C\u5728 MAKEFLAGS \u4E2D\u8BBE\u7F6E\u3002</p><p>Q. \u4E3A\u4EC0\u4E48\u662F\u5728\u8FD9\u4E2A\u53D8\u91CF\u4E2D\u8BBE\u7F6E\uFF1F</p><p>\u8F93\u51FA\u540C\u6B65\uFF08-o\u9009\u9879\uFF09\u6709\u56DB\u4E2A\u7C92\u5EA6</p><ul><li>none\uFF1A \u8FD9\u662F\u672A\u6307\u5B9A -o \u9009\u9879\u65F6\u7684\u9ED8\u8BA4\u884C\u4E3A\u3002\u7ACB\u5373\u6253\u5370\u4EA7\u751F\u7684\u8F93\u51FA\uFF0C\u4E5F\u5C31\u662F\u6CA1\u6709\u4EFB\u4F55\u540C\u6B65\u63AA\u65BD</li><li>line\uFF1A \u4EE5\u884C\u4F5C\u4E3A\u5206\u7EC4\uFF0C\u6BCF\u4EA7\u751F\u4E00\u884C\u5C31\u8F93\u51FA\u4E00\u884C\u3002\u5982\u679C\u4E00\u4E2A recipe \u591A\u884C\u8F93\u51FA\uFF0C\u5B83\u4EEC\u53EF\u80FD\u4F1A\u548C\u5176recipe\u8F93\u51FA\u7684\u884C\u6DF7\u5408\u3002</li><li>target\uFF1A\u8FD9\u662F\u6307\u5B9A -o \u9009\u9879\u65F6\u7684\u9ED8\u8BA4\u884C\u4E3A\u3002\u6BCF\u4E2A target \u4EA7\u751F\u7684\u8F93\u51FA\u4F5C\u4E3A\u4E00\u7EC4\u3002\u5F53\u4E00\u4E2Atarget\u7684recipre\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u4E00\u6B21\u6027\u8F93\u51FA\u5BF9\u5E94\u7684\u6D88\u606F\u3002</li><li>recurse\uFF1A\u6BCF\u4E2Amake\u9012\u5F52\u8C03\u7528\u4F5C\u4E3A\u4E00\u4E2A\u5206\u7EC4\uFF0C\u5E76\u5728 <blockquote><p>Output from each recursive invocation of make is grouped and printed once the recursive invocation is complete.</p></blockquote></li></ul><p>\u4E0D\u540C\u540C\u6B65\u7C92\u5EA6\uFF0Cmake \u7684\u6267\u884C\u65F6\u95F4\u4E0D\u4F1A\u53D8\u5316\uFF0C\u53D8\u5316\u7684\u53EA\u662F\u8F93\u51FA\u5185\u5BB9\u7684\u65B9\u5F0F\u3002</p><p>\u5BF9\u4E8E\u4E0D\u542B\u9012\u5F52make\u8C03\u7528\u7684recipe\u6765\u8BF4\uFF0Ctarget \u548C recurse \u6548\u679C\u76F8\u540C\u3002</p><p>\u8BBE\u7F6E recurse \u6A21\u5F0F\uFF0C\u5982\u679C recipe \u4E2D\u6709\u9012\u5F52\u7684make\u8C03\u7528\uFF0C\u5219\u8F93\u51FA\u4E5F\u548C target \u4E00\u6837\uFF0C\u9700\u8981\u7B49\u6574\u4E2A recipe \u8C03\u7528\u5B8C\u6210\uFF08\u4ECE\u800C\u6574\u4E2A\u9012\u5F52make\u6267\u884C \u5B8C\u6BD5\uFF09\u624D\u4F1A\u4E00\u6B21\u6027\u4E0D\u4E2D\u65AD\u6253\u5370\u6240\u6709\u8F93\u51FA\uFF0C\u8FD9\u6837\u7684\u597D\u5904\u662F\u65E5\u5FD7\u6E05\u6670\uFF0C\u574F\u5904\u662F\u5982\u679C\u9012\u5F52make\u6267\u884C\u65F6\u95F4\u8F83\u957F\uFF0C\u4F1A\u8F93\u51FA\u5C31\u9700\u8981\u7B49\u5F85\u3002\u5982\u679C\u662F\u79BB\u7EBF\u6267\u884C\uFF0C \u800C\u540E\u67E5\u770B\u8F93\u51FA\uFF0C\u663E\u7136\u8FD9\u79CD\u6A21\u5F0F\u66F4\u5408\u9002\u3002</p><p>\u4F46\u5982\u679C\u662F\u8981\u5B9E\u65F6\u67E5\u770B\u8F93\u51FA\uFF0C\u5C31\u6709\u70B9\u5934\u75BC\u4E86\u3002\u4F7F\u7528 target \u6A21\u5F0F\uFF0Cmake \u4F1A\u68C0\u6D4B\u5230 recipe \u4E2D\u7684\u9012\u5F52make\u8C03\u7528\uFF0C\u5E76\u5BF9\u8FD9\u4E9B\u5305\u542B\u9012\u5F52make \u8C03\u7528\u7684\u884C\u5173\u95ED\u540C\u6B65\u5904\u7406\uFF0C\u800C\u9012\u5F52make\u81EA\u5DF1\u4F1A\u6309 target \u6A21\u5F0F\u5904\u7406\u81EA\u5DF1\u7684 recipe \u8F93\u51FA\u540C\u6B65\u95EE\u9898\uFF0C\u9700\u8981\u6307\u51FA\u9012\u5F52\u8C03\u7528make\u7684recipe\u884C\uFF0C \u5982\u679C\u5728\u8C03\u7528make\u4E4B\u524D\u6709\u8F93\u51FA\u4FE1\u606F\uFF0C\u8FD9\u4E9B\u4FE1\u606F\u4E0D\u4F1A\u5F97\u5230\u540C\u6B65\u3002<code>echo hello &amp;&amp; $(MAKE) -f some-makefile</code>\u3002</p><p>line \u6A21\u5F0F\uFF0C\u9002\u5408\u524D\u7AEF\u5B9E\u65F6\u76D1\u63A7\u8F93\u51FA\uFF0C\u7528\u4E8E\u5224\u65AD\u6BCF\u4E2Arecipe\u5F00\u59CB\u548C\u7ED3\u675F\u3002</p><p>\u6709\u4E9B\u7A0B\u5E8F\u4F1A\u6839\u636E\u8F93\u51FA\u5230\u63A7\u5236\u53F0\u8FD8\u662F\u6587\u4EF6\uFF08\u901A\u5E38\u79F0\u4E3A\u4EA4\u4E92\u6A21\u5F0F\u548C\u975E\u4EA4\u4E92\u6A21\u5F0F\uFF09\u4F7F\u7528\u4E0D\u540C\u7684\u8F93\u51FA\uFF0C\u5982\u4EA4\u4E92\u6A21\u5F0F\u4E0B\u751F\u6210\u5F69\u8272\u8F93\u51FA\u3002 \u56E0\u4E3A make \u7684\u540C\u6B65\u6A21\u5F0F\u4F1A\u7F13\u5B58\u8F93\u51FA\uFF0C\u6240\u4EE5\u7A0B\u5E8F\u4F1A\u8BA4\u4E3A\u5904\u4E8E\u975E\u4EA4\u4E92\u6A21\u5F0F\uFF0C\u800C\u5B9E\u9645\u4E0A\uFF0C\u53EF\u4EE5\u89C6\u4E3A\u4EA4\u4E92\u6A21\u5F0F\u3002</p><h3 id="_5-4-2-\u5E76\u53D1\u65F6\u7684\u8F93\u5165" tabindex="-1"><a class="header-anchor" href="#_5-4-2-\u5E76\u53D1\u65F6\u7684\u8F93\u5165" aria-hidden="true">#</a> 5.4.2 \u5E76\u53D1\u65F6\u7684\u8F93\u5165</h3><p>\u4E24\u4E2A\u8FDB\u7A0B\u65E0\u6CD5\u540C\u65F6\u4ECE\u540C\u4E00\u4E2A\u8BBE\u5907\u8BFB\u53D6\u8F93\u5165\u3002\u5E76\u53D1\u6267\u884C\u65F6\uFF0Cmake \u53EA\u5F00\u542F\u4E00\u4E2A\u6B63\u5728\u6267\u884C\u7684 recipe \u7684\u8F93\u5165\uFF0C \u800C\u5173\u95ED\u5176\u5B83\u6240\u6709 recipe \u7684\u7684\u8F93\u5165\uFF0C\u5982\u679C\u8FD9\u4E9B recipe \u5C1D\u8BD5\u4ECE stdin \u8BFB\u53D6\u8F93\u5165\uFF0C\u5C31\u4F1A\u62A5\u9519\u3002</p><p>\u65E0\u6CD5\u9884\u77E5\u54EA\u4E2A recipe \u4F1A\u5F97\u5230\u8F93\u5165\u3002make \u662F\u8FD9\u4E48\u505A\u7684\uFF0C\u7B2C\u4E00\u4E2A\u6267\u884C\u7684 recipe \u5F97\u5230\u8F93\u5165\uFF0C\u5176\u5B83 \u540C\u65F6\u6267\u884C\u7684 recipe \u5F97\u4E0D\u5230\u8F93\u5165\uFF0C\u7B49\u7B2C\u4E00\u4E2A\u5F97\u5230\u8F93\u5165\u7684 recipe \u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u7D27\u8DDF\u7740\u6267\u884C\u7684\u90A3\u4E2A recipe \u5F97\u5230\u8F93\u5165\u3002</p><p>\u5982\u679C\u6709\u66F4\u597D\u7684\u5904\u7406\u65B9\u6CD5\uFF0C\u6211\u4EEC\u5C06\u5C1D\u8BD5\u6539\u8FDB\u3002\u5728\u6B64\u4E4B\u524D\uFF0C\u5E76\u884C\u6267\u884C\u7684\u65F6\u5019\uFF0C\u8BF7\u52A1\u5FC5\u4E0D\u8981\u4F9D\u8D56 recipe \u8BFB\u53D6\u8F93\u5165\u3002\u975E\u5E76\u53D1\u6267\u884C\u7684\u65F6\u5019\u53EF\u4EE5\u5728 recipe \u4E2D\u8BFB\u53D6\u6807\u51C6\u8F93\u5165\u3002</p><h2 id="_5-5-recipe-\u4E2D\u7684\u9519\u8BEF" tabindex="-1"><a class="header-anchor" href="#_5-5-recipe-\u4E2D\u7684\u9519\u8BEF" aria-hidden="true">#</a> 5.5 recipe \u4E2D\u7684\u9519\u8BEF</h2><ul><li>make\u7684\u9519\u8BEF\u68C0\u6D4B</li><li>\u5FFD\u7565\u9519\u8BEF\uFF1A-\u3001-i\u3001\u52A8\u673A</li><li>keep going\uFF1A\u673A\u5236\uFF0C\u539F\u56E0</li><li>\u9519\u8BEF\u65F6\u7684\u5220\u9664</li></ul><p>\u6267\u884C\u7684 recipe \u7684\u65F6\u5019\uFF0C\u6BCF\u6267\u884C\u4E00\u884C\uFF0Cmake \u68C0\u67E5\u5176\u9000\u51FA\u72B6\u6001\uFF0C\u5982\u679C\u6267\u884C\u6210\u529F\uFF0Cmake \u5728\u65B0\u7684shell\u8FDB\u7A0B \u4E2D\u6267\u884C\u4E0B\u4E00\u884C\uFF0C\u5982\u6B64\u7EE7\u7EED\uFF0C\u76F4\u5230\u6700\u540E\u4E00\u884C\u4E5F\u6210\u529F\u6267\u884C\uFF0C\u6574\u4E2Arecipe\u6267\u884C\u5B8C\u6BD5\u3002</p><p>\u5982\u679C\u67D0\u4E00\u884C\u6267\u884C\u5931\u8D25\uFF0Cmake \u7EC8\u6B62\u5F53\u524D recipe \u7684\u6267\u884C\uFF0C\u901A\u5E38\uFF0C\u5176\u5B83\u6240\u6709\u5F85\u6267\u884C\u7684 recipe \u4E5F\u4E00\u5E76\u7EC8\u6B62\u3002</p><p>\u6709\u4E9B\u884C\uFF0C\u6267\u884C\u5931\u8D25\u5E76\u4E0D\u4EE3\u8868\u51FA\u73B0\u95EE\u9898\uFF0C\u6BD4\u5982 mkdir foo \u547D\u4EE4\u662F\u4E3A\u4E86\u786E\u4FDD\u76EE\u5F55 foo \u5B58\u5728\uFF0C\u5982\u679C\u76EE\u5F55 \u5DF2\u7ECF\u5B58\u5728\uFF0C\u6267\u884C\u6B64\u547D\u4EE4\u4F1A\u5931\u8D25\uFF0C\u4F46\u8FD9\u4E2A\u5931\u8D25\u4E0D\u4EE3\u8868\u51FA\u9519\uFF0C\u53EF\u4EE5\u7EE7\u7EED\u6267\u884C\u3002\u8FD9\u79CD\u60C5\u51B5\uFF0C\u53EF\u4EE5\u5728\u547D\u4EE4\u7684 \u5F00\u5934\u6DFB\u52A0\u7279\u6B8A\u5B57\u7B26<code>-</code>\uFF0C\u6BD4\u5982 <code>-mkdir foo</code>\uFF0C\u79FB\u4EA4shell\u6267\u884C\u7684\u65F6\u5019\uFF0Cmake \u4F1A\u5220\u9664\u5F00\u5934\u7684\u7279\u6B8A\u5B57\u7B26\u3002</p><p>\u6267\u884C\u7684\u65F6\u5019\u4F7F\u7528 -i --ignore-errors\uFF0C\u4F1A\u5FFD\u7565\u6240\u6709recipe\u7684\u6240\u6709\u884C\u7684\u9519\u8BEF\uFF0C\u5C31\u597D\u50CF\u5728\u6BCF\u4E2A\u547D\u4EE4\u7684 \u5F00\u5934\u6DFB\u52A0\u4E86\u7279\u6B8A\u5B57\u7B26 <code>-</code>\u3002\u5728 makefile \u4E2D\u4F7F\u7528\u4E0D\u542B prerequisite \u7684 <code>.IGNORE:</code> \u7279\u6B8A\u76EE\u6807\uFF0C \u6548\u679C\u548C -i \u9009\u9879\u7B49\u540C\u3002</p><p>\u5F53\u67D0\u4E2A recipe \u7684\u67D0\u4E2A\u547D\u4EE4\u6267\u884C\u5931\u8D25\uFF0C\u4E14\u6CA1\u6709\u5FFD\u7565\u6B64\u884C\u547D\u4EE4\u7684\u9519\u8BEF\uFF08-i\u6216\u8005-\u5B57\u7B26\uFF09\uFF0C\u8868\u660E\u6B64 recipe \u5BF9\u5E94\u7684 target \u65E0\u6CD5\u6210\u529F\u66F4\u65B0\uFF0C\u540C\u65F6\u6240\u6709\u76F4\u63A5\u6216\u95F4\u63A5\u4F9D\u8D56\u4E8E\u6B64 target \u7684\u90A3\u4E9B target \u4E5F\u65E0\u6CD5\u66F4\u65B0\u3002 \u6240\u4EE5 make \u4F1A\u7ACB\u5373\u505C\u6B62\u6240\u6709\u8FD9\u4E9B target \u5BF9\u5E94\u7684 recipe \u7684\u6267\u884C\u3002</p><p>\u901A\u5E38\uFF0C\u8FD9\u65F6\u5019 make \u4F1A\u7EC8\u6B62\u6574\u4E2A\u6267\u884C\u8FC7\u7A0B\u3002\u4F46\u5982\u679C\u6307\u5B9A\u4E86 -k --keep-going\uFF0Cmake \u4F1A\u5728\u9047\u5230\u9519\u8BEF \u540E\u7EE7\u7EED\u6267\u884C\u5176\u5B83\u53EF\u4EE5\u6267\u884C\u7684 recipe\u3002\u6BD4\u5982\uFF0C\u7F16\u8BD1 foo.o \u5931\u8D25\u4E86\uFF0Cmake \u53EF\u4EE5\u7EE7\u7EED\u5C1D\u8BD5\u7F16\u8BD1\u5176\u5B83 \u5BF9\u8C61\u6587\u4EF6\u3002</p><p>\u9ED8\u8BA4\u884C\u4E3A\u4E0B\uFF0C\u662F\u5047\u8BBE\u7528\u6237\u4E3A\u4E86\u6784\u5EFA\u6700\u7EC8\u7684\u7A0B\u5E8F\uFF0C\u51FA\u73B0\u9519\u8BEF\u8868\u660E\u6700\u7EC8\u65E0\u6CD5\u6784\u5EFA\u7A0B\u5E8F\uFF0C\u6240\u4EE5 make \u7ACB\u5373\u505C\u6B62\u6784\u5EFA\u8FC7\u7A0B\u5E76\u62A5\u544A\u9519\u8BEF\u4FE1\u606F\u3002\u800C\u6307\u5B9A -k --keep-going \u9009\u9879\uFF0C\u5219\u8868\u793A\u6700\u7EC8\u76EE\u7684\u662F\u4E3A\u4E86 \u5C3D\u53EF\u80FD\u591A\u7684\u68C0\u67E5\u6700\u8FD1\u66F4\u6539\u7684\u7A0B\u5E8F\u5B58\u5728\u7684\u95EE\u9898\uFF0C\u6B64\u65F6\uFF0Cmake \u4E0D\u4F1A\u9047\u9519\u7ACB\u5373\u7EC8\u6B62\u3002</p><p>\u5982\u679C\u6267\u884C\u67D0\u4E2A recipe \u65F6\u7EC8\u6B62\u4E86\uFF08\u56E0\u4E3A\u5931\u8D25\u6216\u8005\u56E0\u4E3A\u7EC8\u6B62\u4FE1\u53F7\uFF09\uFF0C\u8FD9\u4E2A recipe \u751F\u6210\u7684\u6587\u4EF6 \u662F\u635F\u574F\u7684\uFF0C\u800C\u5B83\u4E2A\u66F4\u65B0\u65F6\u95F4\u53C8\u662F\u65B0\u7684\uFF0C\u4E0B\u6B21\u6267\u884C\u7684\u65F6\u5019\uFF0Cmake \u4F1A\u8BA4\u4E3A\u8FD9\u4E2A target \u4E0D\u9700\u8981\u66F4\u65B0\uFF0C \u8FD9\u662F\u6709\u95EE\u9898\u7684\uFF0C\u6B63\u786E\u7684\u505A\u6CD5\u662F\uFF0C\u5728\u51FA\u9519\u7EC8\u6B62\u65F6\uFF0C\u5982\u679C\u8FD9\u4E2A target \u6587\u4EF6\u5DF2\u7ECF\u53D1\u751F\u4E86\u53D8\u5316\u5C31\u5220\u9664\u5B83\u3002 \u7531\u4E8E\u5386\u53F2\u539F\u56E0\uFF0Cmake \u9ED8\u8BA4\u4E0D\u4F1A\u4E3B\u52A8\u5220\u9664\u8FD9\u4E9B\u9519\u8BEF\u7684\u6587\u4EF6\u3002\u8BBE\u7F6E <code>.DELETE_ON_ERROR:</code>\u5C31\u53EF\u4EE5\u3002</p><p>Q. \u6211\u5728\u524D\u9762\u7684\u6587\u6863\u91CC\u597D\u50CF\u770B\u5230\uFF0C\u4F1A\u81EA\u52A8\u5220\u9664\u554A\uFF0C\u4EC0\u4E48\u6761\u4EF6\u6765\u7740\uFF1F</p><h2 id="_5-6-\u7EC8\u6B62-make" tabindex="-1"><a class="header-anchor" href="#_5-6-\u7EC8\u6B62-make" aria-hidden="true">#</a> 5.6 \u7EC8\u6B62 make</h2><p>Interrupting or Killing make</p><p>\u5982\u524D\u6240\u8FF0\uFF0Cmake \u9047\u9519\u7EC8\u6B62\u7684\u65F6\u5019\u53EF\u80FD\u4F1A\u5220\u9664\u6CA1\u6709\u6B63\u786E\u66F4\u65B0\u7684 target \u6587\u4EF6\uFF0Cmake \u4F9D\u8D56 target \u6587\u4EF6\u7684\u6700\u540E\u66F4\u65B0\u65F6\u95F4\u505A\u8FD9\u4E2A\u5224\u65AD\u3002</p><p>\u7F16\u8BD1\u5668\u7F16\u8BD1\u67D0\u4E2A .o \u6587\u4EF6\u7684\u65F6\u5019\uFF0C\u7F16\u8BD1\u5230\u4E00\u534A\uFF0CCtr-C \u6740\u6B7B\u4E86\u7F16\u8BD1\u8FDB\u7A0B\uFF0C\u540C\u65F6 make \u4E5F\u4F1A\u6355\u83B7 Ctr-C \u4FE1\u53F7\uFF0C\u5220\u9664\u4E0D\u5B8C\u6574\u7684\u6587\u4EF6\u3002</p><p>\u53EF\u4EE5\u5173\u95ED\u8FD9\u4E2A\u64CD\u4F5C\uFF0C\u628A\u8FD9\u4E2A target \u6587\u4EF6\u4F5C\u4E3A\u7279\u6B8A\u76EE\u6807<code>.PRECIOUS:</code>\u7684\u4F9D\u8D56\u5373\u53EF\u3002 \u8FD9\u6837\u505A\u7684\u539F\u56E0\u53EF\u80FD\u6709\uFF0C\u8FD9\u4E2A target \u6587\u4EF6\u7684\u66F4\u65B0\u662F\u539F\u5B50\u7684\uFF0C\u6216\u8005 target \u6587\u4EF6\u53EA\u662F\u4E3A\u4E86\u8BB0\u5F55 \u6700\u540E\u4FEE\u6539\u65F6\u95F4\uFF0C\u6216\u8005target\u6587\u4EF6\u5FC5\u987B\u5B58\u5728\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u9519\u8BEF\u3002</p><p>\u5C3D\u7BA1 make \u52AA\u529B\u6E05\u7406\u8FD9\u4E9B\u4E0D\u5B8C\u6574\u7684\u6587\u4EF6\uFF0C\u4F46\u4E5F\u4E0D\u662F\u4E07\u65E0\u4E00\u5931\u7684\u3002\u6BD4\u5982\uFF0Cmake \u53EF\u80FD\u88AB\u65E0\u6CD5\u6355\u83B7\u7684 \u4FE1\u53F7\u6740\u6B7B\uFF0Cmake \u672C\u8EAB\u6709bug\uFF0C\u7B49\u7B49\u3002</p><p>\u6240\u4EE5\uFF0C\u6700\u597D\u662F\u7F16\u5199 recipe \u7684\u65F6\u5019\u8003\u8651\u5230\u8FD9\u4E2A\u95EE\u9898\uFF0C\u4F7F\u5F97 recipe \u5F02\u5E38\u7EC8\u6B62\u7684\u65F6\u5019\u4E5F\u4E0D\u4F1A\u7559\u4E0B \u4E0D\u5B8C\u6574\u7684\u6587\u4EF6\u3002\u6BD4\u5982\uFF0C\u4F7F\u7528\u4E34\u65F6\u6587\u4EF6\uFF0C\u7B49\u751F\u6210\u5B8C\u6BD5\u518D\u91CD\u547D\u540D\u8FC7\u53BB\u3002\u4E00\u4E9B\u7F16\u8BD1\u5668\u5C31\u662F\u8FD9\u4E48\u505A\u7684\uFF0C \u6240\u4EE5\u53EF\u4EE5\u653E\u5FC3\u5927\u80C6\u7684\u7528\u3002</p><h2 id="_5-7-\u9012\u5F52\u8C03\u7528-make" tabindex="-1"><a class="header-anchor" href="#_5-7-\u9012\u5F52\u8C03\u7528-make" aria-hidden="true">#</a> 5.7 \u9012\u5F52\u8C03\u7528 make</h2><p>\u5728 recipe \u4E2D\u8C03\u7528 make \u547D\u4EE4\uFF0C\u5C31\u662F\u9012\u5F52\u8C03\u7528\u3002 \u591A\u4E2A\u5B50\u7CFB\u7EDF\u7EC4\u5408\u6210\u4E00\u4E2A\u5927\u7CFB\u7EDF\u7684\u65F6\u5019\uFF0C\u6BCF\u4E2A\u81EA\u7CFB\u7EDF\u90FD\u6709\u81EA\u5DF1\u7684makefile\uFF0C\u8FD8\u6709\u4E00\u4E2A\u603B\u7684makefile\uFF0C \u8FD9\u79CD\u60C5\u51B5\u5C31\u9002\u5408\u4F7F\u7528\u9012\u5F52\u8C03\u7528\u3002</p><p>\u4F8B\u5982\uFF0C\u5047\u8BBE\u9879\u76EE\u6839\u76EE\u5F55\u4E0B\u6709\u4E2A\u5B50\u76EE\u5F55 sub\uFF0C\u5B83\u6709\u81EA\u5DF1\u7684makefile\uFF0C\u800C\u4F60\u5E0C\u671B\u5728\u9876\u7EA7makefile\u4E2D\u8C03\u7528 \u5B83\uFF0C\u4EE3\u7801\u5C31\u53EF\u4EE5\u8FD9\u4E48\u5199\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">subsystem</span><span class="token punctuation">:</span>
    cd sub &amp;&amp; <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u6216\u8005\u7B49\u4EF7\u7684\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">subsystem</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> -c sub
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u53EF\u4EE5\u7B80\u5355\u5730\u590D\u5236\u4F7F\u7528\u8FD9\u4E2A\u4EE3\u7801\u3002\u7136\u800C\u6700\u597D\u4E86\u89E3\u5176\u4E2D\u7684\u7EC6\u8282\u548C\u539F\u56E0\uFF0C\u4E86\u89E3\u9876\u5C42make\u548C\u5B50make\u4E4B\u95F4\u7684 \u5173\u7CFB\u3002</p><p>\u4E3A\u4E86\u65B9\u4FBF\uFF0CGNU make \u5DE5\u5177\u4F1A\u8BBE\u7F6E\u4E00\u4E2A\u53D8\u91CF CURDIR\uFF0C\u5B83\u5BF9\u5E94 make \u7684\u5DE5\u4F5C\u76EE\u5F55\uFF08\u5904\u7406\u5B8C -C \u9009\u9879\u4E4B\u540E\uFF09\u3002 \u5305\u542B\u5176\u5B83\u76EE\u5F55\u4E0B\u7684makefile\uFF0CCURDIR \u7684\u503C\u4E0D\u4F1A\u53D8\u3002\u5B83\u4E0D\u4F1A\u88AB\u73AF\u5883\u53D8\u91CF\u4E2D\u8BBE\u7F6E CURDIR \u8986\u76D6\u3002 \u5728 makefile \u4E2D\u624B\u52A8\u8BBE\u7F6E\u8FD9\u4E2A\u53D8\u91CF\u7684\u503C\uFF0C\u4E5F\u4E0D\u4F1A\u5BF9make\u4EA7\u751F\u5F71\u54CD\uFF0C\u6BD4\u5982make\u4E0D\u4F1A\u56E0\u6B64\u66F4\u6539\u5F53\u524D\u7684 \u5DE5\u4F5C\u76EE\u5F55\u3002</p><h3 id="_5-7-1-make\u53D8\u91CF\u7684\u5DE5\u4F5C\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#_5-7-1-make\u53D8\u91CF\u7684\u5DE5\u4F5C\u65B9\u5F0F" aria-hidden="true">#</a> 5.7.1 MAKE\u53D8\u91CF\u7684\u5DE5\u4F5C\u65B9\u5F0F</h3><p>\u9012\u5F52\u8C03\u7528 make \u65F6\uFF0C\u5E94\u5F53\u603B\u662F\u4F7F\u7528\u53D8\u91CF MAKE\uFF0C\u4E0D\u8981\u76F4\u63A5\u4F7F\u7528 make \u547D\u4EE4\u3002</p><p>\u7B2C\u4E00\uFF0C\u53D8\u91CF MAKE \u603B\u662F\u6307\u5411\u5F53\u524D make \u7A0B\u5E8F\uFF0C\u5982\u679C\u4F7F\u7528\u4E86\u7279\u5B9A\u7248\u672C\u7684make\uFF0C\u8FD9\u4E2A\u53D8\u91CF\u4E5F\u4F1A\u6269\u5C55\u4E3A \u5B83\uFF0C\u4FDD\u8BC1\u4E00\u81F4\u6027\u3002</p><p>\u7B2C\u4E8C\uFF0C\u76F4\u63A5\u4F7F\u7528\u53D8\u91CF MAKE \u7684 recipe \u884C\uFF0C\u53EF\u4EE5\u907F\u5F00 -n\u3001-t\u3001-q \u8FD9\u4E09\u4E2A\u9009\u9879\u7684\u5F71\u54CD\u3002 \u8981\u6C42\u5FC5\u987B\u662F\u76F4\u63A5\u4F7F\u7528 MAKE \u53D8\u91CF\uFF0C\u901A\u8FC7\u5176\u5B83\u53D8\u91CF\u5C55\u5F00\u5F97\u5230 MAKE \u4E0D\u5177\u5907\u8FD9\u4E2A\u6548\u679C\u3002+ \u548C \u76F4\u63A5\u4F7F\u7528 MAKE \u53D8\u91CF\u6709\u76F8\u540C\u7684\u6548\u679C\u3002</p><p>ps\uFF1A\u8FD9\u4E00\u6BB5\u89E3\u91CA\u8FD9\u4E00\u7279\u6B8A\u884C\u4E3A\u7684\u539F\u56E0\u3002 \u63A5\u7740\u7528\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u5047\u8BBE\u6267\u884C make -t\uFF0C\u5BF9\u4E8E subsystem\uFF0Cmake \u4F1A\u7528 touch \u547D\u4EE4\u521B\u5EFA\u6587\u4EF6 subsystem\uFF0C \u800C\u4F60\u5B9E\u9645\u671F\u671B\u7684\u884C\u4E3A\u662F\u6267\u884C cd sub &amp;&amp; make -t\uFF0C\u4F46\u8FD9\u8981\u6C42\u6267\u884C subsystem \u7684 recipe\u3002</p><p>\u7B2C\u4E09\uFF0C\u76F4\u63A5\u4F7F\u7528\u4E86 $(MAKE) \u7684 recipe \u884C\uFF0C\u5F53\u6267\u884C -n\u3001-t\u3001-q \u4E09\u4E2A\u9009\u9879\u7684\u65F6\u5019\uFF0C\u4F1A\u5F97\u5230\u6267\u884C\uFF0C \u540C\u65F6\u901A\u8FC7\u5E38\u89C4\u7684 MAKEFLAGS \u53D8\u91CF\u628A\u8FD9\u4E2A\u5BF9\u5E94\u7684\u9009\u9879\u4F20\u9012\u8FDB\u53BB\uFF0C\u4ECE\u800C\u8FD9\u4E09\u4E2A\u9009\u9879\u4F1A\u6B63\u786E\u4F20\u64AD\u5230 subsystem \u4E2D\u3002</p><p>Q. \u867D\u7136\u4E0D\u91CD\u8981\uFF0C\u4F46\u6211\u60F3\u77E5\u9053\uFF0C\u5728makefile\u4E2D\u624B\u52A8\u5BF9MAKE\u53D8\u91CF\u8D4B\u503C\uFF0C\u4F1A\u6709\u5F71\u54CD\u5417\uFF1F Q. \u518D\u6709\uFF0C\u7C7B\u4F3C MAKE \u8FD9\u6837\u81EA\u52A8\u51FA\u73B0\u7684\u53D8\u91CF\u8FD8\u6709\u54EA\u4E9B\uFF1F</p><h3 id="_5-7-2-\u5411\u5B50-make-\u4F20\u9012\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_5-7-2-\u5411\u5B50-make-\u4F20\u9012\u53D8\u91CF" aria-hidden="true">#</a> 5.7.2 \u5411\u5B50 make \u4F20\u9012\u53D8\u91CF</h3><p>\u9012\u5F52\u8C03\u7528make\u65F6\uFF0C\u4F7F\u7528\u76F8\u5173\u8BED\u53E5\uFF0C\u53EF\u4EE5\u628A\u5F53\u524D\u7684make\u53D8\u91CF\u4F20\u9012\u7ED9\u5B50make\uFF0C\u8FD9\u4E9B\u4F20\u9012\u8FDB\u53BB\u7684\u53D8\u91CF \u5728\u5B50make\u4E2D\u4F5C\u4E3A\u9ED8\u8BA4\u503C\u5B58\u5728\uFF0C\u4F20\u9012\u8FDB\u53BB\u7684\u53D8\u91CF\u4E0D\u4F1A\u8986\u76D6\u5B50make\u4E2D\u5B9A\u4E49\u7684\u540C\u540D\u53D8\u91CF\uFF0C\u9664\u975E\u4F7F\u7528 -e \u9009\u9879\u3002</p><p>\u5BF9\u4E8E\u8981\u5BFC\u51FA/\u5411\u4E0B\u4F20\u9012\u7684\u53D8\u91CF\uFF0Cmake \u5728\u542F\u52A8\u6267\u884C recipe \u884C\u7684\u8FDB\u7A0B\u7684\u65F6\u5019\uFF0C\u628A\u8FD9\u4E9B\u53D8\u91CF\u6DFB\u52A0\u5230 \u5B50\u8FDB\u7A0B\u7684\u7684\u73AF\u5883\u53D8\u91CF\u5217\u8868\u4E2D\uFF0C\u5B50 make \u81EA\u52A8\u4ECE\u73AF\u5883\u53D8\u91CF\u4E2D\u8BFB\u53D6\u8FD9\u4E9B\u53D8\u91CF\u3002</p><p>\u9ED8\u8BA4\uFF0Cmake \u53EA\u5BFC\u51FA\u8FD9\u6837\u7684\u53D8\u91CF\uFF1A\u672C\u5C31\u662F\u6765\u81EA\u73AF\u5883\u53D8\u91CF\u6216\u8005\u7528 -e \u9009\u9879\u5B9A\u4E49\u7684\u53D8\u91CF\uFF0C\u4E14\u53D8\u91CF\u540D\u79F0 \u53EA\u5305\u542B\u6570\u5B57\u5B57\u6BCD\u4E0B\u5212\u7EBF\uFF0C\u56E0\u4E3A\u6709\u4E9Bshell\u53EA\u8BC6\u522B\u6570\u5B57\u5B57\u6BCD\u4E0B\u5212\u7EBF\u6784\u6210\u7684\u73AF\u5883\u53D8\u91CF\u540D\u3002</p><p>make \u53D8\u91CF SHELL \u4E0D\u4F1A\u4F20\u9012\u7ED9\u5B50 sub-make\uFF0C\u800C\u662F\u628A\u8C03\u7528\u8005\u73AF\u5883\u53D8\u91CF\u7684SHELL\u53D8\u91CF\u4F20\u9012\u7ED9sub-make\u3002 \u5982\u679C\u975E\u8981\u628Amake\u53D8\u91CFSHELL\u4F20\u9012\u8FC7\u53BB\uFF0C\u9700\u8981\u4F7F\u7528 export \u6307\u4EE4\uFF08\u89C1\u4E0B\u6587\uFF09\u3002 PS\uFF1Asub-make\u540C\u6837\u4E0D\u4F1A\u4EE5\u73AF\u5883SHELL\u53D8\u91CF\u4F5C\u4E3A\u6267\u884Crecipe\u7684shell\uFF0C\u800C\u662F\u7528make\u53D8\u91CFSHELL\u3002</p><p>make \u53D8\u91CF MAKEFLAGS \u603B\u662F\u4F1A\u5BFC\u51FA\uFF0C\u9664\u975E\u7528 unexport \u6307\u4EE4\u5F3A\u5236\u53D6\u6D88\u3002 make \u53D8\u91CF MAKEFILES\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E86\u5C31\u5BFC\u51FA\uFF0C\u5426\u5219\u4E0D\u5BFC\u51FA\u3002</p><p>Q. \u53D8\u91CF MAKEFLAGS \u5176\u9ED8\u8BA4\u503C\u662F\u4EC0\u4E48\uFF1F Q. \u73AF\u5883\u53D8\u91CF\uFF0Cmakefile\u4E2D\u7684\u53D8\u91CF\uFF0Cmakefile\u4E2D\u7684 recipe \u6267\u884C\u65F6\u7684\u73AF\u5883\u53D8\u91CF\uFF0C\u76F8\u4E92\u5173\u7CFB\u662F\uFF1F Q. \u9664\u4E86\u5BFC\u51FA\u7ED9 sub-make \u7684\uFF0C\u5BFC\u51FA\u7ED9\u6267\u884C recipe line \u7684shell\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\uFF0C\u662F\u4E00\u6837\u7684\u673A\u5236\u5417\uFF1F Q. \u8FD9\u4E2A\u5BFC\u51FA\uFF0C\u5BF9\u4E8E\u975Esub-make\u7684recipe line \u4E5F\u662F\u5982\u6B64\u5417\uFF1F</p><p>make \u81EA\u52A8\u521B\u5EFA\u7684\u9ED8\u8BA4\u53D8\u91CF\u4E00\u822C\u4E0D\u4F1A\u5BFC\u51FA\uFF0Csub-make \u4F1A\u81EA\u52A8\u521B\u5EFA\u81EA\u5DF1\u7684\u9ED8\u8BA4\u53D8\u91CF\u3002 \u53C2\u89C1[Variables Used by Implicit Rules][5:v]</p><p>\u8981\u5BFC\u51FA\u53D8\u91CF\u5230 sub-make\uFF0C\u4F7F\u7528 export \u6307\u4EE4\uFF0C\u8981\u7981\u6B62\u5BFC\u51FA\u53D8\u91CF\u5230 sub-make\uFF0C\u4F7F\u7528 unexport \u6307\u4EE4\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">export</span> variables...
<span class="token keyword">unexport</span> variables...
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u6307\u4EE4\u4E2D\u7684variables\u5217\u8868\u652F\u6301\u5C55\u5F00\uFF0C\u6240\u4EE5\u53EF\u4EE5\u7528\u53D8\u91CF\u3001\u51FD\u6570\uFF0C\u53EA\u8981\u5B83\u4EEC\u7684\u5C55\u5F00\u7ED3\u679C\u662F\u53D8\u91CF\u5217\u8868\u3002</p><p>\u4E3A\u4E86\u65B9\u4FBF\uFF0C\u53EF\u4EE5\u628A\u5B9A\u4E49+\u5BFC\u51FA\u5408\u5E76\u4E3A\u4E00\u6761\u6307\u4EE4</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">export</span> variable<span class="token operator">=</span>value
<span class="token comment"># \u7B49\u4EF7\u4E8E</span>
variable<span class="token operator">=</span>value
<span class="token keyword">export</span> variable
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u7C7B\u4F3C\u7684\u8FD8\u6709</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">export</span> variable<span class="token operator">:=</span>value

variable<span class="token operator">:=</span>value
<span class="token keyword">export</span> variable

<span class="token keyword">export</span> variable<span class="token operator">+=</span>value

variable<span class="token operator">+=</span>value
<span class="token keyword">export</span> variable
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Q. =, :=, +=\uFF0C\u8FD8\u6709\u4EC0\u4E48 = \u7EC4\u5408\uFF1F</p><p>\u53EF\u4EE5\u770B\u5230 make \u4E2D\u7684 export/unexport \u6307\u4EE4\uFF0C\u548C shell\u3001sh \u4E2D\u7684\u8BED\u6CD5\u3001\u8BED\u4E49\u4E00\u81F4\u3002</p><p>\u5355\u72EC\u7684export\u6307\u4EE4\uFF0C\u4F5C\u7528\u662F\u8BA9make\u9ED8\u8BA4\u5BFC\u51FA\u6240\u6709\u53D8\u91CF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token keyword">export</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u4F46\u7528 unexport \u6307\u4EE4\u660E\u786E\u7981\u6B62\u7684\u9664\u5916\u3002\u53D8\u91CF\u540D\u4E2D\u542B\u6709\u6570\u5B57\u5B57\u6BCD\u4E0B\u5212\u7EBF\u4E4B\u5916\u7684\u5B57\u7B26\u7684\u4E5F\u9664\u5916\uFF0C\u9664\u975E \u7528 export \u7279\u610F\u6307\u5B9A\u3002</p><p>\u5355\u72EC\u7684 export \u6307\u4EE4\u7279\u6027\u662F\u4E3A\u4E86\u517C\u5BB9\u65E7\u7248 GNU Make\uFF0C\u5982\u679C\u6709\u4E9B\u73B0\u5B58makefile\u4F9D\u8D56\u6B64\u7279\u6027\uFF0C\u540C\u65F6 \u53C8\u8981\u517C\u5BB9\u65E7\u7248make\u5DE5\u5177\uFF0C\u53EF\u4EE5\u5B9A\u4E49 target <code>.EXPORT_ALL_VARIABLES:</code>\uFF0C\u4EE3\u66FF\u5355\u72EC\u7684export \u6307\u4EE4\uFF0C \u65E7\u7248make\u4F1A\u5FFD\u7565 <code>.EXPORT_ALL_VARIABLES:</code>\uFF0C\u4F46\u9047\u5230\u5355\u72EC\u7684export\u6307\u4EE4\u4F1A\u62A5\u9519\u3002</p><p>\u540C\u7406\uFF0C\u53EF\u4EE5\u7528\u5355\u72EC\u7684 unexport \u6307\u4EE4\u8981\u6C42make\u9ED8\u8BA4\u4E0D\u5BFC\u51FAmake\u53D8\u91CF\u3002\u8FD9\u672C\u5C31\u662F\u9ED8\u8BA4\u884C\u4E3A\uFF0C\u4F46\u53EF\u4EE5 \u7528\u6765\u8986\u76D6\u524D\u9762\u7684\u5355\u72EC export \u6307\u4EE4\u7684\u6548\u679C\uFF08\u6BD4\u5982include\u5F15\u5165\u7684makefile\uFF09\u3002\u540C\u65F6\u6709\u591A\u4E2A\u72EC\u7ACB export\u548Cunexport\u6307\u4EE4\u65F6\uFF0C\u6700\u540E\u7684\u90A3\u4E2A\u751F\u6548\u3002</p><p>\u4F5C\u4E3A\u7279\u4F8B\uFF0C\u53D8\u91CF MAKELEVEL \u6BCF\u8FDB\u5165\u4E00\u5C42\u5D4C\u5957\u7684sub-make\uFF0C\u5176\u503C\u9012\u589E1\uFF0C\u9876\u7EA7make\u4E2D\u6B64\u53D8\u91CF\u7684\u503C\u662F0\u3002 make\u5728\u4E3Arecipe\u8BBE\u7F6E\u73AF\u5883\u7684\u65F6\u5019\u5BF9\u6B64\u53D8\u91CF\u503C\u52A0\u4E00\u3002</p><p>\u8FD9\u4E2A\u53D8\u91CF\u4E3B\u8981\u7528\u4E8E\u5728\u6761\u4EF6\u6307\u4EE4\u4E2D\u6D4B\u8BD5\uFF0C\u4EE5\u4FBF\u4E8E\u533A\u5206\u9012\u5F52\u65B9\u5F0F\u8FD8\u662F\u76F4\u63A5\u8C03\u7528\u7684makefile\u3002</p><p>\u9644\u4E2Ademo\u6D4B\u8BD5\u4E00\u4E0B\uFF0C\u5982\u4E0B\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> Makefile
<span class="token comment"># MAKELEVEL\u7684\u503C</span>
<span class="token variable"><span class="token variable">$(</span>info MAKELEVEL:$<span class="token punctuation">{</span>MAKELEVEL<span class="token punctuation">}</span><span class="token variable">)</span></span>
ml:<span class="token punctuation">;</span> @echo <span class="token variable">\${MAKELEVEL}</span>,$<span class="token variable">\${MAKELEVEL}</span>

$ <span class="token function">make</span> ml
/bin/sh
MAKELEVEL:0
<span class="token number">0,1</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u8FD9\u8868\u660E\uFF0C\u9876\u5C42make\u4E2D\uFF0Cmakefile\u91CC\u6B64\u53D8\u91CF\u7684\u503C\u662F0\uFF0C\u9876\u5C42make\u4E2D\uFF0Crecipe \u7684shell\u8FDB\u7A0B\uFF0C\u6B64\u53D8\u91CF\u7684\u503C\u662F1\u3002</p><p>MAKEFILES \u53D8\u91CF\u4F1A\u81EA\u52A8\u5C42\u5C42\u5411\u5185\u4F20\u9012\uFF0C\u6240\u4EE5\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E\u6B64\u53D8\u91CF\uFF08\u73AF\u5883\u53D8\u91CF\u6216make\u53D8\u91CF\uFF09\u8BA9\u6240\u6709 sub-make \u8F7D\u5165\u5171\u540C\u7684 makefile\u3002</p><p>[5:v]: https://www.gnu.org/software/make/manual/make.html#Implicit-Variables Variables Used by Implicit Rules</p><h3 id="_5-7-3-\u5411\u5B50-make-\u4F20\u9012\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_5-7-3-\u5411\u5B50-make-\u4F20\u9012\u9009\u9879" aria-hidden="true">#</a> 5.7.3 \u5411\u5B50 make \u4F20\u9012\u9009\u9879</h3><p>\u603B\u7ED3:</p><ul><li>\u57FA\u4E8E\u53D8\u91CF\u5BFC\u51FA\u673A\u5236\uFF0C\u501F\u52A9\u53D8\u91CF MAKEFLAGS \u4F20\u9012\u9009\u9879 <ul><li>\u4E0A\u5C42make\u81EA\u52A8\u8BBE\u7F6E\u547D\u4EE4\u884C\u9009\u9879\u5230 MAKEFLAGS \u4E2D\uFF0Csub-make \u81EA\u52A8\u8BFB\u53D6\u6B64\u53D8\u91CF\u4E2D\u7684\u9009\u9879\uFF0C\u5E76\u4E0E\u76F4\u63A5\u5728\u547D\u4EE4\u884C\u4E2D\u6307\u5B9A\u7684\u9009\u9879\u540C\u7B49\u5BF9\u5F85</li><li>\u547D\u4EE4\u624B\u52A8\u6307\u5B9A\u7684\u53D8\u91CF\u5B9A\u4E49\u4E5F\u662F\u901A\u8FC7\u8FD9\u4E2A\u53D8\u91CF\u4F20\u9012\u5230 sub-make \u4E2D</li></ul></li><li>\u6709\u4E9B\u9009\u9879\u4E0D\u4E88\u4F20\u9012\uFF1A-C -f -O -W\uFF1B\u540C\u6837\uFF0Csub-make \u4F1A\u5FFD\u7565\u8FD9\u56DB\u4E2A\u9009\u9879\uFF0C\u53CC\u91CD\u4FDD\u969C</li><li>-j \u9009\u9879\u63A7\u5236\u5E76\u53D1\u4F5C\u4E1A\u7684\u6570\u91CF\uFF0C\u5BF9\u5B83\u505A\u7279\u6B8A\u5904\u7406\uFF0C\u786E\u4FDDmake\u548C\u6240\u6709sub-make\u603B\u7684\u5E76\u53D1\u4F5C\u4E1A\u6570\u91CF\u4E0D\u8D85\u8FC7 -j \u6307\u5B9A\u7684\u503C</li><li>\u9644\uFF1A\u624B\u52A8\u6E05\u7A7A MAKEFLAGS \u53EF\u4EE5\u7981\u6B62\u9009\u9879\u4F20\u9012\uFF0C\u6E05\u7A7A MAKEOVERRIDES \u53EF\u4EE5\u7981\u6B62\u547D\u4EE4\u884C\u53D8\u91CF\u5B9A\u4E49\u4F20\u9012\uFF0C\u540C\u65F6\u4FDD\u7559\u9009\u9879\u7EE7\u7EED\u4F20\u9012</li><li>\u53EF\u4EE5\u624B\u52A8\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF MAKEFLAGS \u6216\u8005\u5728makefile\u4E2D\u624B\u52A8\u8BBE\u7F6EMAKEFLAGS\u53D8\u91CF\uFF0C\u5176\u6307\u5B9A\u7684\u9009\u9879\u4F1A\u9644\u52A0\u5230\u5F53\u524Dmake\u8FDB\u7A0B\u7684\u547D\u4EE4\u884C\u9009\u9879\u5217\u8868\u4E2D Q. \u50CF MAKEFLAGS \u8FD9\u4E9B\u53D8\u91CF\u90FD\u662F\u6B63\u5E38\u7684\u53D8\u91CF\u540D\uFF0C\u4E3A\u4EC0\u4E48 .SHELLFLAGS \u5374\u4EE5\u53E5\u70B9\u5F00\u5934\uFF1F\u8FD9\u6837\u4EE5\u53E5\u70B9\u5F00\u5934\u7684\u7279\u6B8A\u5730\u4F4D\u7684\u53D8\u91CF\u8FD8\u6709\u591A\u5C11\uFF1F</li></ul><p>\u8BF8\u5982 -k\u3001-s \u4E4B\u7C7B\u7684\u9009\u9879\u4F1A\u901A\u8FC7\u53D8\u91CF MAKEFLAGS \u4F20\u9012\u7ED9 sub-make\u3002make \u4F1A\u81EA\u52A8\u628A\u63A5\u6536\u5230\u7684\u547D\u4EE4\u884C \u9009\u9879\u8BBE\u7F6E\u5230\u53D8\u91CF MAKEFLAGS \u4E2D\uFF0C\u4F8B\u5982\u8BBE make -ks\uFF0C\u5219 MAKEFLAGS \u4F1A\u6709\u503C ks\u3002</p><p>\u6BCF\u4E2A sub-make \u90FD\u6709\u73AF\u5883\u53D8\u91CF MAKEFLAGS\uFF0Csub-make \u4F1A\u67E5\u770B\u6B64\u73AF\u5883\u53D8\u91CF\u7684\u503C\uFF0C\u5206\u6790\u5176\u4EE3\u8868\u7684 \u547D\u4EE4\u884C\u53C2\u6570\uFF0C\u901A\u8FC7\u6B64\u53D8\u91CF\u6307\u5B9A\u547D\u4EE4\u884C\u9009\u9879\u4E0E\u76F4\u63A5\u5728\u547D\u4EE4\u884C\u4E2D\u6307\u5B9A\u7684\u9009\u9879\u5177\u5907\u540C\u7B49\u6548\u679C\u3002</p><p>\u4E8E\u6B64\u76F8\u540C\uFF0C\u547D\u4EE4\u884C\u4E2D\u7684\u53D8\u91CF\u5B9A\u4E49\u4E5F\u4F1A\u901A\u8FC7 MAKEFLAGS \u53D8\u91CF\u4F20\u9012\u7ED9 sub-make\uFF0Csub-make \u4F1A\u628A\u6B64 \u53D8\u91CF\u4E2D\u5305\u542B\u7B49\u53F7\uFF08=\uFF09\u7684\u9879\u89E3\u8BFB\u4E3A\u53D8\u91CF\u5B9A\u4E49\uFF0C\u548C\u5728\u547D\u4EE4\u884C\u4E2D\u5B9A\u4E49\u53D8\u91CF\u6548\u679C\u7B49\u540C\u3002</p><p>Q. \u5728shell\u4E2D\u5B9A\u4E49\u73AF\u5883\u53D8\u91CF MAKEFLAGS\uFF0C\u5BF9\u9876\u5C42make\u6709\u6548\u5417\uFF1F Ans\uFF1A\u6709</p><hr><p>make \u4E0D\u4F1A\u628A\u9009\u9879 -C -f -O -W \u8BBE\u7F6E\u5230\u53D8\u91CF MAKEFLAGS \u4E2D\uFF0C\u4E5F\u5C31\u4E0D\u4F1A\u4F20\u9012 sub-make\u3002</p><p>PS\uFF1A\u8BD5\u9A8C\u4E86\u4E00\u4E0B\uFF0C\u624B\u52A8\u628A -C \u8FFD\u52A0\u5230 MAKEFLAGS \u4E2D\uFF0C\u5B50 make \u4E5F\u4F1A\u5FFD\u7565\u4ED6\u3002 PS\uFF1A\u5047\u8BBE MAKEFLAGS \u53D8\u91CF\u4E0D\u662F\u7ED9\u6211\u4EEC\u624B\u52A8\u8C03\u7528\u7684\uFF0C\u800C\u4EC5\u662F make \u548C sub-make \u4E4B\u95F4\u4F20\u9012\u9009\u9879\u7684 \u5A92\u4ECB\uFF0Cmake \u5185\u90E8\u7528\u7684\uFF0C\u90A3\u4E48\uFF1A -f \u6307\u5B9A makefile \u7684\u8DEF\u5F84\uFF0C\u800C\u4E00\u822C\u9012\u5F52make\u8C03\u7528\u4F1A\u6307\u5B9A\u81EA\u5DF1 \u7684makefile\uFF0C\u6240\u4EE5\u4E0D\u7EE7\u627F -f \u9009\u9879\u5408\u7406\u3002</p><p>-j \u9009\u9879\u4E5F\u7279\u6B8A\uFF0C\u5982\u679C -j \u540E\u9762\u660E\u786E\u6307\u5B9A\u4E86\u6B63\u6574\u6570 N\uFF0C\u90A3\u4E48 make \u548C\u6240\u6709 sub-make \u4E4B\u95F4\u4F1A\u4E92\u76F8 \u534F\u8C03\uFF0C\u786E\u4FDD\u6240\u6709 make \u8FDB\u7A0B\u603B\u5171\u53EA\u6709 N \u4E2A\u4F5C\u4E1A\u540C\u65F6\u8FD0\u884C\u3002\u6CE8\u610F\uFF0Cmake \uFF08\u548Csub-make\uFF09\u8FDB\u7A0B\u81EA\u8EAB\u4E0D\u7B97\u4F5C\u4E1A\uFF0C make \u8FDB\u7A0B\u5F00\u542F\u7684\u6267\u884C\u4F5C\u4E1A\uFF08recipe\uFF09\u7684\u5B50\u8FDB\u7A0B\u624D\u7B97\u4F5C\u4E1A\u3002</p><p>\u5982\u679C\u64CD\u4F5C\u7CFB\u7EDF\u4E0D\u652F\u6301\u4E0A\u8FF0\u534F\u5546\uFF0Cmake \u5C31\u4E0D\u4F1A\u628A -j \u9009\u9879\u8BBE\u7F6E\u5230 MAKEFLAGS \u4E2D\uFF0C\u4ECE\u800C sub-make \u4F1A\u987A\u5E8F\u6267\u884C\u4F5C\u4E1A\uFF0C\u5982\u679C\u628A -j \u4F20\u9012\u8FDB\u5165\uFF0C\u6BCF\u4E2A sub-make \u90FD\u4F1A\u6709 N \u4E2A\u5E76\u53D1\u4F5C\u4E1A\uFF0C\u6700\u540E\u5E76\u53D1\u4F5C\u4E1A \u7684\u603B\u6570\u5C31\u4F1A\u8FDC\u8D85 N \u4E2A\uFF08\u6240\u4EE5\u6B64\u65F6\u4E0D\u4F20\u9012 -j \u9009\u9879\u662F\u5408\u7406\u7684\uFF09\u3002\u5982\u679C -j \u540E\u9762\u9762\u6CA1\u6709\u7ED9\u5B9A\u6570\u5B57\uFF0C \u90A3\u4E48\u8868\u793A\u4E0D\u9650\u5236\u5E76\u53D1\u6570\u91CF\uFF0C\u6B64\u65F6 make \u4F1A\u628A -j \u901A\u8FC7 MAKEFLAGS \u4F20\u9012\u7ED9 sub-make \u8FDB\u7A0B\u3002</p><p>\u5982\u679C\u8981\u7981\u6B62\u5411 sub-make \u4F20\u9012\u9009\u9879\uFF0C\u53EF\u4EE5\u624B\u52A8\u6E05\u7A7A MAKEFLAGS \u53D8\u91CF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">subsystem</span><span class="token punctuation">:</span>
    cd subdir &amp;&amp; <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> MAKEFLAGS<span class="token operator">=</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u547D\u4EE4\u884C\u4E2D\u7684\u53D8\u91CF\u5B9A\u4E49\u5B9E\u9645\u5728\u8BB0\u5F55\u5728\u53D8\u91CF MAKEOVERRIDES \u4E2D\uFF0C\u800C MAKEFLAGS \u5F15\u7528\u4E86\u8FD9\u4E2A\u53D8\u91CF\uFF0C \u6240\u4EE5\u5982\u679C\u5E0C\u671B\u53EA\u5411\u4E0B\u4F20\u9012\u9009\u9879\uFF0C\u540C\u65F6\u7981\u6B62\u4F20\u9012\u53D8\u91CF\u5B9A\u4E49\uFF0C\u53EF\u4EE5\u6E05\u7A7A MAKEOVERRIDES \u53D8\u91CF\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>MAKEOVERRIDES<span class="token operator">=</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5F53\u7136\u8FD9\u4E48\u505A\u4E00\u822C\u6CA1\u6709\u4EC0\u4E48\u610F\u4E49\u3002\u6709\u4E9B\u7CFB\u7EDF\u5BF9\u547D\u4EE4\u884C\u957F\u5EA6\u6709\u9650\u5236\uFF0C\u5728\u8FD9\u4E9B\u7CFB\u7EDF\u4E0A\u53EF\u4EE5\u901A\u8FC7\u8FD9\u4E2D\u65B9\u6CD5 \u7F29\u77ED\u547D\u4EE4\u884C\u957F\u5EA6\u3002POSX \u6A21\u5F0F\u4E0B\uFF08\u5B9A\u4E49\u4F2A\u76EE\u6807 <code>.POSIX:</code>\uFF09\uFF0CMAKEFLAGS \u53D8\u91CF\u662F\u4E0D\u53D7 MAKEOVERRIDES \u7684\u5F71\u54CD\u7684\u3002</p><p>MAKEFLAGS \u7684\u524D\u8EAB\u662F MFLAGS\uFF0C\u65E7\u7248\u672C\u7684make\u4F7F\u7528\u7684\u662F MFLAGS\uFF0C\u5E76\u4E14\u4E00\u822C\u8FD9\u4E48\u7528</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">subsystem</span><span class="token punctuation">:</span>
    cd subdir &amp;&amp; <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>MFLAGS<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4E3A\u4FDD\u6301\u517C\u5BB9\u6027\uFF0C\u5F53\u524D\u7684 make \u7248\u672C\uFF0C\u4E5F\u652F\u6301 MFLAGS \u53D8\u91CF\uFF0C\u5B83\u7684\u503C\u548C MAKEFLAGS \u5B8C\u5168\u76F8\u540C\u3002 \u5982\u679C\u5E0C\u671B makefile \u517C\u5BB9\u65E7\u7248make\uFF0C\u5C31\u53EF\u4EE5\u7528\u8FD9\u4E2A\u6280\u672F\uFF0C\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u5728\u65B0\u7248make\u4E2D\u5B8C\u5168\u53EF\u4EE5 \u6B63\u5E38\u8FD0\u884C\u3002</p><p>PS\uFF1A\u65B0\u7248 make \u81EA\u52A8\u8BBE\u7F6E\u3001\u81EA\u52A8\u8BFB\u53D6 MAKEFLAGS \u53D8\u91CF\uFF0C\u66F4\u7701\u4E8B\u3002</p><p>\u5982\u679C\u67D0\u4E9B\u9009\u9879\u9700\u8981\u6BCF\u6B21\u8C03\u7528 make \u547D\u4EE4\u7684\u65F6\u5019\u90FD\u6307\u5B9A\uFF0C\u6BD4\u5982 -k\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF MAKEFLAGS \u6216\u8005\u76F4\u63A5\u5728 makefile \u4E2D\u8BBE\u7F6E\u8FD9\u4E2A\u53D8\u91CF\uFF0C\u8FD9\u4E24\u5904\u8BBE\u7F6E\u7684\u9009\u9879\u90FD\u4F1A\u9644\u52A0\u5230\u5F53\u524Dmake\u547D\u4EE4\u7684\u9009\u9879\u5217\u8868\u4E2D\u3002 \u624B\u52A8\u8BBE\u7F6E MFLAGS \u4E0D\u8D77\u4F5C\u7528\uFF0C\u6B64\u53D8\u91CF\u4EC5\u662F\u4E3A\u4E86\u517C\u5BB9\u65E7\u7248 make\uFF0C\u53EF\u8BFB\uFF0C\u4F46\u5199\u5165\u4E0D\u751F\u6548\u3002</p><p>PS\uFF1A\u5982\u679C\u8BBE\u7F6E\u4E86 make \u53D8\u91CFMAKEFLAGS\uFF0C\u5F53\u524Dmake\u5C31\u4E0D\u4F1A\u6839\u636E\u6700\u7EC8\u547D\u4EE4\u884C\u9009\u9879\u53CD\u8FC7\u6765\u66F4\u65B0\u5F53\u524D\u7684MAKEFLAGS\u53D8\u4E86\uFF1B \u5982\u679C\u6CA1\u6709\u8BBE\u7F6E\uFF0C\u5C31\u4F1A\u53CD\u8FC7\u6765\u66F4\u65B0\u4E00\u6CE2\u3002</p><ul><li>Q. (0001)\u624B\u52A8\u6307\u5B9A\u7684 MAKEFLAGS \u53D8\u91CF\u4E2D\u7684\u9009\u9879\u662F\u4F5C\u4E3A\u9644\u52A0\u9879\u8FD8\u662F\u8986\u76D6\u5176\u503C\u5462\uFF1F Ans\uFF1A\u4F5C\u4E3A\u9644\u52A0\u9009\u9879\u3002</li><li>Q. \u5982\u679C\u5728sub-make\u5BF9\u5E94\u7684makefile\u4E2D\u8BBE\u7F6EMAKEFLAGS\u53D8\u91CF\uFF0C\u4F1A\u4E0D\u4F1A\u5C4F\u853D\u6389\u4E0A\u5C42make\u901A\u8FC7 MAKEFLAGS\u4F20\u9012\u8FDB\u6765\u7684\u9009\u9879\uFF1F\u6216\u8005\u8BF4\uFF0Cmake \u5411sub-make\u4F20\u9012\u9009\u9879\uFF0C\u662F\u901A\u8FC7MAKEFLAGS\u73AF\u5883\u53D8\u91CF \u8FD8\u662F\u901A\u8FC7make\u53D8\u91CFMAKEFLAGS\uFF1F</li></ul><h3 id="_5-7-4-print-directory-\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_5-7-4-print-directory-\u9009\u9879" aria-hidden="true">#</a> 5.7.4 --print-directory \u9009\u9879</h3><p>\u9ED8\u8BA4\u4E0D\u6253\u5370\u3002\u4F7F\u7528 -C \u9009\u9879\u65F6\uFF0C\u9012\u5F52\u8C03\u7528\u65F6\u9ED8\u8BA4\u6253\u5370\u3002\u4F7F\u7528 -w --print-directory \u65F6\u6253\u5370\uFF1B \u4F7F\u7528 --no-print-directory \u7981\u6B62\u6253\u5370\u3002</p><h2 id="_5-8-\u5B9A\u4E49\u5BB9\u5668-recipe" tabindex="-1"><a class="header-anchor" href="#_5-8-\u5B9A\u4E49\u5BB9\u5668-recipe" aria-hidden="true">#</a> 5.8 \u5B9A\u4E49\u5BB9\u5668 recipe</h2><p>\u5982\u679C\u591A\u6B21\u7528\u5230\u540C\u4E00\u4E2A\u547D\u4EE4\u5E8F\u5217\uFF0C\u53EF\u4EE5\u7528\u5BB9\u5668 recipe\u3002 \u5BB9\u5668 recipe \u5B9E\u9645\u4E0A\u662F\u53D8\u91CF\u3002</p><ul><li>\u9012\u5F52\u5C55\u5F00</li><li>\u5BB9\u5668 recipe \u5185\u90E8\u53EF\u4EE5\u81EA\u4E3B\u4F7F\u7528\u7279\u6B8A\u5B57\u7B26(@+0)\uFF1B\u5F15\u7528\u7684\u65F6\u5019\u6574\u4F53\u52A0\u4E00\u4E2A\u7279\u6B8A\u5B57\u7B26\uFF0C\u5BF9\u5BB9\u5668\u5185\u6240\u6709\u884C\u6709\u6548\u3002</li></ul><h2 id="_5-9-\u4F7F\u7528\u7A7A-recipe" tabindex="-1"><a class="header-anchor" href="#_5-9-\u4F7F\u7528\u7A7A-recipe" aria-hidden="true">#</a> 5.9 \u4F7F\u7528\u7A7A recipe</h2><h1 id="_6-\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_6-\u53D8\u91CF" aria-hidden="true">#</a> 6 \u53D8\u91CF</h1><p>\u5F15\u7528\u53D8\u91CF\u7684\u8BED\u6CD5 $(var) \u6216\u8005 \${var} \u90FD\u884C\u3002 \u51FD\u6570\u8C03\u7528\uFF0C$(fun args...) \u6216\u8005 \${fun args..} \u4E5F\u90FD\u884C\u3002</p><h1 id="_9-how-to-run-make" tabindex="-1"><a class="header-anchor" href="#_9-how-to-run-make" aria-hidden="true">#</a> 9. How to Run Make</h1><p>2021-12-21 make \u547D\u4EE4\u7684\u5E38\u7528\u9009\u9879\u3002</p><p>\u540C\u4E00\u4E2A makefile\uFF0C\u642D\u914D\u4E0D\u540C\u7684 make \u547D\u4EE4\u9009\u9879\u73A9\u51FA\u4E0D\u540C\u7684\u6548\u679C\u6765\u3002</p><ul><li>\u6700\u5E38\u7528\u7684\u662F\u66F4\u65B0\u6240\u6709\u8FC7\u65F6\u7684\u6587\u4EF6</li><li>\u53EA\u66F4\u65B0\u7279\u5B9A\u7684\u6587\u4EF6</li><li>\u4F7F\u7528\u4E0D\u540C\u7684\u7F16\u8BD1\u5668\uFF0C\u4F7F\u7528\u4E0D\u540C\u7684\u7F16\u8BD1\u9009\u9879</li></ul><h2 id="_9-1-\u6307\u5B9A-makefile" tabindex="-1"><a class="header-anchor" href="#_9-1-\u6307\u5B9A-makefile" aria-hidden="true">#</a> 9.1 \u6307\u5B9A makefile</h2><p>make \u547D\u4EE4\u9ED8\u8BA4\u4F7F\u7528 <code>Makefile</code> \u4F5C\u4E3A\u6570\u636E\u5E93\u6587\u4EF6\u540D\uFF0C\u53EF\u4EE5\u7528 -f \u6307\u5B9A\u81EA\u5B9A\u4E49\u7684 makefile \u6587\u4EF6\u3002 \u53EF\u4EE5\u591A\u6B21\u6307\u5B9A -f \u9009\u9879\uFF0C\u6307\u5B9A\u7684\u591A\u4E2A makefile \u4F1A\u6309\u7167\u987A\u5E8F\u5408\u5E76\u3002</p><h2 id="_9-2-\u6307\u5B9A-goal" tabindex="-1"><a class="header-anchor" href="#_9-2-\u6307\u5B9A-goal" aria-hidden="true">#</a> 9.2 \u6307\u5B9A goal</h2><blockquote><p>The goals are the targets that make should strive ultimately to update. Other targets are updated as well if they appear as prerequisites of goals, or prerequisites of prerequisites of goals, etc.</p></blockquote><ul><li>make \u547D\u4EE4\u9ED8\u8BA4\u53D6 Makefile \u7684\u7B2C\u4E00\u4E2A target\uFF08\u4E0D\u7B97\u4EE5\u53E5\u70B9\u5F00\u5934\u7684\u76EE\u6807\uFF09\u4F5C\u4E3A goal\u3002</li><li>\u7B2C\u4E00\u6761\u89C4\u5219\u6709\u591A\u4E2A target \u65F6\uFF0C\u53EA\u53D6\u7B2C\u4E00\u4E2A target\uFF0C\u800C\u4E0D\u662F\u6574\u4E2A\u5217\u8868\u4F5C\u4E3A\u9ED8\u8BA4 goal</li><li>\u53EF\u4EE5\u7528 .DEFAULT_GOAL \u53D8\u91CF\u8BBE\u7F6E\u9ED8\u8BA4 goal\u3002 ps\uFF1A\u4E00\u822C\u6CA1\u5FC5\u8981\u5427\u3002 Q. \u8981\u662F\u7B2C\u4E00\u6761\u89C4\u5219\u7684target\u5305\u542B\u901A\u914D\u7B26\u5462\uFF1F Ans\uFF1A\u5C55\u5F00\u540E\u6309\u591A\u4E2A target \u5904\u7406\u3002</li></ul><p>\u4E3A\u6784\u5EFA\u4E0D\u540C\u7684goal\uFF0C\u76F4\u63A5\u628A\u5B83\u4F5C\u4E3A make \u547D\u4EE4\u7684\u4F4D\u7F6E\u53C2\u6570\u4F20\u5165\u5373\u53EF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> main
<span class="token function">make</span> build
<span class="token function">make</span> run
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>makefile \u6587\u4EF6\u4E2D\u7684\u4EFB\u4F55 target \u90FD\u53EF\u4EE5\u4F5C\u4E3A goal \u6307\u5B9A\u7ED9 make \u547D\u4EE4\u3002 \u4F46\u4EE5 - \u6216 = \u5F00\u5934\u7684 target \u4E0D\u884C\uFF0C\u56E0\u4E3A - \u89E3\u91CA\u4E3A\u9009\u9879\uFF0C= \u89E3\u91CA\u4E3A\u53D8\u91CF\u5B9A\u4E49\u3002 \u6CA1\u6709\u5728 makefile \u5217\u51FA\u7684 target \u4E5F\u53EF\u4EE5\u7528\uFF0C\u53EA\u8981\u5B83\u4EEC\u80FD\u4ECE\u9690\u5F0F\u89C4\u5219\u4E2D\u63A8\u5BFC\u51FA\u6765\u3002</p><p>\u53EF\u4EE5\u4E00\u6B21\u6307\u5B9A\u591A\u4E2A goal\uFF0Cmake \u6309\u7167\u987A\u5E8F\u6784\u5EFA\u5B83\u4EEC\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span> clean build <span class="token builtin class-name">test</span> <span class="token function">install</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5728\u547D\u4EE4\u884C\u6307\u5B9A\u7684 goal \u5217\u8868\u53EF\u4EE5\u7528 MAKECMDGOALS \u53D8\u91CF\u8BFB\u53D6\uFF0C\u5982\u679C\u547D\u4EE4\u884C\u672A\u6307\u5B9A\uFF0C\u5219\u6B64\u53D8\u91CF\u4E3A\u7A7A\u3002 \u8FD9\u4E2A\u53D8\u91CF\u5F88\u5C11\u7528\u5230\u3002\u4E00\u4E2A\u5E94\u7528\u573A\u666F\u662F\u6267\u884C clean \u89C4\u5219\u65F6\u907F\u5F00\u5305\u542B .d \u6587\u4EF6\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>sources <span class="token operator">=</span> foo.c bar.c

<span class="token keyword">ifneq</span> <span class="token punctuation">(</span><span class="token variable">$</span><span class="token punctuation">(</span>MAKECMDGOALS<span class="token punctuation">)</span>,clean<span class="token punctuation">)</span>
<span class="token symbol">include <span class="token variable">$</span>(sources</span><span class="token punctuation">:</span>.c<span class="token operator">=</span>.d<span class="token punctuation">)</span>
<span class="token keyword">endif</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_9-3-instead-of-executing-recipes" tabindex="-1"><a class="header-anchor" href="#_9-3-instead-of-executing-recipes" aria-hidden="true">#</a> 9.3 Instead of Executing Recipes</h2><ul><li><p><code>-n --dry-run</code> \u8F93\u51FA\u9700\u8981\u6267\u884C\u7684 recipe\uFF0C\u4E0D\u5B9E\u9645\u6267\u884C\u3002 ps\uFF1A\u6709\u4E9B recipe \u4ECD\u4F1A\u6267\u884C\uFF1A1. MAKE \u53D8\u91CF\uFF0C2. include \u6307\u4EE4</p></li><li><p><code>-t --touch</code> \u53EA\u66F4\u65B0\u76EE\u6807\u6587\u4EF6\u7684\u65F6\u95F4\u6233\uFF0C\u4E0D\u771F\u7684\u6267\u884C recipe</p></li><li><p><code>-q --question</code> \u68C0\u67E5\u662F\u5426\u5B58\u5728\u9700\u8981\u66F4\u65B0\u7684 target\uFF0C\u4E0D\u6267\u884C recipe\u3002\u7528\u9000\u51FA\u7801\u8868\u793A\u662F\u5426\u9700\u8981\u66F4\u65B0\u3002 \u6709\u9700\u8981\u66F4\u65B0\u7684\uFF0C\u9000\u51FA\u7801\u4E3A 1.</p></li><li><p><code>-W file</code> <code>--what-if=file</code> <code>--assume-new=file</code> <code>--new-file=file</code> make \u4F1A\u5F53\u524D\u65F6\u95F4\u4F5C\u4E3A file \u7684\u4FEE\u6539\u65F6\u95F4\uFF08\u800C\u4E0D\u662Ffile\u7684\u5B9E\u9645\u4FEE\u6539\u65F6\u95F4\uFF09\u3002 \u4E0E -n \u9009\u9879\u642D\u914D\uFF0C\u53EF\u4EE5\u5206\u6790\u67D0\u4E2A\u6587\u4EF6\u66F4\u65B0\u540E\uFF0C\u54EA\u4E9B target \u53D7\u5F71\u54CD\u3002</p></li></ul><p>\u540C\u65F6\u4F7F\u7528\u4E0A\u8FF0\u9009\u9879\u4E2D\u7684\u4E09\u4E2A\u4F1A\u62A5\u9519\u3002</p><p>\u5373\u4F7F\u6307\u5B9A\u4E86 -n\u3001-t\u3001-q \u9009\u9879\uFF0C\u4EE5 + \u5F00\u5934\u6216\u8005\u5305\u542B $(MAKE) \u6216 \${MAKE} \u7684recipe\u4E2D\u7684\u884C\u4ECD\u4F1A\u6267\u884C\uFF0C \u6CE8\u610F\uFF0C\u4EC5\u4EC5\u662F\u4EE5 + \u5F00\u5934\u6216\u8005\u5305\u542B $(MAKE) \u6216 \${MAKE} \u90A3\u4E9B\u884C\u4F1A\u6267\u884C\uFF0C\u540C\u4E00\u4E2A\u89C4\u5219\u4E2D\u7684\u5176\u5B83\u884C\u4E0D\u4F1A\u6267\u884C\u3002</p><h2 id="_9-4-\u8DF3\u8FC7\u7F16\u8BD1\u67D0\u4E9B\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_9-4-\u8DF3\u8FC7\u7F16\u8BD1\u67D0\u4E9B\u6587\u4EF6" aria-hidden="true">#</a> 9.4 \u8DF3\u8FC7\u7F16\u8BD1\u67D0\u4E9B\u6587\u4EF6</h2><p>\u6709\u4E9B\u65F6\u5019\uFF0C\u4FEE\u6539\u4E86\u4E00\u4E2A\u6587\u4EF6\uFF0Cmake \u8BA4\u4E3A\u6709\u5176\u5B83\u6587\u4EF6\u9700\u8981\u4FEE\u6539\uFF0C\u800C\u5B9E\u9645\u4E0A\u4E0D\u7528\u4FEE\u6539\uFF0C\u540C\u65F6\u53C8\u4E0D\u5E0C\u671B\u6D6A\u8D39\u65F6\u95F4 \u7F16\u8BD1\u5B83\uFF0C\u53EF\u4EE5\u8DF3\u8FC7\u7F16\u8BD1\u8FD9\u4E9B\u6587\u4EF6\u3002</p><p>\u5B98\u65B9\u624B\u518C\u7ED9\u4E86\u4F8B\u5B50\u548C\u6B65\u9AA4\u2026\u2026\u3002</p><h2 id="_9-5-\u8986\u76D6\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#_9-5-\u8986\u76D6\u53D8\u91CF" aria-hidden="true">#</a> 9.5 \u8986\u76D6\u53D8\u91CF</h2><p>\u53EF\u4EE5\u5728\u547D\u4EE4\u884C\u8986\u76D6 makefile \u4E2D\u7684\u53D8\u91CF\uFF0C\u5F62\u5F0F\u662F <code>var=val</code>\uFF0Cmakefile\u4E2D\u6240\u6709\u5BF9 var \u53D8\u91CF\u7684\u8D4B\u503C\u8BED\u53E5\u90FD\u4F1A\u88AB\u5FFD\u7565\uFF0C\u5E76 \u79F0\u201C\u547D\u4EE4\u884C\u53C2\u6570\u8986\u76D6\u4E86makefile\u4E2D\u7684\u53D8\u91CF\u201D\u3002</p><p>\u6700\u5E38\u89C1\u7684\u7528\u9014\u662F\u4E3A C \u7F16\u8BD1\u5668\u6307\u5B9A\u989D\u5916\u7684\u7F16\u8BD1\u9009\u9879\u3002\u5982\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>CFLAGS<span class="token operator">=</span>-g

<span class="token symbol">foo</span><span class="token punctuation">:</span> foo.c
    cc -c <span class="token variable">$</span><span class="token punctuation">(</span>CFLAGS<span class="token punctuation">)</span> foo.c -o foo
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>make CFLAGS=&#39;-g -O&#39; foo</code>.</p><p>\u547D\u4EE4\u884C\uFF0C\u8FD9\u79CD\u5F62\u5F0F\u5B9A\u4E49\u7684\u53D8\u91CF <code>val=val</code> \u662F\u9012\u5F52\u5C55\u5F00\u7684\uFF0C\u82E5\u8981\u5B9A\u4E49\u7B80\u5355\u5C55\u5F00\u7684\u53D8\u91CF\uFF0C\u4F7F\u7528 := \u6216 ::= \u4EE3\u66FF =\u3002 \u9664\u975E\u5728 val \u4E2D\u5F15\u7528\u5176\u5B83\u53D8\u91CF\u6216\u8005\u51FD\u6570\u8C03\u7528\uFF0C\u5426\u5219\u7B80\u5355\u5C55\u5F00\u548C\u9012\u5F52\u5C55\u5F00\u662F\u6CA1\u6709\u533A\u522B\u7684\u3002</p><p>makefile\u4E2D\u7684 override \u6307\u4EE4\u53EF\u4EE5\u53CD\u8FC7\u6765\u8986\u76D6\u547D\u4EE4\u884C\u4E2D\u5B9A\u4E49\u7684\u53D8\u91CF\u3002 <code>override variable = value</code>.</p><h2 id="_9-6-\u6D4B\u8BD5\u7F16\u8BD1\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_9-6-\u6D4B\u8BD5\u7F16\u8BD1\u8FC7\u7A0B" aria-hidden="true">#</a> 9.6 \u6D4B\u8BD5\u7F16\u8BD1\u8FC7\u7A0B</h2><p>\u5F53\u6267\u884C recipe \u51FA\u9519\u65F6\uFF0Cmake \u7ACB\u5373\u62A5\u9519\u9000\u51FA\u3002 \u4F46\u5982\u679C\u4F60\u521A\u521A\u4FEE\u6539\u4E86\u4E00\u4E2A\u6587\u4EF6\uFF0C\u5E0C\u671Bmake\u7EE7\u7EED\u7F16\u8BD1\uFF0C\u4EE5\u5C3D\u53EF\u80FD\u591A\u5730\u53D1\u73B0\u5B58\u5728\u7684\u95EE\u9898\uFF0C\u8FD9\u65F6\u5019 \u53EF\u4EE5\u7528 -k --keep-going \u9009\u9879\u3002</p><blockquote><p>On these occasions, you should use the \u2018-k\u2019 or \u2018--keep-going\u2019 flag. This tells make to continue to consider the other prerequisites of the pending targets, remaking them if necessary, before it gives up and returns nonzero status. For example, after an error in compiling one object file, \u2018make -k\u2019 will continue compiling other object files even though it already knows that linking them will be impossible.</p></blockquote><p>\u901A\u5E38\uFF0C\u8C03\u7528 make \u7684\u76EE\u7684\u662F\u6784\u9020 goal\uFF0Cmake \u4EE5\u6B64\u4E3A\u524D\u63D0\uFF0C\u9047\u5230\u9519\u8BEF\u7ACB\u5373\u62A5\u9519\u9000\u51FA\u662F\u6B63\u786E\u7684\u3002 -k \u9009\u9879\u5219\u544A\u8BC9 make\uFF0C\u771F\u6B63\u7684\u76EE\u7684\u662F\u4E3A\u4E86\u5C3D\u53EF\u80FD\u591A\u5730\u68C0\u6D4B\u4EE3\u7801\u9519\u8BEF\uFF0C\u6240\u4EE5\u6B64\u65F6 make \u4F1A\u5C3D\u53EF\u80FD\u5730 \u7EE7\u7EED\u6267\u884C\u4E0B\u53BB\u3002</p><h2 id="_9-7-\u9009\u9879\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#_9-7-\u9009\u9879\u603B\u7ED3" aria-hidden="true">#</a> 9.7 \u9009\u9879\u603B\u7ED3</h2><p>make \u547D\u4EE4\u7684\u5269\u4F59\u9009\u9879\u5728\u8FD9\u4E00\u7AE0\u8282\u5217\u51FA\u3002</p><ul><li><p><code>-j [N] --jobs[=N]</code> \u6307\u5B9A\u5E76\u53D1\u8FD0\u884C\u7684 recipe \u6570\u91CF\u3002\u7701\u7565\u6570\u5B57\uFF0C\u5219\u80FD\u5E76\u884C\u591A\u5C11\u5C31\u5E76\u884C\u591A\u5C11\u3002</p></li><li><p><code>-O[type] --output-sync[=type]</code> \u786E\u4FDD\u6BCF\u4E2A recipe \u7684\u8F93\u51FA\u4E0D\u88AB\u5176\u5B83\u8F93\u51FA\u6253\u4E71\u3002\u6B64\u9009\u9879\u4EC5\u548C --jobs \u9009\u9879\u642D\u914D\u65F6\u624D\u6709\u5FC5\u8981\u3002 type \u7684\u53EF\u53D6\u503C\u6709 line\u3001target\u3001recurse\u3001none\u3002target \u662F\u7F3A\u7701\u503C\uFF0C\u8868\u793A\u4E00\u4E2A recipe \u5185\u7684\u6240\u6709\u8F93\u51FA\u4FDD\u6301\u4E00\u7EC4\u3002</p></li><li><p><code>-l [load] --load-average[=load] --max-load[=load]</code> \u5F53\u5DF2\u7ECF\u6709\u5176\u5B83 recipe \u8FD0\u884C\u4E14\u7CFB\u7EDF\u8D1F\u8F7D\u5927\u4E8E\u7B49\u4E8E load \u65F6\uFF0C\u4E0D\u5728\u8FD0\u884C\u65B0\u7684 recipe\u3002\u4E0E --jobs \u642D\u914D\u3002 \u7701\u7565 load\uFF0C\u8868\u793A\u4E0D\u9650\u5236\u3002load \u662F\u4E00\u4E2A\u6D6E\u70B9\u6570\u3002</p></li><li><p><code>-r --no-builtin-rules</code> \u5FFD\u7565\u5185\u7F6E\u9690\u5F0F\u89C4\u5219</p></li><li><p><code>-R --no-builtin-variables</code> \u5FFD\u7565\u7279\u5B9A\u4E8E\u5185\u7F6E\u9690\u5F0F\u89C4\u5219\u7684\u53D8\u91CF\uFF0C\u6B64\u9009\u9879\u9690\u542B -r \u9009\u9879</p></li><li><p><code>-B --always-make</code> \u5FFD\u7565\u65B0\u65E7\u5173\u7CFB\uFF0C\u65E0\u6761\u4EF6\u91CD\u65B0\u6784\u5EFA\u6240\u6709\u76F8\u5173 target</p></li><li><p><code>-C dir</code> \u5207\u6362\u5230 dir \u76EE\u5F55\u4E0B\u518D\u8BFB\u53D6 makefile\u3002<code>make -C foo -C bar</code> \u6548\u679C\u7C7B\u4F3C\u4E8E <code>cd foo &amp;&amp; cd bar &amp;&amp; make</code></p></li><li><p><code>-d</code> \u7B49\u4EF7\u4E8E --debug=a\uFF0C\u8F93\u51FA\u8C03\u8BD5\u4FE1\u606F\u3002\u5305\u62EC\uFF1A\u8981\u68C0\u67E5\u54EA\u4E2A\u6587\u4EF6\u3001\u68C0\u67E5\u7ED3\u679C\u662F\u4EC0\u4E48\u3001\u54EA\u4E2A\u6587\u4EF6\u6700\u7EC8\u8981 remade\uFF0C\u5C1D\u8BD5\u4E86\u54EA\u4E2A\u9690\u5F0F\u89C4\u5219\uFF0C\u6700\u7EC8\u54EA\u4E2A\u9690\u5F0F\u89C4\u5219\u7528\u4E0A\u4E86\uFF0C\u7B49\u7B49\u3002</p><blockquote><p>Print debugging information in addition to normal processing. The debugging information says which files are being considered for remaking, which file-times are being compared and with what results, which files actually need to be remade, which implicit rules are considered and which are applied\u2014everything interesting about how make decides what to do. The -d option is equivalent to \u2018--debug=a\u2019</p></blockquote></li><li><p><code>--debug</code> \u8F93\u51FA\u6307\u5B9A\u7EA7\u522B\u7684\u8C03\u8BD5\u4FE1\u606F\u3002\u6307\u5B9A\u7684\u503C\u53EA\u8003\u8651\u7B2C\u4E00\u4E2A\u5B57\u7B26\uFF0C\u4E14\u8981\u7528\u9017\u53F7\u6216\u7A7A\u767D\u5206\u9694</p><ul><li>a(all) \u6240\u6709\u8C03\u8BD5\u4FE1\u606F\u3002\u7B49\u4EF7\u4E8E -d</li><li>b(basic) \u6307\u5B9A --debug \u65F6\u7684\u9ED8\u8BA4\u9009\u9879\u3002\u57FA\u7840debug\u4FE1\u606F\u5305\u62EC\uFF1A\u54EA\u4E2Atarget\u8FC7\u671F\u4E86\uFF0C\u6784\u5EFA\u7ED3\u679C\u662F\u6210\u529F\u8FD8\u662F\u5931\u8D25\u3002</li><li>v(verbose) \u5728 basic \u7684\u57FA\u7840\u4E0A\uFF0C\u8F93\u51FA\u5982\u4E0B\u4FE1\u606F\uFF1A\u8BFB\u53D6\u4E86\u54EA\u4E2Amakefile\uFF0C\u54EA\u4E2A prerequisite \u4E0D\u9700\u8981\u91CD\u5EFA\uFF08rebuild\uFF09\uFF0C\u7B49\u3002</li><li>i(implicit) \u5728 basic \u7684\u57FA\u7840\u4E0A\uFF0C\u8F93\u51FA\u9690\u5F0F\u89C4\u5219\u7684\u641C\u7D22\u8FC7\u7A0B</li><li>j(jobs) \u8F93\u51FA sub-commands \u7684\u8C03\u7528\u7EC6\u8282\u3002ps\uFF1A\u4E0D\u662F\u5728basic\u7684\u57FA\u7840\u4E0A\uFF1BQ. sub-command \u83AB\u975E\u662F\u6307\u9012\u5F52 make \u8C03\u7528?</li><li>m(makefile) \u5728 basic \u7684\u57FA\u7840\u4E0A\uFF0C\u8F93\u51FA remake makefile \u7684\u4FE1\u606F\uFF1B\u6CE8\u610F\uFF0Call \u9009\u9879\u4E0D\u5305\u62EC\u8FD9\u4E00\u4E2A\u4FE1\u606F</li><li>n(none) \u5173\u95ED\u5230\u5F53\u524D\u4F4D\u7F6E\u7684\u8C03\u8BD5\u4FE1\u606F\uFF0C\u540E\u7EED\u518D\u6709\u8C03\u8BD5\u4FE1\u606F\u9009\u9879\uFF0C\u90A3\u4E9B\u9009\u9879\u4F1A\u751F\u6548</li></ul></li></ul><h1 id="_10-using-implicit-rules" tabindex="-1"><a class="header-anchor" href="#_10-using-implicit-rules" aria-hidden="true">#</a> 10 Using Implicit Rules</h1><p>\u6709\u4E9B\u6784\u5EFA\u89C4\u5219\u4F7F\u7528\u9891\u7387\u5F88\u9AD8\uFF0C\u6BD4\u5982\u7528 cc \u628A .c \u7F16\u8BD1\u6210 .o\u3002 \u6839\u636E\u6587\u4EF6\u540D\u9009\u62E9\u5BF9\u5E94\u7684\u9690\u5F0F\u89C4\u5219\u3002 \u9690\u5F0F\u89C4\u5219\u53EF\u4EE5\u6309\u987A\u5E8F\u94FE\u5F0F\u8C03\u7528\uFF0C\u6BD4\u5982 .y -&gt; .c -&gt; .o \u6587\u4EF6\u3002</p><p>\u5185\u7F6E\u7684\u9690\u5F0F\u89C4\u5219\uFF0C\u5176recipe\u4F7F\u7528\u4E00\u4E9B\u53D8\u91CF\uFF0C\u5982\u6B64\u4FBF\u53EF\u901A\u8FC7\u8BBE\u7F6E\u53D8\u91CF\u7684\u503C\u5B9A\u5236\u9690\u5F0F\u89C4\u5219\u7684\u5DE5\u4F5C\u65B9\u5F0F\u3002 \u6BD4\u5982\uFF0C\u5728\u7F16\u8BD1C\u7A0B\u5E8F\u7684\u65F6\u5019\uFF0CCLFAGS \u53EF\u9690\u5F0F\u89C4\u5219\u4F20\u9012\u7ED9C\u7F16\u8BD1\u5668\u7684 flags \u53C2\u6570\u3002</p><p>\u8FD8\u53EF\u4EE5\u901A\u8FC7\u6A21\u5F0F\u89C4\u5219(pattern rules)\u81EA\u5B9A\u4E49\u9690\u5F0F\u89C4\u5219\u3002</p><p>\u540E\u7F00\u89C4\u5219\u662F\u4E00\u79CD\u66F4\u53D7\u9650\u7684\u9690\u5F0F\u89C4\u5219\u5B9A\u4E49\u65B9\u6CD5\uFF0C\u4EC5\u4E3A\u4E86\u540E\u5411\u517C\u5BB9\u6027\u3002 Suffix rules are a more limited way to define implicit rules. Pattern rules are more general and clearer, but suffix rules are retained for compatibility.</p><ul><li>\u2022 Using Implicit How to use an existing implicit rule to get the recipes for updating a file.</li><li>\u2022 Catalogue of Rules A list of built-in rules.</li><li>\u2022 Implicit Variables How to change what predefined rules do.</li><li>\u2022 Chained Rules How to use a chain of implicit rules.</li><li>\u2022 Pattern Rules How to define new implicit rules.</li><li>\u2022 Last Resort How to define a recipe for rules which cannot find any.</li><li>\u2022 Suffix Rules The old-fashioned style of implicit rule.</li><li>\u2022 Implicit Rule Search The precise algorithm for applying implicit rules.</li></ul><h2 id="_10-1-using-implicit-rules" tabindex="-1"><a class="header-anchor" href="#_10-1-using-implicit-rules" aria-hidden="true">#</a> 10.1 Using Implicit Rules</h2><p>\u53EA\u8981\u4E0D\u6307\u5B9Arecipe\uFF0Cmake\u547D\u4EE4\u5C31\u4F1A\u5C1D\u8BD5\u67E5\u627E\u9002\u5F53\u7684\u9690\u5F0F\u89C4\u5219\u3002 make \u6839\u636E\u73B0\u5B58\u7684\u6216\u8005\u53EF\u4EE5\u751F\u6210\u7684\u6E90\u6587\u4EF6\u7684\u7C7B\u578B\u786E\u5B9A\u8981\u4F7F\u7528\u54EA\u6761\u9690\u5F0F\u89C4\u5219\u3002 To allow make to find a customary method for updating a target file, all you have to do is refrain from specifying recipes yourself. Either write a rule with no recipe, or don\u2019t write a rule at all. Then make will figure out which implicit rule to use based on which kind of source file exists or can be made.</p><p>\u5047\u8BBE\u6709\u5982\u4E0Bmakefile\uFF0C\u4F60\u5728\u89C4\u5219\u4E2D\u63D0\u5230\u4E86 foo.o \u4F46\u662F\u6CA1\u6709\u7ED9\u51FA\u4EE5 foo.o \u4E3A\u76EE\u6807\u7684\u89C4\u5219\uFF0C\u90A3\u4E48 make \u5C31\u4F1A\u67E5\u627E\u5408\u9002\u7684\u9690\u5F0F\u89C4\u5219\u751F\u6210foo.o\uFF0C\u65E0\u8BBAfoo.o\u662F\u5426\u5DF2\u7ECF\u5B58\u5728\u3002 \u5982\u679C\u627E\u5230\u4E86\u5339\u914D\u7684\u9690\u5F0F\u89C4\u5219\uFF0C\u6B64\u89C4\u5219\u53EF\u4EE5\u540C\u65F6\u63D0\u4F9B\u4E00\u4E2Arecipe\u548C\u4E00\u4E2A\u6216\u4EE5\u4E0A\u7684\u524D\u7F6E\u6761\u4EF6\u3002 \u5982\u679C\u9700\u8981\u6307\u5B9A\u989D\u5916\u7684\u4F9D\u8D56\uFF08\u6BD4\u5982\u5934\u6587\u4EF6\uFF09\uFF0C\u4F60\u53EF\u4EE5\u5199\u4E00\u6761\u4E0D\u5E26\u6709 recipe\u7684 \u4EE5 foo.o \u4E3A\u76EE\u6807\u7684\u89C4\u5219\u3002 For example, suppose the makefile looks like this:</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>foo : foo.o bar.o
        cc -o foo foo.o bar.o $(CFLAGS) $(LDFLAGS)
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Because you mention foo.o but do not give a rule for it, make will automatically look for an implicit rule that tells how to update it. This happens whether or not the file foo.o currently exists.</p><p>If an implicit rule is found, it can supply both a recipe and one or more prerequisites (the source files). You would want to write a rule for foo.o with no recipe if you need to specify additional prerequisites, such as header files, that the implicit rule cannot supply.</p><p>\u6BCF\u4E2A\u9690\u5F0F\u89C4\u5219\u90FD\u6709\u4E00\u4E2A\u76EE\u6807\u6A21\u5F0F\u548C\u524D\u7F6E\u6761\u4EF6\u6A21\u5F0F\u3002\u53EF\u4EE5\u540C\u65F6\u5B58\u5728\u591A\u4E2A\u76EE\u6807\u6A21\u5F0F\u76F8\u540C\u7684\u9690\u5F0F\u89C4\u5219\uFF0C \u53EA\u8981\u4ED6\u4EEC\u7684\u524D\u7F6E\u6761\u4EF6\u4E0D\u540C\uFF0C\u8FD9\u65F6\uFF0C\u54EA\u4E2A\u9690\u5F0F\u89C4\u5219\u7684\u524D\u7F6E\u6761\u4EF6\u5B58\u5728\u6216\u8005\u53EF\u4EE5\u751F\u6210\uFF0Cmake\u5C31\u9009\u62E9\u54EA\u6761 \u9690\u5F0F\u89C4\u5219\u3002 Each implicit rule has a target pattern and prerequisite patterns. There may be many implicit rules with the same target pattern. For example, numerous rules make \u2018.o\u2019 files: one, from a \u2018.c\u2019 file with the C compiler; another, from a \u2018.p\u2019 file with the Pascal compiler; and so on. The rule that actually applies is the one whose prerequisites exist or can be made. So, if you have a file foo.c, make will run the C compiler; otherwise, if you have a file foo.p, make will run the Pascal compiler; and so on.</p><p>\u81EA\u7136\uFF0C\u5F53\u4F60\u7F16\u5199makefile\u7684\u65F6\u5019\uFF0C\u4F60\u77E5\u9053\u81EA\u5DF1\u5E0C\u671B\u54EA\u6761\u89C4\u5219\u751F\u6548\uFF0C\u4F60\u77E5\u9053make\u4F1A\u9009\u62E9\u8FD9\u6761\u89C4\u5219\uFF0C \u56E0\u4E3A\u4F60\u77E5\u9053\u8FD9\u6761\u89C4\u5219\u7684\u524D\u7F6E\u6761\u4EF6\u9884\u671F\u4F1A\u5B58\u5728\u3002 Of course, when you write the makefile, you know which implicit rule you want make to use, and you know it will choose that one because you know which possible prerequisite files are supposed to exist. See Catalogue of Built-In Rules, for a catalogue of all the predefined implicit rules.</p><p>\u6211\u4EEC\u8BF4\u67D0\u4F9D\u8D56\u201C\u5B58\u5728\u6216\u53EF\u4EE5\u751F\u6210\u201D\uFF0C\u6587\u4EF6\u201C\u53EF\u4EE5\u751F\u6210\u201D\u7684\u542B\u4E49\u662F\uFF0C\u8BE5\u6587\u4EF6\u662F\u67D0\u6761\u663E\u5F0F\u89C4\u5219\u7684target\u6216 \u4F9D\u8D56\uFF0C\u6216\u8005\u53EF\u4EE5\u627E\u5230\u67D0\u6761\u80FD\u751F\u6210\u6B64\u6587\u4EF6\u7684\u9690\u5F0F\u89C4\u5219\u3002 \u5F53\u67D0\u6761\u9690\u5F0F\u89C4\u5219\u7684\u4F9D\u8D56\u662F\u53E6\u4E00\u4E2A\u9690\u5F0F\u89C4\u5219\u7684target\u65F6\uFF0C\u79F0\u51FA\u73B0\u4E86\u94FE\u5F0F\u89C4\u5219\u3002 Above, we said an implicit rule applies if the required prerequisites \u201Cexist or can be made\u201D. A file \u201Ccan be made\u201D if it is mentioned explicitly in the makefile as a target or a prerequisite, or if an implicit rule can be recursively found for how to make it. When an implicit prerequisite is the result of another implicit rule, we say that chaining is occurring. See Chains of Implicit Rules.</p><p>make \u4F1A\u4E3A\u6BCF\u4E2A\u672A\u6307\u5B9Arecipe\u7684target\u4EE5\u53CA\u672A\u6307\u5B9Arecipe\u7684\u53CC\u5192\u53F7\u89C4\u5219\u641C\u7D22\u9690\u5F0F\u6761\u4EF6\u3002 \u4EC5\u4F5C\u4E3A\u4F9D\u8D56\u51FA\u73B0\u7684\u6587\u4EF6\u4F1A\u88AB\u89C6\u4F5C\u4E00\u6761\u65E0\u4EFB\u4F55\u5185\u5BB9\u7684\u89C4\u5219\u7684target\uFF0C\u6240\u4EE5makek\u4E5F\u4F1A\u4E3A\u8FD9\u7C7B\u6587\u4EF6\u641C\u7D22 \u9690\u5F0F\u89C4\u5219\u3002 ps\uFF1A\u5408\u8D77\u6765\u5C31\u662F\uFF0Cmake\u4F1A\u4E3A\u6BCF\u4E2A\u65E0 recipe\u7684target\uFF08\u5305\u62EC\u4EC5\u4F5C\u4E3A\u4F9D\u8D56\u51FA\u73B0\u7684\u6587\u4EF6\uFF09\u641C\u7D22\u9690\u5F0F\u89C4\u5219\u3002</p><p>In general, make searches for an implicit rule for each target, and for each double-colon rule, that has no recipe. A file that is mentioned only as a prerequisite is considered a target whose rule specifies nothing, so implicit rule search happens for it. See Implicit Rule Search Algorithm, for the details of how the search is done.</p><p>\u9690\u5F0F\u89C4\u5219\u7684\u9009\u62E9\u4E0D\u53D7\u663E\u5F0F\u4F9D\u8D56\u7684\u5F71\u54CD\uFF0C\u6BD4\u5982\u5982\u4E0Bmakefile\u4E2D\uFF0C\u5982\u679C\u540C\u65F6\u5B58\u5728 foo.c \u548C foo.p,\u5219 \u4ECD\u65E7\u4F18\u5148\u4F7F\u7528 foo.c \u751F\u6210 foo.o,\u56E0\u4E3A\u4F7F\u7528 C \u7684\u9690\u5F0F\u89C4\u5219\u5728\u4F7F\u7528 Pascal \u7684\u9690\u5F0F\u89C4\u5219\u7684\u987A\u5E8F\u66F4 \u9760\u524D\u3002 Note that explicit prerequisites do not influence implicit rule search. For example, consider this explicit rule:</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>foo.o: foo.p
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>The prerequisite on foo.p does not necessarily mean that make will remake foo.o according to the implicit rule to make an object file, a .o file, from a Pascal source file, a .p file. For example, if foo.c also exists, the implicit rule to make an object file from a C source file is used instead, because it appears before the Pascal rule in the list of predefined implicit rules (see Catalogue of Built-In Rules).</p><p>\u5BF9\u4E8E\u6CA1\u6709 recipe \u7684 target \u4F7F\u7528\u9690\u5F0F\u89C4\u5219\uFF0C\u53EF\u4EE5\u5199\u4E00\u6761\u89C4\u5219\uFF0C\u4E3A\u8BE5target\u63D0\u4F9B\u4E00\u4E2A\u7A7Arecipe\u3002 ps:\u7A7Arecipe\u5C31\u662F\u53EA\u6709\u4E00\u4E2A\u5206\u53F7\u7684recipe\uFF0C\u5982\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">foo</span><span class="token punctuation">:</span>
    <span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>If you do not want an implicit rule to be used for a target that has no recipe, you can give that target an empty recipe by writing a semicolon (see Defining Empty Recipes).</p><h2 id="_10-2-catalogue-of-built-in-rules" tabindex="-1"><a class="header-anchor" href="#_10-2-catalogue-of-built-in-rules" aria-hidden="true">#</a> 10.2 Catalogue of Built-In Rules</h2><p>\u5185\u7F6E\u9690\u5F0F\u89C4\u5219\u603B\u662F\u6709\u7684\uFF0C\u9664\u975E\u660E\u786E\u8986\u76D6\u6216\u8005\u53D6\u6D88\u4ED6\u4EEC\u3002 \uFF08-r --no-builtin-rules\u53D6\u6D88\u6240\u6709\u5185\u7F6E\u89C4\u5219\uFF09\u3002 ps\uFF1A\u5185\u7F6E\u89C4\u5219\uFF0C\u90FD\u662F\u9690\u5F0F\u89C4\u5219\u3002</p><p>\u4E0D\u540C\u5E73\u53F0\u3001\u4E0D\u540C\u7248\u672C\u7684make\uFF0C\u5176\u5185\u7F6E\u7684\u9690\u5F0F\u89C4\u5219\u4E0D\u5B8C\u5168\u4E00\u81F4\uFF0C\u5728\u4E00\u4E2A\u4E0D\u5305\u542Bmakefile\u7684\u76EE\u5F55\u4E0B\u6267\u884C <code>make -p</code>\u547D\u4EE4\uFF0C\u53EF\u4EE5\u67E5\u770B\u5F53\u524Dmake\u5DE5\u5177\u5B9E\u9645\u7684\u5185\u7F6E\u89C4\u5219\u548C\u53D8\u91CF\u3002 \u672C\u624B\u518C\u5217\u51FA\u7684\u5185\u7F6E\u89C4\u5219\u5728\u57FA\u4E8E POSIX \u7684\u7CFB\u7EDF\u4E0A\u53EF\u7528\u3002</p><p>\u5373\u4F7F\u4E0D\u6307\u5B9A -r \u9009\u9879\uFF0C\u4E5F\u4E0D\u662F\u6240\u6709\u7684\u5185\u7F6E\u89C4\u5219\u90FD\u603B\u662F\u53EF\u7528\u7684\u3002 \u5728make\u5185\u90E8\uFF0C\u8FD9\u91CC\u7684\u9690\u5F0F\u89C4\u5219\uFF0C\u6709\u4E0D\u5C11\u662F\u901A\u8FC7 suffix rule \u5B9E\u73B0\u7684\uFF0C\u6240\u4EE5\u5B83\u4EEC\u5230\u65F6\u5019\u662F\u5426\u751F\u6548\uFF0C \u8FD8\u8981\u53D7\u5230 suffix list \u7684\u5F71\u54CD\uFF0C\u53EF\u4EE5\u901A\u8FC7 .SUFFIXES \u8FD9\u4E2A\u7279\u6B8A\u7684target\u63A7\u5236 suffix list\u3002 ps\uFF1Asuffix rule \u662F\u65E7\u98CE\u683C\uFF0C\u5B83\u7684\u7EE7\u4EFB\u8005\u5C31\u662F\u66F4\u5F3A\u5065\u7684\u6A21\u5F0F\u89C4\u5219\uFF08pattern rule\uFF09\u3002</p><ul><li><p>\u7F16\u8BD1C\u7A0B\u5E8F\uFF1A %.o: %.c $(CC) $(CPPFLAGS) $(CFLAGS) -c</p></li><li><p>\u7F16\u8BD1C++\u7A0B\u5E8F\uFF1A %.o: %.cc %.cpp %.C $(CXX) $(CPPFLAGS) $(CXXFLAGS) -c</p></li><li><p>\u7F16\u8BD1 Pascal</p></li><li><p>\u7F16\u8BD1 Fortran</p></li><li><p>\u9884\u5904\u7406Fortran</p></li><li><p>\u7F16\u8BD1 Modula-2</p></li><li><p>\u6C47\u7F16\u548C\u9884\u5904\u7406\u6C47\u7F16\u7A0B\u5E8F %.o:%.s $(AS) $(ASFLAGS) %.s:%.S $(CPP) $(CPPFLAGS)</p></li><li><p>\u94FE\u63A5\u5355\u4E2A\u5BF9\u8C61\u6587\u4EF6 %: %.o $(CC) $(LDFLAGS) %.o $(LOADLIBS) $(LDLIBS)</p><p>\u8FD9\u6761\u89C4\u5219\u5BF9\u4E8E\u7B80\u5355\u60C5\u51B5\u6709\u6548\uFF0C\u590D\u6742\u7684\u60C5\u51B5\u5C31\u8981\u624B\u52A8\u7F16\u5199\u94FE\u63A5\u89C4\u5219\u3002</p></li><li><p>\u9488\u5BF9C\u7A0B\u5E8F\u7684yacc %.c: %.y $(YACC) $(YFLAGS) ...</p></li></ul><p>\u901A\u5E38\uFF0C\u4F60\u53EA\u9700\u8981\u4FEE\u6539\u4E0A\u8FF0\u9690\u5F0F\u89C4\u5219\u4E2D\u4F7F\u7528\u7684\u5185\u7F6E\u53D8\u91CF\u5373\u53EF\u3002</p><p>\u5B9E\u9645\u4E0A\uFF0C\u5185\u7F6E\u89C4\u5219\u5B9E\u9645\u4F7F\u7528\u7684\u53D8\u91CF\u7C7B\u4F3C\u4E8E COMPILE.c, LINK.c\uFF0C\u5B83\u4EEC\u4FDD\u5B58\u4E86\u4E0A\u8FF0\u5217\u51FA\u7684recpie\u3002 \u7528\u4E8E\u7F16\u8BD1 .x \u6E90\u6587\u4EF6\u7684\u9690\u5F0F\u89C4\u5219\u4F7F\u7528\u53D8\u91CF COMPILE.x\uFF0C\u4EE5\u53CA\u7528\u4E8E\u4ECE .x \u751F\u6210\u53EF\u6267\u884C\u6587\u4EF6\u7684\u5185\u7F6E\u89C4\u5219 \u4F7F\u7528\u53D8\u91CF LINK.x\uFF0C\u9884\u5904\u7406 .x \u6587\u4EF6\u7684\u5185\u7F6E\u89C4\u5219\u4F7F\u7528\u53D8\u91CF PREPROCESS.x\u3002</p><p>\u5173\u4E8E\u751F\u6210 .o \u6587\u4EF6\u7684\u5185\u7F6E\u89C4\u5219\uFF0C\u548COUTPUT_OPTION\uFF0C\u4EE5\u53CA\u5728\u67D0\u4E9B\u7CFB\u7EDF\u4E0A\u7684tricky\u3002 Every rule that produces an object file uses the variable OUTPUT_OPTION. make defines this variable either to contain \u2018-o $@\u2019, or to be empty, depending on a compile-time option. You need the \u2018-o\u2019 option to ensure that the output goes into the right file when the source file is in a different directory, as when using VPATH (see Directory Search). However, compilers on some systems do not accept a \u2018-o\u2019 switch for object files. If you use such a system, and use VPATH, some compilations will put their output in the wrong place. A possible workaround for this problem is to give OUTPUT_OPTION the value \u2018; mv $*.o $@\u2019.</p><h2 id="_10-3-variables-used-by-implicit-rules" tabindex="-1"><a class="header-anchor" href="#_10-3-variables-used-by-implicit-rules" aria-hidden="true">#</a> 10.3 Variables Used by Implicit Rules</h2><ol><li>\u5185\u7F6E\u89C4\u5219\u4F7F\u7528\u4E86\u5185\u7F6E\u53D8\u91CF\uFF0C\u53EF\u4EE5\u5728makefile\u4E2D\u4FEE\u6539\u8FD9\u4E9B\u5185\u7F6E\u53D8\u91CF\u7684\u503C\uFF0C\u4ECE\u800C\u5B9A\u5236\u5185\u7F6E\u89C4\u5219\u7684\u884C\u4E3A\u3002</li><li>\u4F7F\u7528 -R --no-builtin-variables \u9009\u9879\u53D6\u6D88\u6240\u6709\u5185\u7F6E\u53D8\u91CF\u7684\u5B9A\u4E49</li><li>\u5185\u7F6E\u89C4\u5219\u4F7F\u7528\u7684\u5185\u7F6E\u53D8\u91CF\u53EF\u4EE5\u5206\u6210\u4E24\u7C7B\uFF1B\u4E00\u7C7B\u6307\u5B9A\u7F16\u8BD1\u5DE5\u5177\uFF0C\u4E00\u7C7B\u6307\u5B9A\u7F16\u8BD1\u9009\u9879\u3002</li><li>\u624B\u518C\u5217\u51FA\u4E86\u6700\u5E38\u7528\u7684\u5185\u7F6E\u53D8\u91CF\u3002</li></ol><h2 id="_10-4-\u9690\u5F0F\u89C4\u5219\u7684\u94FE\u5F0F\u8C03\u7528" tabindex="-1"><a class="header-anchor" href="#_10-4-\u9690\u5F0F\u89C4\u5219\u7684\u94FE\u5F0F\u8C03\u7528" aria-hidden="true">#</a> 10.4 \u9690\u5F0F\u89C4\u5219\u7684\u94FE\u5F0F\u8C03\u7528</h2><p>Chains of Implicit Rules</p><p>make\u8DB3\u591F\u806A\u660E\uFF0C\u80FD\u591F\u5224\u65AD\u51FA\u662F\u5426\u9700\u8981\u94FE\u5F0F\u4F7F\u7528\u9690\u5F0F\u89C4\u5219\u3002\u6BD4\u5982 .y -&gt; .c -&gt; .o\u3002 Sometimes a file can be made by a sequence of implicit rules. For example, a file n.o could be made from n.y by running first Yacc and then cc. Such a sequence is called a chain.</p><p>If the file n.c exists, or is mentioned in the makefile, no special searching is required: make finds that the object file can be made by C compilation from n.c; later on, when considering how to make n.c, the rule for running Yacc is used. Ultimately both n.c and n.o are updated.</p><p>However, even if n.c does not exist and is not mentioned, make knows how to envision it as the missing link between n.o and n.y! In this case, n.c is called an intermediate file. Once make has decided to use the intermediate file, it is entered in the data base as if it had been mentioned in the makefile, along with the implicit rule that says how to create it.</p><p>Intermediate files are remade using their rules just like all other files. But intermediate files are treated differently in two ways.</p><p>\u94FE\u5F0F\u4F7F\u7528\u9690\u5F0F\u89C4\u5219\uFF0C\u63D0\u5230\u201C\u4E2D\u95F4\u6587\u4EF6\u201D\uFF0C\u5B83\u6709\u4E24\u4E2A\u4E0D\u540C\u4E8E\u666E\u901A\u6587\u4EF6\u7684\u5730\u65B9\uFF1A</p><ol><li>\u5BF9\u66F4\u65B0\u7684\u5F71\u54CD</li><li>make \u7528\u540E\u81EA\u52A8\u5220\u9664 The first difference is what happens if the intermediate file does not exist. If an ordinary file b does not exist, and make considers a target that depends on b, it invariably creates b and then updates the target from b. But if b is an intermediate file, then make can leave well enough alone. It won\u2019t bother updating b, or the ultimate target, unless some prerequisite of b is newer than that target or there is some other reason to update that target.</li></ol><p>The second difference is that if make does create b in order to update something else, it deletes b later on after it is no longer needed. Therefore, an intermediate file which did not exist before make also does not exist after make. make reports the deletion to you by printing a \u2018rm -f\u2019 command showing which file it is deleting.</p><p>\u4E2D\u95F4\u6587\u4EF6\uFF0C\u663E\u5F0F\u89C4\u5219\u7684target\u6216\u4F9D\u8D56\u4E0D\u53EF\u4F5C\u4E3A\u4E2D\u95F4\u6587\u4EF6\u3002\u9664\u975E\u4F60\u8981\u6C42make\u8FD9\u4E48\u505A\u3002 Ordinarily, a file cannot be intermediate if it is mentioned in the makefile as a target or prerequisite. However, you can explicitly mark a file as intermediate by listing it as a prerequisite of the special target .INTERMEDIATE. This takes effect even if the file is mentioned explicitly in some other way. \u4F60\u53EF\u4EE5\u8981\u6C42\u4FDD\u7559\u751F\u6210\u7684\u4E2D\u5EFA\u6587\u4EF6\u3002 You can prevent automatic deletion of an intermediate file by marking it as a secondary file. To do this, list it as a prerequisite of the special target .SECONDARY. When a file is secondary, make will not create the file merely because it does not already exist, but make does not automatically delete the file. Marking a file as secondary also marks it as intermediate.</p><p>You can list the target pattern of an implicit rule (such as \u2018%.o\u2019) as a prerequisite of the special target .PRECIOUS to preserve intermediate files made by implicit rules whose target patterns match that file\u2019s name; see Interrupts.</p><p>\u9690\u5F0F\u89C4\u5219\u94FE\u53EF\u4EE5\u5305\u542B\u4E24\u4E2A\u4EE5\u4E0A\u7684\u9690\u5F0F\u89C4\u5219\u3002 A chain can involve more than two implicit rules. For example, it is possible to make a file foo from RCS/foo.y,v by running RCS, Yacc and cc. Then both foo.y and foo.c are intermediate files that are deleted at the end.</p><p>\u4F46\u4E00\u4E2A\u94FE\u4E2D\uFF0C\u4E00\u4E2A\u9690\u5F0F\u89C4\u5219\u81F3\u591A\u51FA\u73B0\u4E00\u6B21\uFF0C\u8FD9\u662F\u4E3A\u4E86\u907F\u5F00\u6B7B\u5FAA\u73AF\u3002 No single implicit rule can appear more than once in a chain. This means that make will not even consider such a ridiculous thing as making foo from foo.o.o by running the linker twice. This constraint has the added benefit of preventing any infinite loop in the search for an implicit rule chain.</p><p>\u6709\u4E9B\u4F18\u5316\uFF0C\u6BD4\u5982\u4ECE foo.c \u751F\u6210 foo \u53EF\u4EE5\u5148\u751F\u6210 .o \u518D\u94FE\u63A5\u6210 foo\uFF0C\u4E5F\u53EF\u4EE5\u4E00\u6B65\u5230\u4F4D\uFF0C\u4E3A\u4E86\u6548\u7387\uFF0C make \u4F1A\u9009\u62E9\u4E00\u6B65\u5230\u4F4D\uFF0C\u8FD9\u79CD\u9009\u62E9\u901A\u8FC7\u5185\u7F6E\u89C4\u5219\u7684\u987A\u5E8F\u5B9E\u73B0\u7684\u3002 There are some special implicit rules to optimize certain cases that would otherwise be handled by rule chains. For example, making foo from foo.c could be handled by compiling and linking with separate chained rules, using foo.o as an intermediate file. But what actually happens is that a special rule for this case does the compilation and linking with a single cc command. The optimized rule is used in preference to the step-by-step chain because it comes earlier in the ordering of rules.</p><p>\u8003\u8651\u6548\u7387\uFF0C\u641C\u7D22\u6784\u5EFA\u9690\u5F0F\u89C4\u5219\u7684\u4F9D\u8D56\u65F6\uFF0C\u4E0D\u4F1A\u8003\u8651\u975E\u5C3E\u8282\u70B9\u7684 &quot;%:&quot; \u7684\u9690\u5F0F\u89C4\u5219\uFF0C\u56E0\u4E3A % \u6CA1\u6709\u4EFB\u4F55\u666E\u901A\u5B57\u7B26\uFF0C\u5B83 \u5339\u914D\u4E00\u5207\u4E1C\u897F\uFF0C\u5339\u914D\u7684\u592A\u8FC7\u5BBD\u6CDB\u4E86\u3002 Finally, for performance reasons make will not consider non-terminal match-anything rules (i.e., \u2018%:\u2019) when searching for a rule to build a prerequisite of an implicit rule (see Match-Anything Rules).</p><h2 id="_10-5-\u81EA\u5B9A\u4E49\u548C\u91CD\u65B0\u5B9A\u4E49\u6A21\u5F0F\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_10-5-\u81EA\u5B9A\u4E49\u548C\u91CD\u65B0\u5B9A\u4E49\u6A21\u5F0F\u89C4\u5219" aria-hidden="true">#</a> 10.5 \u81EA\u5B9A\u4E49\u548C\u91CD\u65B0\u5B9A\u4E49\u6A21\u5F0F\u89C4\u5219</h2><p>Defining and Redefining Pattern Rules</p><ol><li>\u5199\u4E00\u6761\u6A21\u5F0F\u89C4\u5219\uFF0C\u5C31\u5B9E\u73B0\u4E86\u5B9A\u4E49\u4E00\u6761\u9690\u5F0F\u89C4\u5219\u3002</li><li>\u9690\u5F0F\u89C4\u5219\u7684target\u6709\u4E14\u4EC5\u6709\u4E00\u4E2A %, \u5B83\u662F\u4E2A\u901A\u914D\u7B26\uFF0C\u53EF\u4EE5\u5339\u914D\u4EFB\u4F55\u975E\u7A7A\u5B57\u7B26\u4E32\u3002% \u5339\u914D\u7684\u5B50\u4E32 \u53EB\u505A\u679D\u5E72\uFF08stem\uFF09\u3002</li><li>pattern \u4E2D\u7684 % \u7684\u5C55\u5F00\uFF0C\u662F\u5728\u53D8\u91CF\u66FF\u6362\u548C\u51FD\u6570\u6267\u884C\u4E4B\u540E\u8FDB\u884C\u7684\u3002 You define an implicit rule by writing a pattern rule. A pattern rule looks like an ordinary rule, except that its target contains the character \u2018%\u2019 (exactly one of them). The target is considered a pattern for matching file names; the \u2018%\u2019 can match any nonempty substring, while other characters match only themselves. The prerequisites likewise use \u2018%\u2019 to show how their names relate to the target name.</li></ol><p>Thus, a pattern rule \u2018%.o : %.c\u2019 says how to make any file stem.o from another file stem.c.</p><p>Note that expansion using \u2018%\u2019 in pattern rules occurs after any variable or function expansions, which take place when the makefile is read. See How to Use Variables, and Functions for Transforming Text.</p><ul><li>\u2022 Pattern Intro An introduction to pattern rules.</li><li>\u2022 Pattern Examples Examples of pattern rules.</li><li>\u2022 Automatic Variables How to use automatic variables in the recipe of implicit rules.</li><li>\u2022 Pattern Match How patterns match.</li><li>\u2022 Match-Anything Rules Precautions you should take prior to defining rules that can match any target file whatever.</li><li>\u2022 Canceling Rules How to override or cancel built-in rules.</li></ul><h3 id="_10-5-1-introduction-to-pattern-rules" tabindex="-1"><a class="header-anchor" href="#_10-5-1-introduction-to-pattern-rules" aria-hidden="true">#</a> 10.5.1 Introduction to Pattern Rules</h3><p>A pattern rule contains the character \u2018%\u2019 (exactly one of them) in the target; otherwise, it looks exactly like an ordinary rule. The target is a pattern for matching file names; the \u2018%\u2019 matches any nonempty substring, while other characters match only themselves.</p><p>\u6A21\u5F0F\u89C4\u5219\u4E2D\uFF0Ctarget\u4E2D\u7684 % \u5339\u914D\u5230\u7684\u5B57\u7B26\u4E32\u53EB\u505A\u679D\u5E72\u3002 For example, \u2018%.c\u2019 as a pattern matches any file name that ends in \u2018.c\u2019. \u2018s.%.c\u2019 as a pattern matches any file name that starts with \u2018s.\u2019, ends in \u2018.c\u2019 and is at least five characters long. (There must be at least one character to match the \u2018%\u2019.) The substring that the \u2018%\u2019 matches is called the stem.</p><p>\u4F9D\u8D56\u4E2D\u7684 % \u4EE3\u8868\u540C\u6837\u7684\u679D\u5E72\u3002 \u6A21\u5F0F\u89C4\u5219\u751F\u6548\u7684\u524D\u63D0\u662F\uFF1A\u8BE5\u89C4\u5219\u7684target\u80FD\u5339\u914D\u5230\u67D0\u4E2A\u6587\u4EF6\uFF0C\u4E14\u89C4\u5219\u7684\u4F9D\u8D56\uFF08\u5C06%\u66FF\u6362\u6210\u5BF9\u5E94\u7684 \u5B50\u4E32\u4E4B\u540E\uFF09\u5FC5\u987B\u662F\u5DF2\u5B58\u5728\u6587\u4EF6\u6216\u662F\u53EF\u4EE5\u751F\u6210\u7684\u6587\u4EF6\u3002 \u2018%\u2019 in a prerequisite of a pattern rule stands for the same stem that was matched by the \u2018%\u2019 in the target. In order for the pattern rule to apply, its target pattern must match the file name under consideration and all of its prerequisites (after pattern substitution) must name files that exist or can be made. These files become prerequisites of the target.</p><p>Thus, a rule of the form</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol">%.o</span> <span class="token punctuation">:</span> %.c <span class="token punctuation">;</span> recipe\u2026
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>specifies how to make a file n.o, with another file n.c as its prerequisite, provided that n.c exists or can be made.</p><p>\u6A21\u5F0F\u89C4\u5219\u7684\u4F9D\u8D56\u4E2D\u53EF\u4EE5\u4E0D\u4F7F\u7528 %\uFF0C\u5C11\u6570\u60C5\u5F62\u4E0B\uFF0C\u9700\u8981\u7528\u8FD9\u79CD\u5199\u6CD5\u3002 There may also be prerequisites that do not use \u2018%\u2019; such a prerequisite attaches to every file made by this pattern rule. These unvarying prerequisites are useful occasionally.</p><p>\u6A21\u5F0F\u89C4\u5219\u751A\u81F3\u53EF\u4EE5\u4E0D\u4E66\u5199\u4EFB\u4F55\u4F9D\u8D56\uFF0C\u8FD9\u65F6\u7684\u6A21\u5F0F\u89C4\u5219\u5176\u5B9E\u5C31\u662F\u4E00\u4E2A\u4E07\u80FD\u7EDF\u914D\u89C4\u5219\uFF0C\u5B83\u5339\u914D\u4EFB\u4F55\u7B26\u5408 target\u6A21\u5F0F\u7684\u6587\u4EF6\u3002\u53C2\u8003 Last Resort. A pattern rule need not have any prerequisites that contain \u2018%\u2019, or in fact any prerequisites at all. Such a rule is effectively a general wildcard. It provides a way to make any file that matches the target pattern. See Last Resort.</p><h3 id="_10-5-2-pattern-rule-examples" tabindex="-1"><a class="header-anchor" href="#_10-5-2-pattern-rule-examples" aria-hidden="true">#</a> 10.5.2 Pattern Rule Examples</h3><p>Here are some examples of pattern rules actually predefined in make. First, the rule that compiles \u2018.c\u2019 files into \u2018.o\u2019 files:</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>%.o : %.c
        $(CC) -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>defines a rule that can make any file x.o from x.c. The recipe uses the automatic variables \u2018$@\u2019 and \u2018$&lt;\u2019 to substitute the names of the target file and the source file in each case where the rule applies (see Automatic Variables).</p><p>Here is a second built-in rule:</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>% :: RCS/%,v
        $(CO) $(COFLAGS) $&lt;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>defines a rule that can make any file x whatsoever from a corresponding file x,v in the sub-directory RCS. Since the target is \u2018%\u2019, this rule will apply to any file whatever, provided the appropriate prerequisite file exists. The double colon makes the rule terminal, which means that its prerequisite may not be an intermediate file (see Match-Anything Pattern Rules).</p><p>This pattern rule has two targets:</p><div class="language-make ext-make line-numbers-mode"><pre class="language-make"><code>%.tab.c %.tab.h: %.y
        bison -d $&lt;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This tells make that the recipe \u2018bison -d x.y\u2019 will make both x.tab.c and x.tab.h. If the file foo depends on the files parse.tab.o and scan.o and the file scan.o depends on the file parse.tab.h, when parse.y is changed, the recipe \u2018bison -d parse.y\u2019 will be executed only once, and the prerequisites of both parse.tab.o and scan.o will be satisfied. (Presumably the file parse.tab.o will be recompiled from parse.tab.c and the file scan.o from scan.c, while foo is linked from parse.tab.o, scan.o, and its other prerequisites, and it will execute happily ever after.)</p><h3 id="_10-5-3-automatic-variables" tabindex="-1"><a class="header-anchor" href="#_10-5-3-automatic-variables" aria-hidden="true">#</a> 10.5.3 Automatic Variables</h3><p>\u4E3A\u89E3\u51B3\u6A21\u5F0F\u89C4\u5219\u4E2D\u7684recipe\u4E2D\uFF0C\u6307\u5B9A\u52A8\u6001\u6587\u4EF6\u540D\u7684\u95EE\u9898\uFF0Cmake \u521B\u5EFA\u4E86\u52A8\u6001\u53D8\u91CF\u3002 \u52A8\u6001\u53D8\u91CF\u4EC5\u9650\u4E8Erecipe\u4E2D\u6709\u6548\uFF0C\u4E0D\u8981\u5728target\u548Cprerequisite\u4E2D\u4F7F\u7528\uFF08\u672A\u5B9A\u4E49\uFF0C \u4F1A\u6269\u5C55\u4E3A\u7A7A\u4E32\uFF09\u3002 Suppose you are writing a pattern rule to compile a \u2018.c\u2019 file into a \u2018.o\u2019 file: how do you write the \u2018cc\u2019 command so that it operates on the right source file name? You cannot write the name in the recipe, because the name is different each time the implicit rule is applied.</p><p>What you do is use a special feature of make, the automatic variables. These variables have values computed afresh for each rule that is executed, based on the target and prerequisites of the rule. In this example, you would use \u2018$@\u2019 for the object file name and \u2018$&lt;\u2019 for the source file name.</p><p>It\u2019s very important that you recognize the limited scope in which automatic variable values are available: they only have values within the recipe. In particular, you cannot use them anywhere within the target list of a rule; they have no value there and will expand to the empty string. Also, they cannot be accessed directly within the prerequisite list of a rule. A common mistake is attempting to use $@ within the prerequisites list; this will not work. However, there is a special feature of GNU make, secondary expansion (see Secondary Expansion), which will allow automatic variable values to be used in prerequisite lists.</p><p>\u81EA\u52A8\u53D8\u91CF\u6E05\u5355\uFF0C\u8FD8\u662F\u6709\u51E0\u4E2A\u7684\u3002\u9009\u51E0\u4E2A\u5E38\u7528\u7684\u3002</p><ul><li><p>$@: target</p></li><li><p>$&lt;: first prerequisite</p></li><li><p>$^: all prerequisite</p></li><li><p>$%, %? $@</p><p>The file name of the target of the rule. If the target is an archive member, then \u2018$@\u2019 is the name of the archive file. In a pattern rule that has multiple targets (see Introduction to Pattern Rules), \u2018$@\u2019 is the name of whichever target caused the rule\u2019s recipe to be run. $%</p><p>The target member name, when the target is an archive member. See Archives. For example, if the target is foo.a(bar.o) then \u2018$%\u2019 is bar.o and \u2018$@\u2019 is foo.a. \u2018$%\u2019 is empty when the target is not an archive member. $&lt;</p><p>The name of the first prerequisite. If the target got its recipe from an implicit rule, this will be the first prerequisite added by the implicit rule (see Implicit Rules). $?</p><p>The names of all the prerequisites that are newer than the target, with spaces between them. If the target does not exist, all prerequisites will be included. For prerequisites which are archive members, only the named member is used (see Archives). $^</p><p>The names of all the prerequisites, with spaces between them. For prerequisites which are archive members, only the named member is used (see Archives). A target has only one prerequisite on each other file it depends on, no matter how many times each file is listed as a prerequisite. So if you list a prerequisite more than once for a target, the value of $^ contains just one copy of the name. This list does not contain any of the order-only prerequisites; for those see the \u2018$|\u2019 variable, below. $+</p><p>This is like \u2018$^\u2019, but prerequisites listed more than once are duplicated in the order they were listed in the makefile. This is primarily useful for use in linking commands where it is meaningful to repeat library file names in a particular order. $|</p><p>The names of all the order-only prerequisites, with spaces between them. $*</p><p>The stem with which an implicit rule matches (see How Patterns Match). If the target is dir/a.foo.b and the target pattern is a.%.b then the stem is dir/foo. The stem is useful for constructing names of related files.</p><p>In a static pattern rule, the stem is part of the file name that matched the \u2018%\u2019 in the target pattern.</p><p>In an explicit rule, there is no stem; so \u2018$<em>\u2019 cannot be determined in that way. Instead, if the target name ends with a recognized suffix (see Old-Fashioned Suffix Rules), \u2018$</em>\u2019 is set to the target name minus the suffix. For example, if the target name is \u2018foo.c\u2019, then \u2018$<em>\u2019 is set to \u2018foo\u2019, since \u2018.c\u2019 is a suffix. GNU make does this bizarre thing only for compatibility with other implementations of make. You should generally avoid using \u2018$</em>\u2019 except in implicit rules or static pattern rules.</p><p>If the target name in an explicit rule does not end with a recognized suffix, \u2018$*\u2019 is set to the empty string for that rule.</p></li></ul><p>\u2018$?\u2019 is useful even in explicit rules when you wish to operate on only the prerequisites that have changed. For example, suppose that an archive named lib is supposed to contain copies of several object files. This rule copies just the changed object files into the archive:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>lib: foo.o bar.o lose.o win.o
        ar r lib $?
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Of the variables listed above, four have values that are single file names, and three have values that are lists of file names. These seven have variants that get just the file\u2019s directory name or just the file name within the directory. The variant variables\u2019 names are formed by appending \u2018D\u2019 or \u2018F\u2019, respectively. The functions dir and notdir can be used to obtain a similar effect (see Functions for File Names). Note, however, that the \u2018D\u2019 variants all omit the trailing slash which always appears in the output of the dir function. Here is a table of the variants:</p><p>\u2018$(@D)\u2019</p><pre><code>The directory part of the file name of the target, with the trailing slash removed. If the value of \u2018$@\u2019 is dir/foo.o then \u2018$(@D)\u2019 is dir. This value is . if \u2018$@\u2019 does not contain a slash.
</code></pre><p>\u2018$(@F)\u2019</p><pre><code>The file-within-directory part of the file name of the target. If the value of \u2018$@\u2019 is dir/foo.o then \u2018$(@F)\u2019 is foo.o. \u2018$(@F)\u2019 is equivalent to \u2018$(notdir $@)\u2019.
</code></pre><p>\u2018$(*D)\u2019 \u2018$(*F)\u2019</p><pre><code>The directory part and the file-within-directory part of the stem; dir and foo in this example.
</code></pre><p>\u2018$(%D)\u2019 \u2018$(%F)\u2019</p><pre><code>The directory part and the file-within-directory part of the target archive member name. This makes sense only for archive member targets of the form archive(member) and is useful only when member may contain a directory name. (See Archive Members as Targets.)
</code></pre><p>\u2018$(&lt;D)\u2019 \u2018$(&lt;F)\u2019</p><pre><code>The directory part and the file-within-directory part of the first prerequisite.
</code></pre><p>\u2018$(^D)\u2019 \u2018$(^F)\u2019</p><pre><code>Lists of the directory parts and the file-within-directory parts of all prerequisites.
</code></pre><p>\u2018$(+D)\u2019 \u2018$(+F)\u2019</p><pre><code>Lists of the directory parts and the file-within-directory parts of all prerequisites, including multiple instances of duplicated prerequisites.
</code></pre><p>\u2018$(?D)\u2019 \u2018$(?F)\u2019</p><pre><code>Lists of the directory parts and the file-within-directory parts of all prerequisites that are newer than the target.
</code></pre><p>Note that we use a special stylistic convention when we talk about these automatic variables; we write \u201Cthe value of \u2018$&lt;\u2019\u201D, rather than \u201Cthe variable &lt;\u201D as we would write for ordinary variables such as objects and CFLAGS. We think this convention looks more natural in this special case. Please do not assume it has a deep significance; \u2018$&lt;\u2019 refers to the variable named &lt; just as \u2018$(CFLAGS)\u2019 refers to the variable named CFLAGS. You could just as well use \u2018$(&lt;)\u2019 in place of \u2018$&lt;\u2019.</p><h3 id="_10-5-4-how-patterns-match" tabindex="-1"><a class="header-anchor" href="#_10-5-4-how-patterns-match" aria-hidden="true">#</a> 10.5.4 How Patterns Match</h3><p>\u76EE\u6807\u6A21\u5F0F\u7531\u4E00\u4E2A%\u548C\u53EF\u9009\u7684\u524D\u540E\u7F00\u6784\u6210\uFF0C\u4E00\u4E2A\u6A21\u5F0F\u53EF\u4EE5\u5339\u914D\u7ED9\u5B9A\u7684\u6587\u4EF6\u540D\u4EC5\u5F53\u8BE5\u6587\u4EF6\u540D\u4EE5\u6A21\u5F0F\u7684\u524D\u7F00 \u5F00\u5934\uFF0C\u4EE5\u6A21\u5F0F\u7684\u540E\u7F00\u7ED3\u5C3E\uFF1B\u5339\u914D\u6210\u529F\u540E\uFF0C\u524D\u540E\u7F00\u4E4B\u95F4\u7684\u90E8\u5206\u53EB\u505A\u4E3B\u5E72\uFF08stem\uFF09\u3002\u6BD4\u5982 %.o \u5339\u914D test.o \u65F6\uFF0C\u4E3B\u5E72\u5C31\u662F test\u3002\u7136\u540E\u89C4\u5219\u7684\u4F9D\u8D56\u4E2D\uFF0C%\u66FF\u6362\u4E3A\u4E3B\u5E72\uFF0C\u4EE5\u83B7\u5F97\u5B9E\u9645\u7684\u4F9D\u8D56\u3002 \u6BD4\u5982 <code>%.o: %.c ;</code> \u5339\u914D test.o \u65F6\uFF0C\u5B83\u7684\u4F9D\u8D56\u5C31\u662F test.c\u3002 A target pattern is composed of a \u2018%\u2019 between a prefix and a suffix, either or both of which may be empty. The pattern matches a file name only if the file name starts with the prefix and ends with the suffix, without overlap. The text between the prefix and the suffix is called the stem. Thus, when the pattern \u2018%.o\u2019 matches the file name test.o, the stem is \u2018test\u2019. The pattern rule prerequisites are turned into actual file names by substituting the stem for the character \u2018%\u2019. Thus, if in the same example one of the prerequisites is written as \u2018%.c\u2019, it expands to \u2018test.c\u2019.</p><p>\u76EE\u6807\u6A21\u5F0F\u4E00\u822C\u4E0D\u542B\u659C\u6746\uFF0C\u4F46\u540C\u6837\u53EF\u4EE5\u5339\u914D\u542B\u4E49\u659C\u6760\u7684\u8DEF\u5F84\u540D\u3002</p><ul><li>\u5339\u914D\u7684\u65F6\u5019\u53EA\u5BF9\u6587\u4EF6\u7684basename\u8FDB\u884C\u5339\u914D\uFF0C</li><li>\u66FF\u6362\u4F9D\u8D56\u4E2D\u7684%\u7684\u65F6\u5019\uFF0C\u76EE\u5F55\u4F1A\u4F5C\u4E3A\u524D\u7F00\uFF0C\u653E\u5728\u7ED3\u679C\u4E0A\u3002 Q. \u76EE\u6807\u6A21\u5F0F\u542B\u6709\u659C\u6760\u5462\uFF1F <code>e%t: c%r</code> \u5339\u914D\u6587\u4EF6 src/eat\uFF0Cstem \u662F src/a, \u5BF9 c%r \u66FF\u6362\u5F97\u5230\u5B9E\u9645\u4F9D\u8D56\u662F src/car. \u539F\u6587\u5982\u4E0B\uFF1A</li></ul><blockquote><p>When the target pattern does not contain a slash (and it usually does not), directory names in the file names are removed from the file name before it is compared with the target prefix and suffix. After the comparison of the file name to the target pattern, the directory names, along with the slash that ends them, are added on to the prerequisite file names generated from the pattern rule\u2019s prerequisite patterns and the file name. The directories are ignored only for the purpose of finding an implicit rule to use, not in the application of that rule. Thus, \u2018e%t\u2019 matches the file name src/eat, with \u2018src/a\u2019 as the stem. When prerequisites are turned into file names, the directories from the stem are added at the front, while the rest of the stem is substituted for the \u2018%\u2019. The stem \u2018src/a\u2019 with a prerequisite pattern \u2018c%r\u2019 gives the file name src/car.</p></blockquote><p>\u4EC5\u5F53\u5339\u914D\u5B83\u65F6\u5019\uFF0C\u5185\u7F6E\u89C4\u5219\u624D\u4F1A\u8D77\u6548\u3002 \u663E\u5F0F\u4E66\u5199\u7684\u89C4\u5219\u4F18\u5148\u4E8E\u5185\u7F6E\u89C4\u5219\u3002 \u6CE8\u610F\uFF0C\u5982\u679C\u4E00\u4E2A\u89C4\u5219 R \u7684\u4F9D\u8D56\u9879\u5B9E\u9645\u5B58\u5728\uFF0C\u6216\u8005\u6709\u663E\u5F0F\u63CF\u8FF0\uFF0C\u90A3\u4E48\u89C4\u5219 R \u7684\u4F18\u5148\u7EA7\u9AD8\u4E8E\u5FC5\u987B\u501F\u7531 \u94FE\u5F0F\u9690\u5F0F\u89C4\u5219\u624D\u80FD\u751F\u6210\u4F9D\u8D56\u9879\u7684\u89C4\u5219\u3002</p><p>A pattern rule can be used to build a given file only if there is a target pattern that matches the file name, and all prerequisites in that rule either exist or can be built. The rules you write take precedence over those that are built in. Note however, that a rule whose prerequisites actually exist or are mentioned always takes priority over a rule with prerequisites that must be made by chaining other implicit rules.</p><p>Q. \u4E0D\u80FD\u767D\u8FD9\u4E2A\u201CNote however\u201D\u8FD9\u53E5\u8BDD\u7684\u610F\u4E49\uFF1F \u653E\u5728\u8FD9\u4E00\u6BB5\u4E2D\uFF0C\u597D\u50CF\u662F\u8BF4\u6709\u4E9B\u60C5\u51B5\u4E0B\u9690\u542B\u89C4\u5219\u4F1A\u4F18\u5148\u4E8E\u660E\u786E\u5199\u51FA\u7684\u89C4\u5219\u3002 \u53EF\u6211\u6CA1\u80FD\u627E\u51FA\u8FD9\u6837\u7684\u4F8B\u5B50\u3002 \u4F46\u6211\u627E\u5230\u4E86\u53E6\u5916\u4E00\u4E2A\u4F8B\u5B50\uFF1A\u5F53\u6CA1\u6709\u6307\u5B9A\u4EFB\u4F55\u989D\u5916\u4FE1\u606F\u7684\u65F6\u5019\uFF0Cmake\u4F1A\u4ECE foo.c \u4E00\u6B65\u7F16\u8BD1\u51FA foo\uFF0C \u800C\u5F53\u7ED9\u5B9A\u89C4\u5219<code>foo: foo.o</code> \u7684\u65F6\u5019\uFF0C\u56E0\u4E3A\u663E\u5F0F\u63D0\u5230\u4E86 foo.o, make \u4F1A\u5148\u7F16\u8BD1\u51FA foo.o \u518D\u94FE\u63A5 \u751F\u6210 foo\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">ls</span>
bar.c  foo.c  mk1
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">cat</span> mk1
foo: foo.o
        <span class="token variable"><span class="token variable">$(</span>CC<span class="token variable">)</span></span> -o <span class="token variable">$@</span> $<span class="token operator">&lt;</span>
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">make</span> foo
cc     foo.c   -o foo
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">make</span> bar
cc     bar.c   -o bar
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">rm</span> foo bar
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">make</span> -f mk1 foo
cc    -c -o foo.o foo.c
cc -o foo foo.o
<span class="token punctuation">[</span>chenx@lcs2 test1<span class="token punctuation">]</span>$ <span class="token function">make</span> -f mk1 bar
cc     bar.c   -o bar
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u5982\u679C\u591A\u4E2A\u6A21\u5F0F\u89C4\u5219\u90FD\u5339\u914D\uFF08\u4E14\u5BF9\u5E94\u7684\u4F9D\u8D56\u90FD\u5B9E\u9645\u5B58\u5728\uFF09\uFF0C\u90A3\u4E48\u4E3B\u5E72\u6700\u77ED\u7684\u90A3\u6761\u89C4\u5219\u4F18\u5148\uFF0C\u5982\u679C\u4E00\u6837\u957F\uFF0C\u90A3\u4E48\u5728makefile\u4E2D\u7684\u4F4D\u7F6E \u9760\u524D\u7684\u89C4\u5219\u4F18\u5148\u3002 It is possible that more than one pattern rule will meet these criteria. In that case, make will choose the rule with the shortest stem (that is, the pattern that matches most specifically). If more than one pattern rule has the shortest stem, make will choose the first one found in the makefile.</p><p>This algorithm results in more specific rules being preferred over more generic ones; for example:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>%.o: %.c
        $(CC) -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@

%.o : %.f
        $(COMPILE.F) $(OUTPUT_OPTION) $&lt;

lib/%.o: lib/%.c
        $(CC) -fPIC -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Given these rules and asked to build bar.o where both bar.c and bar.f exist, make will choose the first rule and compile bar.c into bar.o. In the same situation where bar.c does not exist, then make will choose the second rule and compile bar.f into bar.o.</p><p>If make is asked to build lib/bar.o and both lib/bar.c and lib/bar.f exist, then the third rule will be chosen since the stem for this rule (\u2018bar\u2019) is shorter than the stem for the first rule (\u2018lib/bar\u2019). If lib/bar.c does not exist then the third rule is not eligible and the second rule will be used, even though the stem is longer.</p><h3 id="_10-5-5-match-anything-pattern-rules" tabindex="-1"><a class="header-anchor" href="#_10-5-5-match-anything-pattern-rules" aria-hidden="true">#</a> 10.5.5 Match-Anything Pattern Rules</h3>`,264);function ds(ms,hs){const l=r("ExternalLinkIcon"),n=r("RouterLink");return p(),o(c,null,[m,e("p",null,[e("a",h,[b,s(l)])]),e("nav",k,[e("ul",null,[e("li",null,[s(n,{to:"#\u76EE\u5F55"},{default:i(()=>[f]),_:1})]),e("li",null,[s(n,{to:"#_1-\u6982\u89C8"},{default:i(()=>[g]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#\u51C6\u5907"},{default:i(()=>[v]),_:1})]),e("li",null,[s(n,{to:"#_1-1-\u5982\u4F55\u9605\u8BFB\u672C\u624B\u518C"},{default:i(()=>[_]),_:1})]),e("li",null,[s(n,{to:"#_1-2-\u95EE\u9898\u548Cbug"},{default:i(()=>[y]),_:1})])])]),e("li",null,[s(n,{to:"#_2-makefile\u6587\u4EF6\u7684\u4ECB\u7ECD"},{default:i(()=>[w]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_2-1-what-a-rule-looks-like"},{default:i(()=>[x]),_:1})]),e("li",null,[s(n,{to:"#_2-2-a-simple-makefile"},{default:i(()=>[A]),_:1})]),e("li",null,[s(n,{to:"#_2-3-how-make-processes-a-makefile"},{default:i(()=>[E]),_:1})]),e("li",null,[s(n,{to:"#_2-4-variables-make-makefiles-simpler"},{default:i(()=>[S]),_:1})]),e("li",null,[s(n,{to:"#_2-5-letting-make-deduce-the-recipes"},{default:i(()=>[$]),_:1})]),e("li",null,[s(n,{to:"#_2-6-\u53E6\u4E00\u79CD\u98CE\u683C\u7684-makefile"},{default:i(()=>[L]),_:1})]),e("li",null,[s(n,{to:"#_2-7-\u6E05\u7406\u76EE\u5F55\u7684\u89C4\u5219"},{default:i(()=>[q]),_:1})])])]),e("li",null,[s(n,{to:"#_3-writing-makefiles"},{default:i(()=>[M]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_3-1-makefile-\u5305\u542B\u7684\u5143\u7D20"},{default:i(()=>[I]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_3-1-1-\u7EED\u884C"},{default:i(()=>[R]),_:1})])])]),e("li",null,[s(n,{to:"#_3-2-\u6307\u5B9A-makefile-\u6587\u4EF6\u8DEF\u5F84"},{default:i(()=>[F]),_:1})]),e("li",null,[s(n,{to:"#_3-3-\u5305\u542B\u5176\u5B83makefile"},{default:i(()=>[T]),_:1})]),e("li",null,[s(n,{to:"#_3-4-\u53D8\u91CF-makefiles"},{default:i(()=>[P]),_:1})]),e("li",null,[s(n,{to:"#_3-5-remade-\u8FC7\u7A0B"},{default:i(()=>[C]),_:1})]),e("li",null,[s(n,{to:"#_3-6-\u8986\u76D6\u53E6\u4E00\u4E2Amakfile\u7684\u90E8\u5206\u5185\u5BB9"},{default:i(()=>[O]),_:1})]),e("li",null,[s(n,{to:"#_3-7-\u8BFB\u53D6makefile-\u4E24\u9636\u6BB5"},{default:i(()=>[H]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#\u6761\u4EF6\u6307\u4EE4\u7ACB\u5373\u5C55\u5F00"},{default:i(()=>[G]),_:1})]),e("li",null,[s(n,{to:"#\u89C4\u5219\u5B9A\u4E49"},{default:i(()=>[N]),_:1})])])]),e("li",null,[s(n,{to:"#_3-8-\u89E3\u6790makefile"},{default:i(()=>[j]),_:1})]),e("li",null,[s(n,{to:"#_3-9-secondary-expansion-\u5F85\u7EED"},{default:i(()=>[K]),_:1})])])]),e("li",null,[s(n,{to:"#_4-\u4E66\u5199\u89C4\u5219"},{default:i(()=>[D]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_4-1-\u793A\u4F8B"},{default:i(()=>[V]),_:1})]),e("li",null,[s(n,{to:"#_4-2-\u89C4\u5219\u8BED\u6CD5"},{default:i(()=>[U]),_:1})]),e("li",null,[s(n,{to:"#_4-3-prerequisite-\u7684\u5206\u7C7B"},{default:i(()=>[B]),_:1})]),e("li",null,[s(n,{to:"#_4-4-\u5728\u6587\u4EF6\u540D\u4E2D\u4F7F\u7528\u901A\u914D\u7B26"},{default:i(()=>[W]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_4-4-1-\u793A\u4F8B"},{default:i(()=>[Q]),_:1})]),e("li",null,[s(n,{to:"#_4-4-2-\u9677\u9631"},{default:i(()=>[X]),_:1})]),e("li",null,[s(n,{to:"#_4-4-3-wildcard-\u51FD\u6570"},{default:i(()=>[Y]),_:1})])])]),e("li",null,[s(n,{to:"#_4-5-prerequisite-\u7684\u641C\u7D22\u8DEF\u5F84-\u5F85\u7EED"},{default:i(()=>[z]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_4-5-1-vpath-\u53D8\u91CF"},{default:i(()=>[J]),_:1})]),e("li",null,[s(n,{to:"#_4-5-2-vpath-\u6307\u4EE4"},{default:i(()=>[Z]),_:1})]),e("li",null,[s(n,{to:"#_4-5-3-\u76EE\u5F55\u641C\u7D22\u662F\u5982\u4F55\u6267\u884C\u7684"},{default:i(()=>[ee]),_:1})]),e("li",null,[s(n,{to:"#_4-5-4-\u4E66\u5199\u53EF\u4EE5\u9002\u914D-directory-search-\u7684-recipe"},{default:i(()=>[ae]),_:1})]),e("li",null,[s(n,{to:"#_4-5-5-directory-search-\u548C-implicit-rule"},{default:i(()=>[se]),_:1})]),e("li",null,[s(n,{to:"#_4-5-6-directory-search-\u548C\u94FE\u63A5\u5E93-\u7565"},{default:i(()=>[ne]),_:1})])])]),e("li",null,[s(n,{to:"#_4-6-phony-target"},{default:i(()=>[ie]),_:1})]),e("li",null,[s(n,{to:"#_4-7-\u65E2\u6CA1\u6709-recipe-\u53C8\u6CA1\u6709-prerequisite-\u7684\u89C4\u5219"},{default:i(()=>[le]),_:1})]),e("li",null,[s(n,{to:"#_4-8-\u7528\u7A7A\u7684target\u6587\u4EF6\u8BB0\u5F55\u4E8B\u4EF6"},{default:i(()=>[te]),_:1})]),e("li",null,[s(n,{to:"#_4-9-\u6709\u7279\u6B8A\u610F\u4E49\u7684\u5185\u7F6Etarget-\u90E8\u5206"},{default:i(()=>[re]),_:1})]),e("li",null,[s(n,{to:"#_4-10-\u4E00\u4E2A\u89C4\u5219\u591A\u4E2A-target"},{default:i(()=>[pe]),_:1})]),e("li",null,[s(n,{to:"#_4-11-\u4E00\u4E2A-target-\u591A\u4E2A\u89C4\u5219"},{default:i(()=>[oe]),_:1})]),e("li",null,[s(n,{to:"#_4-12-\u9759\u6001\u6A21\u677F\u89C4\u5219"},{default:i(()=>[ce]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_4-12-1-\u8BED\u6CD5"},{default:i(()=>[ue]),_:1})]),e("li",null,[s(n,{to:"#_4-12-2-\u4E0E\u9690\u5F0F\u89C4\u5219\u5BF9\u6BD4"},{default:i(()=>[de]),_:1})])])]),e("li",null,[s(n,{to:"#_4-13-\u53CC\u5192\u53F7\u89C4\u5219"},{default:i(()=>[me]),_:1})]),e("li",null,[s(n,{to:"#_4-14-\u81EA\u52A8\u751F\u6210\u4F9D\u8D56"},{default:i(()=>[he]),_:1})])])]),e("li",null,[s(n,{to:"#_5-\u89C4\u5219\u4E2D\u7684-recipe"},{default:i(()=>[be]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_5-1-\u8BED\u6CD5"},{default:i(()=>[ke]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_5-1-1-recipe-\u4E2D\u7684\u7EED\u884C"},{default:i(()=>[fe]),_:1})]),e("li",null,[s(n,{to:"#_5-1-2-\u5728-recipe-\u4E2D\u4F7F\u7528\u53D8\u91CF"},{default:i(()=>[ge]),_:1})])])]),e("li",null,[s(n,{to:"#_5-2-recipe-\u7684\u56DE\u663E"},{default:i(()=>[ve]),_:1})]),e("li",null,[s(n,{to:"#_5-3-\u6267\u884C-recipe"},{default:i(()=>[_e]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_5-3-1-\u4F7F\u7528\u4E00\u4E2A-shell"},{default:i(()=>[ye]),_:1})]),e("li",null,[s(n,{to:"#_5-3-2-\u9009\u62E9-shell"},{default:i(()=>[we]),_:1})])])]),e("li",null,[s(n,{to:"#_5-4-\u5E76\u53D1\u6267\u884C"},{default:i(()=>[xe]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_5-4-1-\u5E76\u53D1\u65F6\u7684\u8F93\u51FA"},{default:i(()=>[Ae]),_:1})]),e("li",null,[s(n,{to:"#_5-4-2-\u5E76\u53D1\u65F6\u7684\u8F93\u5165"},{default:i(()=>[Ee]),_:1})])])]),e("li",null,[s(n,{to:"#_5-5-recipe-\u4E2D\u7684\u9519\u8BEF"},{default:i(()=>[Se]),_:1})]),e("li",null,[s(n,{to:"#_5-6-\u7EC8\u6B62-make"},{default:i(()=>[$e]),_:1})]),e("li",null,[s(n,{to:"#_5-7-\u9012\u5F52\u8C03\u7528-make"},{default:i(()=>[Le]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_5-7-1-make\u53D8\u91CF\u7684\u5DE5\u4F5C\u65B9\u5F0F"},{default:i(()=>[qe]),_:1})]),e("li",null,[s(n,{to:"#_5-7-2-\u5411\u5B50-make-\u4F20\u9012\u53D8\u91CF"},{default:i(()=>[Me]),_:1})]),e("li",null,[s(n,{to:"#_5-7-3-\u5411\u5B50-make-\u4F20\u9012\u9009\u9879"},{default:i(()=>[Ie]),_:1})]),e("li",null,[s(n,{to:"#_5-7-4-print-directory-\u9009\u9879"},{default:i(()=>[Re]),_:1})])])]),e("li",null,[s(n,{to:"#_5-8-\u5B9A\u4E49\u5BB9\u5668-recipe"},{default:i(()=>[Fe]),_:1})]),e("li",null,[s(n,{to:"#_5-9-\u4F7F\u7528\u7A7A-recipe"},{default:i(()=>[Te]),_:1})])])]),e("li",null,[s(n,{to:"#_6-\u53D8\u91CF"},{default:i(()=>[Pe]),_:1})]),e("li",null,[s(n,{to:"#_9-how-to-run-make"},{default:i(()=>[Ce]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_9-1-\u6307\u5B9A-makefile"},{default:i(()=>[Oe]),_:1})]),e("li",null,[s(n,{to:"#_9-2-\u6307\u5B9A-goal"},{default:i(()=>[He]),_:1})]),e("li",null,[s(n,{to:"#_9-3-instead-of-executing-recipes"},{default:i(()=>[Ge]),_:1})]),e("li",null,[s(n,{to:"#_9-4-\u8DF3\u8FC7\u7F16\u8BD1\u67D0\u4E9B\u6587\u4EF6"},{default:i(()=>[Ne]),_:1})]),e("li",null,[s(n,{to:"#_9-5-\u8986\u76D6\u53D8\u91CF"},{default:i(()=>[je]),_:1})]),e("li",null,[s(n,{to:"#_9-6-\u6D4B\u8BD5\u7F16\u8BD1\u8FC7\u7A0B"},{default:i(()=>[Ke]),_:1})]),e("li",null,[s(n,{to:"#_9-7-\u9009\u9879\u603B\u7ED3"},{default:i(()=>[De]),_:1})])])]),e("li",null,[s(n,{to:"#_10-using-implicit-rules"},{default:i(()=>[Ve]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_10-1-using-implicit-rules"},{default:i(()=>[Ue]),_:1})]),e("li",null,[s(n,{to:"#_10-2-catalogue-of-built-in-rules"},{default:i(()=>[Be]),_:1})]),e("li",null,[s(n,{to:"#_10-3-variables-used-by-implicit-rules"},{default:i(()=>[We]),_:1})]),e("li",null,[s(n,{to:"#_10-4-\u9690\u5F0F\u89C4\u5219\u7684\u94FE\u5F0F\u8C03\u7528"},{default:i(()=>[Qe]),_:1})]),e("li",null,[s(n,{to:"#_10-5-\u81EA\u5B9A\u4E49\u548C\u91CD\u65B0\u5B9A\u4E49\u6A21\u5F0F\u89C4\u5219"},{default:i(()=>[Xe]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#_10-5-1-introduction-to-pattern-rules"},{default:i(()=>[Ye]),_:1})]),e("li",null,[s(n,{to:"#_10-5-2-pattern-rule-examples"},{default:i(()=>[ze]),_:1})]),e("li",null,[s(n,{to:"#_10-5-3-automatic-variables"},{default:i(()=>[Je]),_:1})]),e("li",null,[s(n,{to:"#_10-5-4-how-patterns-match"},{default:i(()=>[Ze]),_:1})]),e("li",null,[s(n,{to:"#_10-5-5-match-anything-pattern-rules"},{default:i(()=>[ea]),_:1})])])])])])])]),aa,e("ul",null,[e("li",null,[e("p",null,[sa,e("a",na,[ia,s(l)]),la])]),e("li",null,[e("p",null,[ta,e("a",ra,[pa,s(l)]),oa])]),ca]),ua,e("p",null,[da,e("a",ma,[ha,s(l)])]),ba,e("p",null,[ka,e("a",fa,[ga,s(l)])]),va,e("p",null,[_a,e("a",ya,[wa,s(l)]),xa,e("a",Aa,[Ea,s(l)]),Sa]),e("p",null,[$a,e("a",La,[qa,s(l)]),Ma,e("a",Ia,[Ra,s(l)]),Fa]),Ta,Pa,Ca,Oa,Ha,e("p",null,[Ga,e("a",Na,[ja,s(l)]),Ka]),Da,e("p",null,[Va,e("a",Ua,[Ba,s(l)]),Wa]),Qa,e("ul",null,[Xa,Ya,e("li",null,[e("p",null,[za,e("a",Ja,[Za,s(l)])])]),es]),as,e("p",null,[ss,e("a",ns,[is,s(l)]),ls]),ts,e("p",null,[rs,e("a",ps,[os,s(l)]),cs]),us],64)}var fs=u(d,[["render",ds]]);export{fs as default};
