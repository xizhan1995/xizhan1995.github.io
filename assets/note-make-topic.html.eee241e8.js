import{e as n}from"./app.11a37516.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";const a={},e=n(`<h1 id="make\u4E13\u9898\u5B66\u4E60" tabindex="-1"><a class="header-anchor" href="#make\u4E13\u9898\u5B66\u4E60" aria-hidden="true">#</a> Make\u4E13\u9898\u5B66\u4E60</h1><h2 id="\u5938\u4E00\u5938-makefile" tabindex="-1"><a class="header-anchor" href="#\u5938\u4E00\u5938-makefile" aria-hidden="true">#</a> \u5938\u4E00\u5938 Makefile</h2><blockquote><p>Linux \u73AF\u5883\u4E0B\u7684\u7A0B\u5E8F\u5458\u5982\u679C\u4E0D\u4F1A\u4F7F\u7528GNU make\u6765\u6784\u5EFA\u548C\u7BA1\u7406\u81EA\u5DF1\u7684\u5DE5\u7A0B\uFF0C\u5E94\u8BE5\u4E0D\u80FD\u7B97\u662F\u4E00\u4E2A\u5408\u683C\u7684\u4E13\u4E1A\u7A0B\u5E8F\u5458\u3002 Makefile \u6587\u4EF6\u63CF\u8FF0\u4E86\u6574\u4E2A\u5DE5\u7A0B\u7684\u7F16\u8BD1\u3001\u8FDE\u63A5\u7B49\u89C4\u5219\u3002\u5176\u4E2D\u5305\u62EC\uFF1A\u5DE5\u7A0B\u4E2D\u7684\u54EA\u4E9B\u6E90\u6587\u4EF6\u9700\u8981\u7F16\u8BD1\u4EE5\u53CA\u5982\u4F55\u7F16\u8BD1\u3001 \u9700\u8981\u521B\u5EFA\u54EA\u4E9B\u5E93\u6587\u4EF6\u4EE5\u53CA\u5982\u4F55\u521B\u5EFA\u8FD9\u4E9B\u5E93\u6587\u4EF6\u3001\u5982\u4F55\u6700\u540E\u4EA7\u751F\u6211\u4EEC\u60F3\u8981\u7684\u53EF\u6267\u884C\u6587\u4EF6\u3002</p></blockquote><p>makefile\u5E26\u6765\u7684\u597D\u5904\u5C31\u662F\u2014\u2014\u201C\u81EA\u52A8\u5316\u7F16\u8BD1\u201D\uFF0C\u4E00\u65E6\u5199\u597D\uFF0C\u53EA\u9700\u8981\u4E00\u4E2Amake\u547D\u4EE4\uFF0C\u6574\u4E2A\u5DE5\u7A0B\u5B8C\u5168\u81EA\u52A8\u7F16\u8BD1\uFF0C\u6781\u5927\u7684\u63D0\u9AD8\u4E86\u8F6F\u4EF6\u5F00\u53D1\u7684\u6548\u7387\u3002</p><p>2021-12-20\uFF0C\u5206\u6790\u6570\u636E\u5E73\u4F5C\u4E1A\u914D\u7F6E\u4E2D\u914D\u7F6E\u7684\u4EFB\u52A1\u90FD\u6D89\u53CA\u5230\u54EA\u4E9B\u4E1A\u52A1\u7CFB\u7EDF\uFF0C\u4E00\u4E9B\u7B80\u5355\u7684\u5355\u884C\u547D\u4EE4\uFF0C\u501F\u52A9 Makefile\uFF0C \u6BD4\u5199\u5230 shell \u811A\u672C\u4E2D\u66F4\u4FBF\u6377\u3002</p><h2 id="makefile\u7684\u6587\u4EF6\u540D" tabindex="-1"><a class="header-anchor" href="#makefile\u7684\u6587\u4EF6\u540D" aria-hidden="true">#</a> Makefile\u7684\u6587\u4EF6\u540D</h2><p>\u5982\u679C\u4E0D\u6307\u5B9A, GNUmakefile\u3001makefile\u3001Makefile\u3002 \u5EFA\u8BAE\u7528 Makefile\uFF0C\u56E0\u4E3A\u9996\u5B57\u6BCD\u5927\u5199\u4F1A\u51FA\u73B0\u5728\u76EE\u5F55\u9760\u524D\u7684\u4F4D\u7F6E\u3002 \u5EFA\u8BAE\u4E0D\u8981\u4F7F\u7528 GNUmakefile, \u9664\u975E\u662F\u4E13\u95E8\u5199\u7ED9 GNU make \u547D\u4EE4\u7684, \u5B83\u53EA\u5BF9 gnumake \u6709\u6548. \u5982\u679Cmake\u6CA1\u6709\u627E\u5230\u9ED8\u8BA4\u89C4\u5219\u6587\u4EF6, \u5219\u4F60\u5FC5\u987B\u6307\u5B9A\u5177\u4F53\u7684\u76EE\u6807, \u6B64\u65F6 Make \u5C1D\u8BD5\u4EC5\u4F7F\u7528\u9690\u542B\u89C4\u5219\u53BB\u5339\u914D\u5E76\u6784\u9020\u76EE\u6807.</p><p>\u4F7F\u7528 -f filename\uFF0C--file=filename \u53EF\u4EE5\u624B\u52A8\u6307\u5B9A\u4EFB\u610F\u540D\u79F0\u7684\u6587\u4EF6\u540D\u4F5C\u4E3A\u89C4\u5219\u6587\u4EF6. \u53EF\u4EE5\u591A\u6B21\u4F7F\u7528 -f \u9009\u9879\u6307\u5B9A\u591A\u4E2A\u6587\u4EF6,\u8FD9\u4E9B\u6587\u4EF6\u7684\u5185\u5BB9\u4F1A\u6309\u987A\u5E8F\u62FC\u63A5\u5230\u4E00\u8D77. \u6307\u5B9A -f \u4E4B\u540E, make \u5C31\u4E0D\u518D\u641C\u7D22\u9ED8\u8BA4\u540D\u79F0\u7684 Makefile. \u5982\u679C -f \u6307\u5B9A\u7684\u6587\u4EF6\u4E0D\u5B58\u5728, \u5219\u62A5\u9519\u9000\u51FA.</p><h2 id="\u89C4\u5219\u7684\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u89C4\u5219\u7684\u5206\u7C7B" aria-hidden="true">#</a> \u89C4\u5219\u7684\u5206\u7C7B</h2><ul><li>\u663E\u5F0F\u89C4\u5219 <ul><li>\u666E\u901A\u89C4\u5219</li><li>double colon rule</li><li>static pattern rule</li></ul></li><li>\u9690\u5F0F\u89C4\u5219 <ul><li>builtin rule</li><li>pattern rule</li><li>match anything rule <ul><li>terminal</li><li>non-terminal</li></ul></li></ul></li></ul><p>\u5BF9\u4E8E pattern rule\uFF0C\u7528\u6237\u5B9A\u4E49\u7684\uFF0C\u4F1A\u8986\u76D6\u5185\u7F6E\u7684\uFF0C\u5F53target\u548C prerequisite \u5B8C\u5168\u76F8\u540C\u65F6\uFF0C\u53D1\u751F\u8986\u76D6\uFF08\u66FF\u6362\uFF09\u3002 Q. \u975E match anything rule\uFF0C\u53EF\u4EE5\u4F7F\u7528\u53CC\u5192\u53F7\u5417\uFF1F\u53EF\u4EE5</p><h2 id="\u9690\u5F0F\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u9690\u5F0F\u89C4\u5219" aria-hidden="true">#</a> \u9690\u5F0F\u89C4\u5219</h2><p>\u9690\u5F0F\u89C4\u5219\u5206\u4E3A\u5185\u7F6E\u9690\u5F0F\u89C4\u5219\u548C\u81EA\u5B9A\u4E49\u9690\u5F0F\u89C4\u5219\u3002 \u81EA\u5B9A\u4E49\u9690\u5F0F\u89C4\u5219\uFF0C\u901A\u8FC7 pattern rule \u8BED\u6CD5\u5B9E\u73B0\u3002</p><p>make \u4F1A\u4E3A\u6BCF\u4E2A\u672A\u6307\u5B9Arecipe\u7684target\u4EE5\u53CA\u672A\u6307\u5B9Arecipe\u7684\u53CC\u5192\u53F7\u89C4\u5219\u641C\u7D22\u9690\u5F0F\u6761\u4EF6\u3002 \u4EC5\u4F5C\u4E3A\u4F9D\u8D56\u51FA\u73B0\u7684\u6587\u4EF6\u4F1A\u88AB\u89C6\u4F5C\u4E00\u6761\u65E0\u4EFB\u4F55\u5185\u5BB9\u7684\u89C4\u5219\u7684target\uFF0C\u6240\u4EE5makek\u4E5F\u4F1A\u4E3A\u8FD9\u7C7B\u6587\u4EF6\u641C\u7D22 \u9690\u5F0F\u89C4\u5219\u3002 ps\uFF1A\u5408\u8D77\u6765\u5C31\u662F\uFF0Cmake\u4F1A\u4E3A\u6BCF\u4E2A\u65E0 recipe\u7684target\uFF08\u5305\u62EC\u4EC5\u4F5C\u4E3A\u4F9D\u8D56\u51FA\u73B0\u7684\u6587\u4EF6\uFF09\u641C\u7D22\u9690\u5F0F\u89C4\u5219\u3002</p><p>\u5728\u8FDB\u884C\u89C4\u5219\u5339\u914D\u7684\u65F6\u5019\uFF0C\u6A21\u677F\u89C4\u5219\u548C\u9690\u5F0F\u89C4\u5219\u7684\u5339\u914D\u7B97\u6CD5\u662F\u4E00\u6837\u7684\u3002</p><p>\u94FE\u5F0F\u641C\u7D22\u9690\u5F0F\u89C4\u5219\u65F6\uFF0C\u4E0D\u8003\u8651\u4EE5 non-terminal match anythig rule\u3002</p><p>\u9690\u5F0F\u89C4\u5219\u7684\u5339\u914D\u7B97\u6CD5</p><ul><li>\u57FA\u7840\uFF1A% \u5339\u914D\u4EFB\u610F\u975E\u7A7A\u5B57\u7B26\u4E32</li><li>\u591A\u4E2A\u90FD\u5339\u914D\u65F6\uFF0C\u8C01\u7684\u4F9D\u8D56\u5B9E\u9645\u5B58\u5728\u6216\u53EF\u4EE5\u751F\u6210\uFF0C\u8C01\u83B7\u80DC\uFF0C\u5426\u5219</li><li>\u591A\u4E2A\u90FD\u5339\u914D\u65F6\uFF0C\u4F9D\u8D56\u5B9E\u9645\u5B58\u5728\u6216\u663E\u5F0F\u63CF\u8FF0\u8FC7\u7684\uFF0C\u8FD9\u6837\u7684\u89C4\u5219\u4F18\u5148\u4E8E\u5176\u4F9D\u8D56\u5FC5\u987B\u901A\u8FC7\u94FE\u5F0F\u9690\u5F0F\u89C4\u5219\u800C\u751F\u6210\u7684\uFF0C\u90A3\u6837\u7684\u89C4\u5219</li><li>\u8FD8\u4E0D\u80FD\u5206\u51FA\uFF0C\u5219\u8C01\u7684\u5339\u914D\u66F4\u7CBE\u786E\u5C31\u7528\u90A3\u4E2A\uFF0C\u8FD8\u4E0D\u884C\uFF0C\u5219\u8C01\u7684\u4F4D\u7F6E\u9760\u524D\uFF0C\u8C01\u80DC\u51FA\u3002</li></ul><h2 id="\u5305\u542B\u5176\u4ED6makefile" tabindex="-1"><a class="header-anchor" href="#\u5305\u542B\u5176\u4ED6makefile" aria-hidden="true">#</a> \u5305\u542B\u5176\u4ED6makefile</h2><p>\u5305\u542B\u5176\u4ED6makefile \u7684\u552F\u4E00\u65B9\u5F0F\u662F include \u6307\u4EE4\u3002 \u5F53\u9047\u5230 include \u6307\u4EE4\u65F6\uFF0Cmake \u4F1A\u6682\u505C\u5F53\u524D makefile \u7684\u89E3\u6790\uFF0C\u8F6C\u800C\u8BFB\u53D6 include \u540E\u9762\u7684\u6587\u4EF6\uFF0C \u89E3\u6790\u5B8C\u6210\u540E\u518D\u7EE7\u7EED\u89E3\u6790\u5F53\u524D makefile\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>include filenames
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>include \u540E\u9762\u53EF\u4EE5\u8DDF\u7A7A\u6C14\uFF0C\u4E0D\u62A5\u9519\uFF0C\u76F4\u63A5\u5FFD\u7565\u3002 include \u540E\u9762\u6307\u5B9A\u7684\u6587\u4EF6\u53EF\u4EE5\u4E0D\u5B58\u5728\uFF0C\u4F46\u5F53\u6240\u6709\u627E\u5F97\u5230\u7684makefile\u8BFB\u53D6\u4E4B\u540E \u5982\u679C\u4E0D\u80FD\u5236\u4F5C\u51FA\u7F3A\u5931\u7684makefile\uFF0C\u5C31\u62A5\u9519\u7EC8\u6B62\u3002 \u53EF\u4EE5\u4F7F\u7528shell\u901A\u914D\u7B26\u6307\u5B9A\u6587\u4EF6\u540D\u3002 Q. \u88AB\u5305\u542B\u7684\u6587\u4EF6\u672C\u8EAB\u5305\u542B\u7A7A\u683C\uFF0C\u5F53\u5982\u4F55\u5904\u7406\u5462\uFF1F \u7528\u53CD\u659C\u6760\u5BF9\u7A7A\u683C\u8F6C\u4E49\uFF1A<code>include file\\ name</code>\u3002 ps\uFF1A\u53CC\u5F15\u53F7\u6CA1\u6709\u7528<code>include &quot;file name&quot;</code>\uFF0Cmake \u4F1A\u8BA4\u4E3A\u662F\u4E24\u4E2A\u6587\u4EF6\uFF1Afile\u548Cname\u3002</p><p>\u8981\u8BA9make\u5FFD\u7565\u627E\u4E0D\u5230\u7684\u6587\u4EF6\uFF0C\u4F7F\u7528</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>-include filenames
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>include \u524D\u5934\u52A0\u4E00\u4E2A\u8FDE\u5B57\u7B26\u4F5C\u524D\u7F00\u3002</p><p>\u5185\u7F6E\u53D8\u91CF MAKEFILE_LIST \u5B58\u50A8 make \u89E3\u6790\u5230\u5F53\u524D\u884C\u65F6\u5DF2\u7ECF\u8BFB\u53D6\u7684\u6240\u6709 makefile \u7684\u540D\u5B57\u3002 <code>$(info $(MAKEFILE_LIST))</code></p><h2 id="remake\u548C\u81EA\u52A8\u751F\u6210\u5934\u6587\u4EF6\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#remake\u548C\u81EA\u52A8\u751F\u6210\u5934\u6587\u4EF6\u4F9D\u8D56" aria-hidden="true">#</a> REMAKE\u548C\u81EA\u52A8\u751F\u6210\u5934\u6587\u4EF6\u4F9D\u8D56</h2><p>\u624B\u5DE5\u7EF4\u62A4C\u8BED\u8A00\u5934\u6587\u4EF6\u4F9D\u8D56\u5BB9\u6613\u51FA\u9519\u3002 \u6240\u4EE5 GNU make \u589E\u8BBE remake \u7279\u6027\uFF0C\u7528\u4EE5\u652F\u6301\u81EA\u52A8\u5206\u6790\u5904\u7406\u5934\u6587\u4EF6\u4F9D\u8D56\u3002</p><p>remake \u662F\u4EC0\u4E48\u5462\uFF1F</p><p>\u4F55\u65F6\u53D1\u751F remake. \u8BFB\u53D6\u5B8C\u6240\u6709 makefile \u5E76\u6784\u5EFA\u4F9D\u8D56\u56FE\u5B8C\u6BD5\u540E\uFF0C\u7ACB\u5373\u5C1D\u8BD5\u4EE5\u6BCF\u4E2A makefile \u4E3A goal\uFF0C\u770B\u662F\u5426\u6709\u5339\u914D\u7684\u89C4\u5219\uFF0C\u4E14\u9700\u8981\u66F4\u65B0\uFF0C\u5F53\u81F3\u5C11 \u6709\u4E00\u4E2A makefile \u53D1\u751F\u4E86\u66F4\u65B0\uFF0C\u5219\u4EE5\u5E72\u51C0\u7684\u72B6\u6001\u91CD\u542Fmake\u3002 ps: \u8FD9\u91CC\u7684&quot;\u53D1\u751F\u4E86\u66F4\u65B0&quot; \u662F\u4F7F\u7528\u65F6\u95F4\u6233\u5224\u65AD\u7684.</p><blockquote><p>To this end, after reading in all makefiles make will consider each as a goal target and attempt to update it. If a makefile has a rule which says how to update it (found either in that very makefile or in another one) or if an implicit rule applies to it (see Using Implicit Rules), it will be updated if necessary. After all makefiles have been checked, if any have actually been changed, make starts with a clean slate and reads all the makefiles over again. (It will also attempt to update each of them over again, but normally this will not change them again, since they are already up to date.) Each restart will cause the special variable MAKE_RESTARTS to be updated (see Special Variables).</p></blockquote><h2 id="\u8BED\u6CD5\u5143\u7D20" tabindex="-1"><a class="header-anchor" href="#\u8BED\u6CD5\u5143\u7D20" aria-hidden="true">#</a> \u8BED\u6CD5\u5143\u7D20</h2><ul><li>exclicit rules <ul><li>static pattern rules</li><li>! double colon rules</li></ul></li><li>implicit rules: <ul><li>builtin rules</li><li>pattern rules</li></ul></li><li>variables defines: \u53D8\u91CF\uFF0C\u53D8\u91CF\u5F15\u7528\uFF0C\u51FD\u6570</li><li>directives\uFF1A include, if, define</li><li>comments</li></ul><h2 id="\u76EE\u6807\u4F55\u65F6\u9700\u8981\u66F4\u65B0" tabindex="-1"><a class="header-anchor" href="#\u76EE\u6807\u4F55\u65F6\u9700\u8981\u66F4\u65B0" aria-hidden="true">#</a> \u76EE\u6807\u4F55\u65F6\u9700\u8981\u66F4\u65B0?</h2><p>2021-02-05</p><blockquote><p>The criterion for being out of date is specified in terms of the prerequisites, which consist of file names separated by spaces. A target is out of date if it does not exist or if it is older than any of the prerequisites (by comparison of last-modification times).</p></blockquote><ol><li><p>\u8BF4\u67D0\u4E2Atarget\uFF08\u76EE\u6807\uFF09\u9700\u8981 check\uFF08\u68C0\u67E5\uFF09\uFF0C\u5F53\u4E14\u4EC5\u5F53</p><ul><li>1.1 \u5B83\u662F\u4F2A\u76EE\u6807\u6216\u8005\u8BE5\u76EE\u6807\u4E0D\u5B58\u5728\uFF0C\u6216\u8005</li><li>1.2 \u8BE5\u76EE\u6807\u6BD4\u5B83\u7684\u67D0\u4E2A\u4F9D\u8D56\uFF08prerequisite\uFF09\uFF08\u8FD9\u4E2A\u4F9D\u8D56\u6CA1\u6709\u5339\u914D\u7684\u89C4\u5219\uFF09\u65E7\uFF0C\u6216\u8005</li><li>1.3 \u8BE5\u76EE\u6807\u7684\u67D0\u4E2A\u4F9D\u8D56\uFF08\u8FD9\u4E2A\u4F9D\u8D56\u6709\u5339\u914D\u7684\u89C4\u5219\uFF09\u9700\u8981\u68C0\u67E5 \u67D0\u4E2A\u76EE\u6807\u662F\u5426\u9700\u8981\u68C0\u67E5\uFF0C\u7ED9\u5B9A make goal \u4E4B\u540E\uFF0C\u901A\u8FC7\u9759\u6001\u5206\u6790\u5C31\u80FD\u5F97\u51FA\u3002</li></ul></li><li><p>\u76EE\u6807 t \u9700\u8981\u6267\u884C\u5F53\u4E14\u4EC5\u5F53</p><ul><li>t \u662F\u4F2A\u76EE\u6807\u6216\u8005 t \u4E0D\u5B58\u5728\uFF0C\u6216</li><li>t \u5B58\u5728\u67D0\u4E2A\u6267\u884C\u8FC7\u7684\u4F9D\u8D56 p\uFF0C\u6EE1\u8DB3\uFF1A <ul><li>p \u662F\u4F2A\u76EE\u6807\u6216 p \u4E0D\u5B58\u5728\uFF0C\u6216</li><li>\u5B58\u5728\u6587 p \u4EF6\uFF0C\u4E14\u8BE5\u6587\u4EF6\u6BD4 make \u542F\u52A8\u65F6\u7684\u6587\u4EF6 t \u7684\u65F6\u95F4\u6233\u65B0</li></ul></li></ul><p>\u8865\u5145\uFF1A\u76EE\u6807\u662F\u5426\u6267\u884C\uFF0C\u4E0D\u53D7\u95F4\u63A5\u7684\u4F2A\u76EE\u6807\u4F9D\u8D56\u5F71\u54CD\u3002</p></li></ol><p>\u65E0\u8BBA\u76EE\u6807 t \u662F\u5426\u771F\u6B63\u6267\u884C\uFF0C\u7ECF\u8FC7\u8FD9\u4E9B\u68C0\u67E5\u4E4B\u540E\uFF0C\u76EE\u6807 t \u90FD\u53D8\u4F5C\u5DF2\u68C0\u67E5\uFF08checked\uFF09\u72B6\u6001\u3002 \u5982\u679C t \u786E\u5B9E\u6267\u884C\u4E86\uFF0Ct \u540C\u65F6\u662F\u201C\u5DF2\u6267\u884C\u201D\u72B6\u6001\u3002</p><p>\u63A8\u8BBA\uFF1A\u5982\u679C\u67D0\u4E2A target \u4E0D\u5B58\u5728\u4EFB\u4F55\u4F9D\u8D56\uFF08target \u4E0D\u662F\u4F2A\u76EE\u6807\uFF09\uFF0C\u5219\u8BE5\u76EE\u6807\u9700\u8981\u6267\u884C\u5F53\u4E14\u4EC5\u5F53\u8BE5\u76EE\u6807\u4E0D\u5B58\u5728 \u63A8\u8BBA\uFF1A\u4F2A\u76EE\u6807\u65E0\u6761\u4EF6\u6267\u884C\uFF0C\u76F4\u63A5\u4F9D\u8D56\u4E8E\u4F2A\u76EE\u6807\u7684\u76EE\u6807\u65E0\u6761\u4EF6\u6267\u884C\uFF1B</p><p>\u6CE8\uFF1A\u4F2A\u76EE\u6807\u662F\u6307\u7528 .PHONY \u4FEE\u9970\u7684\u76EE\u6807<code>.PHONY: p</code>\u3002\u5426\u5219\u5C31\u4E0D\u662F\u4F2A\u76EE\u6807\u3002 \u6CE8\uFF1A\u201C\u76EE\u6807\u4E0D\u5B58\u5728\u201D\u662F\u6307\u4E0D\u5B58\u5728\u4E0E\u76EE\u6807\u540C\u540D\u79F0\u7684\u6587\u4EF6</p><h3 id="\u5B9E\u9A8C-\u66F4\u65B0\u7684\u4F20\u9012\u6027" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u9A8C-\u66F4\u65B0\u7684\u4F20\u9012\u6027" aria-hidden="true">#</a> \u5B9E\u9A8C\uFF1A\u66F4\u65B0\u7684\u4F20\u9012\u6027</h3><p>A. \u6784\u9020\u666E\u901A\u76EE\u6807\u4F9D\u8D56\u94FE\uFF0Cg-&gt;t-&gt;p-&gt;d\uFF0C\u8BBE\u7F6E\u89C4\u5219\u548C\u573A\u666F\uFF0C\u4F7F\u5F97 make g \u65F6\uFF0Cp \u6267\u884C\uFF0Ct \u4E0D\u6267\u884C\uFF1B</p><ul><li>p &lt; d, p \u6267\u884C\u540E p&lt;=t\uFF0C\u5219 t \u4E0D\u6267\u884C</li><li>A1.p \u6267\u884C\u540E\uFF0Ct &gt; g \u65B0\u3002 \u9884\u671F\uFF1Ag \u6267\u884C: \u5B9E\u9645 g \u4E0D\u6267\u884C</li><li>A2.p \u6267\u884C\u540E t &lt;= g\uFF0C\u9884\u671F\uFF1Ag \u4E0D\u6267\u884C</li><li>A1\u548CA2\u5BF9\u7167\uFF0C\u8BF4\u660E\u6211\u7684\u603B\u7ED3\u662F\u5BF9\u7684\u3002</li></ul><p>B. \u5B8C\u5168\u4EFF\u7167A\uFF0C\u4F46\u628A p \u8BBE\u7F6E\u4E3A\u4F2A\u76EE\u6807\uFF0C\u9884\u671F</p><ul><li>B1 \u9884\u671F g \u6267\u884C:\u5B9E\u9645 g \u672A\u6267\u884C</li><li>B2 \u9884\u671F g \u6267\u884C</li></ul><p>C. \u6784\u9020\u666E\u901A\u76EE\u6807\u4F9D\u8D56\u94FE\uFF0Cg-&gt;t-&gt;p-&gt;d\uFF0C\u8BBE\u7F6E\u89C4\u5219\u548C\u573A\u666F\uFF0C\u4F7F\u5F97 make g \u65F6\uFF0Cp \u6267\u884C\uFF0Ct \u6267\u884C\uFF1B</p><ul><li>p &lt; d, p \u6267\u884C\u540E p &gt; t, \u5219 t \u6267\u884C\uFF0Ct \u4E0D\u6267\u884C\u4EFB\u4F55\u5B9E\u9645\u52A8\u4F5C</li><li>C1. P\u6267\u884C\u540E\uFF0Ct &lt;= g \u9884\u671F\uFF1Ag \u4E0D\u6267\u884C</li><li>C2. P\u6267\u884C\u540E\uFF0Ct &gt; g \u9884\u671F\uFF1Ag \u6267\u884C</li></ul><h4 id="a1-\u5B9E\u9645\u4E0A-g-\u6CA1\u6709\u6267\u884C-\u6240\u4EE5\u603B\u7ED3\u4E0D\u5BF9\u3002" tabindex="-1"><a class="header-anchor" href="#a1-\u5B9E\u9645\u4E0A-g-\u6CA1\u6709\u6267\u884C-\u6240\u4EE5\u603B\u7ED3\u4E0D\u5BF9\u3002" aria-hidden="true">#</a> A1\uFF0C\u5B9E\u9645\u4E0A g \u6CA1\u6709\u6267\u884C\uFF0C\u6240\u4EE5\u603B\u7ED3\u4E0D\u5BF9\u3002</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">cat</span> A1
g: t
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo g
t: p
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo t
p: d
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo p
        <span class="token function">touch</span> p -r t
        <span class="token comment"># \u4F7F\u5F97 t \u6BD4 g \u65B0\uFF0C\u8FD9\u6837 g \u4F1A\u6267\u884C</span>
        <span class="token function">touch</span> g
        <span class="token function">touch</span> t

<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ asy-touch p d t g <span class="token comment"># p &lt; d &lt; t &lt; g</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f A1 g <span class="token comment"># p \u6267\u884C: p \u4E0D\u6BD4 t \u65B0 -&gt; t \u4E0D\u6267\u884C; t \u6BD4 g \u65B0\uFF0Cg \u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
p
<span class="token function">touch</span> p -r t
<span class="token comment"># \u4F7F\u5F97 t \u6BD4 g \u65B0\uFF0C\u8FD9\u6837 g \u4F1A\u6267\u884C</span>
<span class="token function">touch</span> g
<span class="token function">touch</span> t
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> g
make: Nothing to be <span class="token keyword">done</span> <span class="token keyword">for</span> \`g&#39;.
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f A1 g <span class="token comment"># \u518D\u6B21\u6267\u884C\uFF0C\u53EA\u6709 g \u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
g
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="c1-\u7B26\u5408\u9884\u671F" tabindex="-1"><a class="header-anchor" href="#c1-\u7B26\u5408\u9884\u671F" aria-hidden="true">#</a> C1:\u7B26\u5408\u9884\u671F</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> C1
g: t
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo g
t: p
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo t
p: d
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo p
        <span class="token function">touch</span> p <span class="token comment"># p \u6BD4 t0 \u65B0, t \u4F1A\u6267\u884C</span>
        <span class="token function">touch</span> t -r g <span class="token comment"># t &lt;= g0, g \u4E0D\u4F1A\u6267\u884C</span>

<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ asy-touch
A1   C1   d    g    mk2  p    t
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ asy-touch p d t g <span class="token comment"># p &lt; d &lt; t &lt; g</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f C1 g <span class="token comment"># p \u6267\u884C\uFF0Ct \u6267\u884C\uFF0Cg\u4E0D\u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
p
<span class="token function">touch</span> p <span class="token comment"># p \u6BD4 t0 \u65B0, t \u4F1A\u6267\u884C</span>
<span class="token function">touch</span> t -r g <span class="token comment"># t &lt;= g0, g \u4E0D\u4F1A\u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
t
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token comment"># \u7B26\u5408\u9884\u671F</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="c2" tabindex="-1"><a class="header-anchor" href="#c2" aria-hidden="true">#</a> C2</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">cat</span> C2
g: t
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo g
t: p
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo t
p: d
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo p
        <span class="token function">touch</span> p <span class="token comment"># p \u6BD4 t0 \u65B0, t \u4F1A\u6267\u884C</span>
        <span class="token function">touch</span> t <span class="token comment"># t &gt; g0, g \u4F1A\u6267\u884C</span>

<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ asy-touch p d t g <span class="token comment"># p &lt; d &lt; t &lt; g</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f C2 g <span class="token comment"># \u9884\u671F p \u6267\u884C\uFF0Ct \u6267\u884C\uFF0Cg \u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
p
<span class="token function">touch</span> p <span class="token comment"># p \u6BD4 t0 \u65B0, t \u4F1A\u6267\u884C</span>
<span class="token function">touch</span> t <span class="token comment"># t &gt; g0, g \u4F1A\u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
t
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
g
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token comment"># \u7B26\u5408\u9884\u671F</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="b1" tabindex="-1"><a class="header-anchor" href="#b1" aria-hidden="true">#</a> B1</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">cat</span> B1
g: t
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo g
t: p
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo t
p: d
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo p
        <span class="token comment"># \u4F7F\u5F97 p &lt;=t0, \u5982\u6B64 t \u4E0D\u4F1A\u6267\u884C\uFF0Cg \u5C31\u4E0D\u4F1A\u6267\u884C</span>
        <span class="token comment"># \u4F46\u56E0\u4E3A p \u662F\u4F2A\u76EE\u6807\uFF0C</span>
        <span class="token function">touch</span> p -r t
PHONY: p

<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f B1 g <span class="token comment"># \u9884\u671F p \u6267\u884C\uFF0Ct\uFF0Cg \u4E5F\u6267\u884C</span>
make: <span class="token string">&#39;g&#39;</span> is up to date.
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">vi</span> B1
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
p
<span class="token comment"># \u4F7F\u5F97 p &lt;=t0, \u5982\u6B64 t \u4E0D\u4F1A\u6267\u884C\uFF0Cg \u5C31\u4E0D\u4F1A\u6267\u884C</span>
<span class="token comment"># \u4F46\u56E0\u4E3A p \u662F\u4F2A\u76EE\u6807\uFF0C</span>
<span class="token function">touch</span> p -r t
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
t
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">cat</span> B1
g: t
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo g
t: p
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo t
p: d
        @echo <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
        @echo p
        <span class="token comment"># \u4F7F\u5F97 p &lt;=t0, \u5982\u6B64 t \u4E0D\u4F1A\u6267\u884C\uFF0Cg \u5C31\u4E0D\u4F1A\u6267\u884C</span>
        <span class="token comment"># \u4F46\u56E0\u4E3A p \u662F\u4F2A\u76EE\u6807\uFF0C</span>
        <span class="token function">touch</span> p -r t
.PHONY: p

<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">9</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -f B1 g <span class="token comment"># \u9884\u671F p \u6267\u884C\uFF0Ct\uFF0Cg \u4E5F\u6267\u884C</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
p
<span class="token comment"># \u4F7F\u5F97 p &lt;=t0, \u5982\u6B64 t \u4E0D\u4F1A\u6267\u884C\uFF0Cg \u5C31\u4E0D\u4F1A\u6267\u884C</span>
<span class="token comment"># \u4F46\u56E0\u4E3A p \u662F\u4F2A\u76EE\u6807\uFF0C</span>
<span class="token function">touch</span> p -r t
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
t
<span class="token comment"># \u4F46\u53EA\u6709 t \u6267\u884C\uFF0Cg \u4E0D\u6267\u884C\uFF0C\u8BF4\u660E\u4F2A\u76EE\u6807\u53EA\u5BF9\u76F4\u63A5\u88AB\u4F9D\u8D56\u9879\u6709\u6548</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h4 id="b2" tabindex="-1"><a class="header-anchor" href="#b2" aria-hidden="true">#</a> B2</h4><h3 id="force" tabindex="-1"><a class="header-anchor" href="#force" aria-hidden="true">#</a> FORCE</h3><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>.RECIPEPREFIX<span class="token operator">:=</span>&gt;
<span class="token symbol">foo</span><span class="token punctuation">:</span> FORCE
&gt; <span class="token operator">@</span>echo <span class="token variable">$@</span>

<span class="token symbol">FORCE</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="\u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF" aria-hidden="true">#</a> \u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF</h2><p>2021-02-06 15:35</p><h3 id="\u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF-1" tabindex="-1"><a class="header-anchor" href="#\u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF-1" aria-hidden="true">#</a> \u9012\u5F52\u53D8\u91CF\u548C\u7B80\u5355\u53D8\u91CF</h3><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment"># \u9012\u5F52\u53D8\u91CF</span>
foo <span class="token operator">=</span> bar
foo2<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
<span class="token comment"># \u7B80\u5355\u53D8\u91CF</span>
foo <span class="token operator">:=</span> bar
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u9012\u5F52\u53D8\u91CF\uFF0C\u7528\u7B49\u53F7\u6216\u8005define\u5B9A\u4E49\uFF0C\u5B9A\u4E49\u7684\u65F6\u5019\uFF0C\u5982\u679C\u542B\u6709\u5176\u5B83\u53D8\u91CF\u7684\u5F15\u7528\uFF0C\u4F1A\u5728\u4F7F\u7528\u7684\u65F6\u5019\u9012\u5F52\u5C55\u5F00\u3002 \u7B80\u5355\u53D8\u91CF\uFF0C\u7528 <code>:=</code> \u6216\u8005 <code>::=</code> \u5B9A\u4E49\uFF0C\u5B9A\u4E49\u7684\u65F6\u5019\uFF0C\u5982\u679C\u542B\u6709\u5176\u5B83\u53D8\u91CF\u7684\u5F15\u7528\uFF0C\u4F1A\u7ACB\u5373\u5C55\u5F00\uFF0C\u5B83\u7684\u503C\u5728\u5B9A\u4E49\u7684\u65F6\u5019\u5C31\u5B8C\u5168\u786E\u5B9A\u4E86\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment"># \u9012\u5F52\u53D8\u91CF</span>
foo <span class="token operator">=</span> <span class="token variable">$</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span>
bar <span class="token operator">=</span> <span class="token variable">$</span><span class="token punctuation">(</span>ugh<span class="token punctuation">)</span>
ugh <span class="token operator">=</span> Huh?

<span class="token symbol">all</span><span class="token punctuation">:</span><span class="token punctuation">;</span>echo <span class="token variable">$</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>make all \u8F93\u51FA &#39;Huh?&#39;</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment"># \u7B80\u5355\u53D8\u91CF</span>
x <span class="token operator">:=</span> foo
y <span class="token operator">:=</span> <span class="token variable">$</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> bar
x <span class="token operator">:=</span> later

<span class="token comment"># \u7B49\u4EF7\u4E8E</span>

y <span class="token operator">:=</span> foo bar
x <span class="token operator">:=</span> later
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="\u7ED9\u53D8\u91CF\u8D4B\u503C" tabindex="-1"><a class="header-anchor" href="#\u7ED9\u53D8\u91CF\u8D4B\u503C" aria-hidden="true">#</a> \u7ED9\u53D8\u91CF\u8D4B\u503C</h3><ol><li>\u8C03\u7528make\u65F6\u5728\u547D\u4EE4\u884C\u8D4B\u503C</li><li>\u5728makefile\u4E2D\u7528\u8D4B\u503C\u8BED\u53E5\u8D4B\u503C\uFF08=, :=, ?=, +=, define\uFF09</li><li>\u73AF\u5883\u53D8\u91CF</li></ol><p>1,2,3 \u4F18\u5148\u7EA7\u4F9D\u6B21\u964D\u4F4E\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment"># \u7ED9\u53D8\u91CF\u8D4B\u503C\u7684\u4E09\u79CD\u65B9\u5F0F</span>
<span class="token comment"># 1. \u8C03\u7528make\u65F6\u5728\u547D\u4EE4\u884C\u8D4B\u503C</span>
<span class="token comment"># 2. \u5728makefile\u4E2D\u7528\u8D4B\u503C\u8BED\u53E5\u8D4B\u503C\uFF08=, :=, ?=, +=, define\uFF09</span>
<span class="token comment"># 3. \u73AF\u5883\u53D8\u91CF</span>

foo<span class="token operator">:=</span>val_of_foo
bar<span class="token operator">:=</span>val_of_bar

<span class="token symbol">all</span><span class="token punctuation">:</span>
        echo <span class="token variable">$</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span>
        echo <span class="token variable">$</span><span class="token punctuation">(</span>bar<span class="token punctuation">)</span>
<span class="token symbol">        echo from env</span><span class="token punctuation">:</span> <span class="token variable">$</span><span class="token punctuation">(</span>baz<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token comment"># \u4E0D\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF\uFF0C\u76F4\u63A5\u6267\u884C</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token function">make</span> -n
<span class="token builtin class-name">echo</span> val_of_foo
<span class="token builtin class-name">echo</span> val_of_bar
<span class="token builtin class-name">echo</span> from env:
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token comment"># \u53EF\u4EE5\u770B\u5230 foo\u548Cbard\u90FD\u662F\u5728makefile\u4E2D\u8BBE\u7F6E\u7684\u503C\uFF0Cbar\u6CA1\u6709\u503C</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token comment"># \u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF foo \u548C  baz</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>foo <span class="token assign-left variable">baz</span><span class="token operator">=</span>baz <span class="token function">make</span> -n
<span class="token builtin class-name">echo</span> val_of_foo
<span class="token builtin class-name">echo</span> val_of_bar
<span class="token builtin class-name">echo</span> from env: baz
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token comment"># \u53EF\u4EE5\u770B\u5230\uFF0C\u73AF\u5883\u53D8\u91CFfoo\u65E0\u6548\uFF08\u6240\u4EE5\u73AF\u5883\u53D8\u91CF\u7684\u4F18\u5148\u7EA7\u4F4E\u4E8Emakefile\u4E2D\u7684\u53D8\u91CF\u5B9A\u4E49\uFF09\uFF0Cbaz \u53D8\u91CF\u7684\u503C\u5C31\u662F\u73AF\u5883\u53D8\u91CF\u7684\u503C</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token comment"># make \u547D\u4EE4\u884C\u8BBE\u7F6Efoo\u7684\u503C</span>
<span class="token punctuation">[</span>chenx@lcs2 <span class="token number">2</span><span class="token punctuation">]</span>$ <span class="token function">make</span> <span class="token assign-left variable">foo</span><span class="token operator">=</span>foo -n
<span class="token builtin class-name">echo</span> foo
<span class="token builtin class-name">echo</span> val_of_bar
<span class="token builtin class-name">echo</span> from env:
<span class="token comment"># make \u547D\u4EE4\u884C\u7684\u8BBE\u7F6E\u751F\u6548\u4E86\uFF0C\u8986\u76D6\u4E86makefile\u4E2D\u7684\u5B9A\u4E49</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="\u7ED9\u53D8\u91CF\u8FFD\u52A0\u503C\u548C\u6761\u4EF6\u8D4B\u503C" tabindex="-1"><a class="header-anchor" href="#\u7ED9\u53D8\u91CF\u8FFD\u52A0\u503C\u548C\u6761\u4EF6\u8D4B\u503C" aria-hidden="true">#</a> \u7ED9\u53D8\u91CF\u8FFD\u52A0\u503C\u548C\u6761\u4EF6\u8D4B\u503C</h3><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>foo<span class="token operator">:=</span>foo1
foo<span class="token operator">+=</span>foo2
<span class="token comment"># \u6B64\u65F6\uFF0Cfoo \u7684\u503C\u65F6 foo1 foo2</span>
<span class="token comment"># \u4E14+= \u5B9A\u4E49\u7684\u53D8\u91CF\u662F\u9012\u5F52\u8FD8\u662F\u7B80\u5355\u53D8\u91CF\uFF0C\u8981\u770B\u53D8\u91CF\u539F\u6765\u662F\u4EC0\u4E48\uFF0C\u73B0\u5728\u8FD8\u662F\u4EC0\u4E48\u3002</span>

bar<span class="token operator">?=</span>barv

<span class="token comment"># bar\u672A\u5B9A\u4E49\uFF0C\u5219bar\u7684\u503C\u662Fbarv\uFF0C</span>
bob<span class="token operator">=</span>123
bob<span class="token operator">?=</span>321
<span class="token comment"># bob \u7684\u503C 123</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="\u53D8\u91CF\u672A\u5B9A\u4E49\u548C\u53D8\u91CF\u503C\u4E3A\u7A7A\u503C" tabindex="-1"><a class="header-anchor" href="#\u53D8\u91CF\u672A\u5B9A\u4E49\u548C\u53D8\u91CF\u503C\u4E3A\u7A7A\u503C" aria-hidden="true">#</a> \u53D8\u91CF\u672A\u5B9A\u4E49\u548C\u53D8\u91CF\u503C\u4E3A\u7A7A\u503C</h3><p>\u8981\u6E05\u7A7A\u4E00\u4E2A\u53D8\u91CF\uFF0C\u4E00\u822C\u7ED9\u5B83\u8D4B\u4E00\u4E2A\u7A7A\u503C\u5C31\u8DB3\u591F\u4E86\u3002 \u8981\u5F7B\u5E95\u53D6\u6D88\u53D8\u91CF\u7684\u5B9A\u4E49\uFF0C\u4F7F\u7528 undefine \u6307\u4EE4\u3002 \u8D4B\u7A7A\u503C\u7684\u53D8\u91CF\u548C\u672A\u5B9A\u4E49\u7684\u53D8\u91CF\uFF0C\u5927\u591A\u6570\u8BF7\u60C5\u51B5\u4E0B\u770B\u4E0D\u51FA\u533A\u522B(\u5C55\u5F00\u7684\u7ED3\u679C\u90FD\u662F\u7A7A\u5B57\u7B26\u4E32)\uFF0C \u4F46\u5728 origin \u548C flavor \u8FD9\u4E24\u4E2A\u51FD\u6570\u4E2D\uFF0C\u672A\u5B9A\u4E49\u7684\u53D8\u91CF\u7684\u5C55\u5F00\u7ED3\u679C\u662F undefined\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>foo := foo
bar = bar

undefine foo
undefine bar

$(info $(origin foo))
$(info $(flavor bar))
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>flavor \u663E\u793A\u53D8\u91CF\u7684\u60C5\u51B5\uFF1A</p><ul><li>\u2018undefined\u2019: if variable was never defined.</li><li>\u2018recursive\u2019: if variable is a recursively expanded variable.</li><li>\u2018simple\u2019: if variable is a simply expanded variable.</li></ul><p>origin \u533A\u5206\u7684\u66F4\u591A\u4E00\u4E9B\uFF1Aundefined\uFF0Cdefault\uFF0Cfile\uFF0Cenvironment\uFF0Coverride\uFF0Cautomic\uFF0Ccomman line\uFF0Cenvironent override</p><h2 id="\u901F\u67E5-\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u901F\u67E5-\u51FD\u6570" aria-hidden="true">#</a> \u901F\u67E5\uFF1A\u51FD\u6570</h2><ul><li>$(info msg)</li><li>$(warn msg)</li><li>$(error msg)</li></ul><h2 id="\u901F\u67E5-\u6761\u4EF6\u6307\u4EE4-if" tabindex="-1"><a class="header-anchor" href="#\u901F\u67E5-\u6761\u4EF6\u6307\u4EE4-if" aria-hidden="true">#</a> \u901F\u67E5\uFF1A\u6761\u4EF6\u6307\u4EE4 if</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ifeq($(v1), $(v2))

else ifeq(c0, $(v4))

else

endif
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="\u901F\u67E5-\u8C03\u8BD5\u7528\u7684\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#\u901F\u67E5-\u8C03\u8BD5\u7528\u7684\u9009\u9879" aria-hidden="true">#</a> \u901F\u67E5\uFF1A\u8C03\u8BD5\u7528\u7684\u9009\u9879</h2><h3 id="p-print-data-base" tabindex="-1"><a class="header-anchor" href="#p-print-data-base" aria-hidden="true">#</a> \u2018-p\u2019 \u2018--print-data-base\u2019</h3><ul><li>make -p \u8F93\u51FA\u6700\u7EC8\u7684\u6570\u636E\u5E93\uFF08\u89C4\u5219\u548C\u53D8\u91CF\uFF09\uFF0C\u7136\u540E\u7167\u5E38\u6267\u884C</li><li>make -pq \u8F93\u51FA\u6700\u7EC8\u7684\u6570\u636E\u5E93\uFF08\u89C4\u5219\u548C\u53D8\u91CF\uFF09\uFF0C\u4F46\u4E0D\u6267\u884C</li><li>make -p -f /dev/null \u53EA\u8F93\u51FA\u5185\u7F6E\u6570\u636E\u5E93</li></ul><p>make \u8F93\u51FA\u7684\u6570\u636E\u5E93\u4FE1\u606F\u5E26\u6709\u884C\u53F7\uFF0C\u65B9\u4FBF\u8C03\u8BD5\u3002</p><blockquote><p>Print the data base (rules and variable values) that results from reading the makefiles; then execute as usual or as otherwise specified. This also prints the version information given by the \u2018-v\u2019 switch (see below). To print the data base without trying to remake any files, use \u2018make -qp\u2019. To print the data base of predefined rules and variables, use \u2018make -p -f /dev/null\u2019. The data base output contains file name and line number information for recipe and variable definitions, so it can be a useful debugging tool in complex environments.</p></blockquote><h2 id="\u603B\u7ED3-make-\u542F\u52A8\u8FC7\u7A0B-\u5F85\u7EED" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3-make-\u542F\u52A8\u8FC7\u7A0B-\u5F85\u7EED" aria-hidden="true">#</a> \u603B\u7ED3\uFF1Amake \u542F\u52A8\u8FC7\u7A0B \u5F85\u7EED</h2><ul><li><p>\u8F7D\u5165\u5185\u7F6E\u6570\u636E\u5E93</p></li><li><p>\u8F7D\u5165 MAKEFILES \u53D8\u91CF\u6307\u5B9A\u7684 makefile: \u8BBE\u7F6E\u4E86\u73AF\u5883\u53D8\u91CF\u624D\u4F1A\u8F7D\u5165\uFF0C\u8FD9\u91CC\u6709\u627E\u4E0D\u5230\u7684\u6587\u4EF6\u4E0D\u7B97\u9519\u8BEF</p><ul><li>Q. \u53C2\u4E0E remake \u5417\uFF1F\u5927\u6982\u662F\u53C2\u4E0E\u7684</li><li>Q. \u6700\u521D\u542F\u52A8\u65F6\uFF0C\u6CA1\u6709\u7684\u65F6\u5019\u4F1A\u5C1D\u8BD5make\u5417\uFF1F</li></ul></li><li><p>-f \u548C\u9ED8\u8BA4\u6587\u4EF6</p><ul><li>\u5982\u679C\u6307\u5B9A\u4E86 -f\uFF0C\u5C31\u4E0D\u8003\u8651\u9ED8\u8BA4\u6587\u4EF6\uFF1B\u5982\u679C\u672A\u6307\u5B9A -f \u4F1A\u5C1D\u8BD5\u9ED8\u8BA4\u6587\u4EF6 <ul><li>Q. -f A -f B, \u5F53 A \u5B58\u5728\u800C B \u4E0D\u5B58\u5728\uFF0C\u4F1A\u7528 A \u4E2D\u7684\u89C4\u5219\u6784\u5EFAA\u5417\uFF1F</li><li>Q. -f \u6307\u5B9A\u76F8\u5BF9\u8DEF\u5F84\uFF0C\u4F1A\u641C\u7D22\u90A3\u4E9B\u9ED8\u8BA4\u8DEF\u5F84\u5417\uFF1F-I \u6307\u5B9A\u7684\u8DEF\u5F84\u5462\uFF1F</li></ul></li><li>\u9ED8\u8BA4\u6587\u4EF6\u53EF\u4EE5\u7C7B\u6BD4 -include \u6307\u4EE4</li></ul></li><li><p>remake\uFF0C\u76F4\u5230\u8FBE\u5230\u7A33\u5B9A</p></li></ul><p>\u6DF1\u6316\u4E0B\u53BB\u6709\u66F4\u591A\u7EC6\u8282\u3002\u6682\u65F6\u4E86\u89E3\u5230\u8FD9\u4E9B\u5C31\u591F\u4E86</p><h2 id="\u5B9E\u9A8C-makefile-\u4E2D\u7684\u5DE5\u4F5C\u76EE\u5F55" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u9A8C-makefile-\u4E2D\u7684\u5DE5\u4F5C\u76EE\u5F55" aria-hidden="true">#</a> \u5B9E\u9A8C\uFF1Amakefile \u4E2D\u7684\u5DE5\u4F5C\u76EE\u5F55</h2><ol><li>make \u53D8\u91CF CURDIR \u6307\u5411\u5F53\u524D\u76EE\u5F55</li><li>\u9664\u4E86 MAKEFILES \u53D8\u91CF\u4E4B\u5916\uFF0C\u7B2C\u4E00\u4E2A makefile \u6240\u5728\u7684\u76EE\u5F55\u4F5C\u662F\u5DE5\u4F5C\u76EE\u5F55</li></ol><h2 id="f-\u548C-c" tabindex="-1"><a class="header-anchor" href="#f-\u548C-c" aria-hidden="true">#</a> -f \u548C -C</h2><p>-f \u4E0D\u4F1A\u6539\u53D8\u5DE5\u4F5C\u76EE\u5F55\uFF0C-C \u5219\u4F1A\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>SHELL<span class="token operator">=</span>bash
<span class="token symbol"><span class="token variable">$</span>(info make</span><span class="token punctuation">:</span> current dir is <span class="token variable">$</span><span class="token punctuation">(</span>CURDIR<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token symbol">hello</span><span class="token punctuation">:</span>

&gt; <span class="token operator">@</span>echo current dir is <span class="token variable">$$</span><span class="token punctuation">(</span>pwd<span class="token punctuation">)</span>
RECIPEPREFIX <span class="token operator">:=</span> &gt;
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> -f sub/Makefile
make: current <span class="token function">dir</span> is /home/xizhan/test
current <span class="token function">dir</span> is /home/xizhan/test

$ <span class="token function">make</span> -C sub -f Makefile
make: Entering directory <span class="token string">&#39;/home/xizhan/test/sub&#39;</span>
make: current <span class="token function">dir</span> is /home/xizhan/test/sub
current <span class="token function">dir</span> is /home/xizhan/test/sub
make: Leaving directory <span class="token string">&#39;/home/xizhan/test/sub&#39;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="q-a" tabindex="-1"><a class="header-anchor" href="#q-a" aria-hidden="true">#</a> Q&amp;A</h2><ul><li><p>terminal \u89C4\u5219</p></li><li><p>restart\uFF1A \u662F\u5185\u5BB9\u53D8\u5316\u624D\u7B97\uFF0C\u8FD8\u662F\u8BF4\u53EA\u8981\u65F6\u95F4\u6233\u6709\u66F4\u65B0\u5C31\u7B97\uFF1F</p></li><li><p>\u672A\u5B9A\u4E49\u7684\u53D8\u91CF\uFF0Cempty \u7684\u53D8\u91CF\uFF0C\u53EA\u542B\u7A7A\u683C\u7684\u53D8\u91CF\u7684\u533A\u522B?</p></li><li><p>\u5982\u4F55\u67E5\u770B make \u5B9E\u9645\u6267\u884C\u4E86\u54EA\u4E9B\u89C4\u5219\uFF1F</p></li><li><p>make -f file \u53EF\u4EE5\u6307\u5B9A\u81EA\u5B9A\u4E49\u540D\u79F0\u7684 makefile\uFF0C\u53EF\u4EE5\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u6307\u5B9A\u5417\uFF1F</p></li><li><p>\u5982\u4F55\u7528\u56DB\u4E2A\u7A7A\u683C\u505A recipe \u7684\u524D\u7F00\uFF1F</p></li><li><p>\u5185\u7F6E\u89C4\u5219\u3001\u9690\u5F0F\u89C4\u5219\u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F</p></li><li><p>make \u548C ssh \uFF1F</p></li><li><p>Q. \u89C4\u5219 <code>FORCE:</code>\u548C<code>FORCE: ;</code> \u7684\u533A\u522B\u662F\u4EC0\u4E48\uFF1F\u6216\u8005\u8BF4\uFF0C\u6CA1\u6709 recipe \u548C\u6709\u4E00\u4E2A\u7A7A\u7684 recipe\uFF0C\u6709\u4EC0\u4E48\u533A\u522B\uFF1F</p></li><li><p>make \u53D8\u91CF\u548C\u73AF\u5883\u53D8\u91CF\u662F\u5982\u4F55\u8F6C\u6362\u3001\u4F20\u9012\u7684\uFF1F\u4E00\u4E9B\u7279\u6B8A\u53D8\u91CF</p><ul><li>SHELL</li><li>MAKEFLAGS</li><li>MAKELEVEL</li></ul></li></ul><h3 id="q-\u5728\u89C4\u5219\u7684\u547D\u4EE4\u4E2D\u4F7F\u7528\u7684\u53D8\u91CF-\u53D8\u91CF\u5B9A\u4E49\u7684\u4F4D\u7F6E\u5FC5\u987B\u5728\u89C4\u5219\u4E4B\u524D\u5417" tabindex="-1"><a class="header-anchor" href="#q-\u5728\u89C4\u5219\u7684\u547D\u4EE4\u4E2D\u4F7F\u7528\u7684\u53D8\u91CF-\u53D8\u91CF\u5B9A\u4E49\u7684\u4F4D\u7F6E\u5FC5\u987B\u5728\u89C4\u5219\u4E4B\u524D\u5417" aria-hidden="true">#</a> Q. \u5728\u89C4\u5219\u7684\u547D\u4EE4\u4E2D\u4F7F\u7528\u7684\u53D8\u91CF\uFF0C\u53D8\u91CF\u5B9A\u4E49\u7684\u4F4D\u7F6E\u5FC5\u987B\u5728\u89C4\u5219\u4E4B\u524D\u5417\uFF1F</h3><p>Ans: \u4E0D\u662F\u7684\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span> Makefile <span class="token operator">&lt;&lt;</span><span class="token punctuation">\\</span>EOF
.RECIPEPREFIX <span class="token operator">=</span> <span class="token operator">&gt;</span>
main:
<span class="token operator">&gt;</span> <span class="token builtin class-name">echo</span> hello:<span class="token variable"><span class="token variable">$(</span>foo<span class="token variable">)</span></span><span class="token builtin class-name">:</span>

foo <span class="token operator">=</span> world
EOF

<span class="token function">make</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u786E\u5B9E\u6CA1\u6709</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
<span class="token builtin class-name">echo</span> hello:world:
hello:world:
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="q-make-\u4F7F\u7528\u65F6\u95F4\u6233\u5224\u65AD\u76EE\u6807\u662F\u5426\u9700\u8981\u91CD\u65B0\u6784\u5EFA-\u8FD9\u6837\u4E0D\u53EF\u9760\u5427" tabindex="-1"><a class="header-anchor" href="#q-make-\u4F7F\u7528\u65F6\u95F4\u6233\u5224\u65AD\u76EE\u6807\u662F\u5426\u9700\u8981\u91CD\u65B0\u6784\u5EFA-\u8FD9\u6837\u4E0D\u53EF\u9760\u5427" aria-hidden="true">#</a> Q. make \u4F7F\u7528\u65F6\u95F4\u6233\u5224\u65AD\u76EE\u6807\u662F\u5426\u9700\u8981\u91CD\u65B0\u6784\u5EFA\uFF0C\u8FD9\u6837\u4E0D\u53EF\u9760\u5427\uFF1F</h3><p>2021-12-21 \u8FD9\u662F\u4E3A\u4E86\u517C\u987E\u6027\u80FD\u3002</p><p>\u53EF\u9760\u7684\u65B9\u5F0F\u4E5F\u6709\uFF0C\u6BD4\u5982\u8BA1\u7B97\u5E76\u8BB0\u5F55\u6587\u4EF6\u7684md5\u6216sha512\u6821\u9A8C\u548C\uFF0C\u4F46\u662F\u8BA1\u7B97\u4EE3\u4EF7\u9AD8\u51FA\u4E86\u592A\u591A\u592A\u591A\u3002 \u800C\u6BD4\u8F83\u65F6\u95F4\u6233\u5219\u5F88\u5FEB\u5F88\u5FEB\uFF0C\u540C\u65F6\u7EDD\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u4F7F\u7528\u65F6\u95F4\u6233\u8DB3\u591F\u4E86\u3002 \u53E6\u5916\uFF0C\u8FD8\u63D0\u4F9B\u4E86 -B \u9009\u9879\uFF0C\u53EF\u4EE5\u65E0\u6761\u4EF6\u91CD\u65B0\u6784\u5EFA\u3002</p><p>\u6240\u4EE5\u7528\u65F6\u95F4\u6233\u6BD4\u8F83\uFF0C\u5F88\u5F88\u5408\u7406\u3002</p><h3 id="q-make-\u548C-ssh-\u5F85\u89E3\u51B3" tabindex="-1"><a class="header-anchor" href="#q-make-\u548C-ssh-\u5F85\u89E3\u51B3" aria-hidden="true">#</a> Q. make \u548C ssh \u5F85\u89E3\u51B3</h3><p>docker-compose logs \u547D\u4EE4\u67E5\u770B\u5BB9\u5668\u65E5\u5FD7\u4F1A\u5361\u4F4F\uFF0CCtrl-C \u65E0\u6CD5\u7EC8\u6B62\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token comment"># \u8FD9\u6837\uFF0C\u770B\u5230\u7684\u65E5\u5FD7\u6709\u5F69\u8272\u9AD8\u4EAE\uFF0C\u4F46\u662FCtrl-C \u65E0\u6CD5\u7EC8\u6B62</span>
<span class="token symbol">web.test.log</span><span class="token punctuation">:</span>
	<span class="token operator">@</span>echo \u67E5\u770B web \u6A21\u5757\u7684\u65E5\u5FD7
	-<span class="token operator">@</span>ssh -t work<span class="token operator">@</span>cdh6 <span class="token string">&quot; cd $(deploy_dir_test); \\
		docker-compose logs -f --tail 10 web; \\
		&quot;</span>
<span class="token comment"># \u4E0B\u9762\u4E09\u79CD\u5199\u6CD5\uFF0CCtrl-C \u53EF\u4EE5\u7EC8\u6B62 make\uFF0C\u4F46\u65E5\u5FD7\u6CA1\u6709\u5F69\u8272\u9AD8\u4EAE</span>
<span class="token symbol">web.test.log</span><span class="token punctuation">:</span>
	<span class="token operator">@</span>echo \u67E5\u770B web \u6A21\u5757\u7684\u65E5\u5FD7
	-<span class="token operator">@</span>ssh -nt work<span class="token operator">@</span>cdh6 <span class="token string">&quot; cd $(deploy_dir_test); \\
		docker-compose logs -f --tail 10 web; \\
		&quot;</span>
<span class="token symbol">web.test.log</span><span class="token punctuation">:</span>
	<span class="token operator">@</span>echo \u67E5\u770B web \u6A21\u5757\u7684\u65E5\u5FD7
	-<span class="token operator">@</span>ssh -n work<span class="token operator">@</span>cdh6 <span class="token string">&quot; cd $(deploy_dir_test); \\
		docker-compose logs -f --tail 10 web; \\
		&quot;</span>
<span class="token symbol">web.test.log</span><span class="token punctuation">:</span>
	<span class="token operator">@</span>echo \u67E5\u770B web \u6A21\u5757\u7684\u65E5\u5FD7
	-<span class="token operator">@</span>ssh -n work<span class="token operator">@</span>cdh6 <span class="token string">&quot; cd $(deploy_dir_test); \\
		docker-compose logs -f --tail 10 web; \\
		&quot;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>make \u6536\u5230 Ctrl-C \uFF08SIGINT\uFF09\u4FE1\u53F7\u540E\u4F1A\u4F20\u9012\u7ED9\u6B63\u5728\u6267\u884C\u7684\u5B50shell\uFF0C\u540C\u65F6 make \u81EA\u5DF1\u4E5F\u6536\u5230\u8FD9\u4E2A\u4FE1\u53F7\uFF0C make \u4F1A\u7B49\u5F85\u5B50shell\u6267\u884C\u5B8C\u6BD5\uFF0C\u7136\u540E\u505A\u6E05\u7406\u5DE5\u4F5C\u3001\u518D\u9000\u51FA\u3002</p><h3 id="q-0001-\u624B\u52A8\u6307\u5B9A\u7684-makeflags-\u53D8\u91CF\u4E2D\u7684\u9009\u9879\u662F\u4F5C\u4E3A\u9644\u52A0\u9879\u8FD8\u662F\u8986\u76D6\u5176\u503C\u5462" tabindex="-1"><a class="header-anchor" href="#q-0001-\u624B\u52A8\u6307\u5B9A\u7684-makeflags-\u53D8\u91CF\u4E2D\u7684\u9009\u9879\u662F\u4F5C\u4E3A\u9644\u52A0\u9879\u8FD8\u662F\u8986\u76D6\u5176\u503C\u5462" aria-hidden="true">#</a> Q. (0001)\u624B\u52A8\u6307\u5B9A\u7684 MAKEFLAGS \u53D8\u91CF\u4E2D\u7684\u9009\u9879\u662F\u4F5C\u4E3A\u9644\u52A0\u9879\u8FD8\u662F\u8986\u76D6\u5176\u503C\u5462\uFF1F</h3><p>\u53C2\u89C1 3.7.3</p><p>\u9996\u5148\u8981\u770B MAKEFLAGS \u53D8\u91CF\u7684\u503C\u662F\u600E\u4E48\u6765\u7684\uFF0C\u6839\u636E\u624B\u518C\uFF0C\u5E94\u5F53\u662F\u4ECE\u547D\u4EE4\u884C\u4E2D\u63D0\u53D6\u7684\uFF0C\u5E76\u5C4F\u853D\u4E86 CfOW \u56DB\u4E2A\u9009\u9879\u3002 \u53EF\u4EE5\u9A8C\u8BC1\u4E00\u4E0B\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token symbol"><span class="token variable">$</span>(info</span> <span class="token punctuation">:</span>MAKEFLAGS<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>MAKEFLAGS<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">)</span>

<span class="token symbol">main</span><span class="token punctuation">:</span>
<span class="token symbol">        @echo</span> <span class="token punctuation">:</span>MAKEFLAGS<span class="token operator">=</span><span class="token variable">$$MAKEFLAGS</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u6709\u70B9\u610F\u601D\u54C8\uFF0C\u5728MAKEFLAGS \u4E2D\uFF0C</p><ul><li>\u6709\u4E9B\u9009\u9879\u5E26\u4F1A\u5E26 -\uFF0C\u6709\u4E9B\u4E0D\u5E26</li><li>\u6709\u4E9B\u4F1A\u8FDB\u5165 make \u53D8\u91CF MAKEFLAGS \u4E2D\uFF0C\u6709\u4E9B\u4F1A\u8FDB\u5165recipe \u5B50\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF MAKEFLAGS \u4E2D</li><li>\u53D8\u91CF\u5B9A\u4E49\uFF0C\u53EA\u4F1A\u8FDB\u5165\u5B50\u8FDB\u7A0B\u7684 MAKEFLAGS \u73AF\u5883\u53D8\u91CF\u4E2D</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
:MAKEFLAGS<span class="token operator">=</span>:
:MAKEFLAGS<span class="token operator">=</span>:
$ <span class="token function">make</span> -k
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k:
$ <span class="token function">make</span> -j
:MAKEFLAGS<span class="token operator">=</span>:
:MAKEFLAGS<span class="token operator">=</span> -j:
$ <span class="token function">make</span> -k -j
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k -j:
$ <span class="token function">make</span> -j -k
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k -j:
$ <span class="token function">make</span> -j -k -n
:MAKEFLAGS<span class="token operator">=</span>kn:
<span class="token builtin class-name">echo</span> :MAKEFLAGS<span class="token operator">=</span><span class="token variable">$MAKEFLAGS</span><span class="token builtin class-name">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>make \u7684\u547D\u4EE4\u884C\u53C2\u6570\uFF0C\u4ECE\u73AF\u5883\u53D8\u91CF MAKEFLAGS \u548C \u547D\u4EE4\u884C\u9009\u9879\u5408\u5E76\u800C\u6765\uFF1B\u7136\u540E\u636E\u6B64\u751F\u6210make\u53D8\u91CF MAKEFLAGS \u548C\u4F20\u9012\u7ED9recipe\u5B50\u8FDB\u7A0B\u7684 MAKEFLAGS \u73AF\u5883\u53D8\u91CF\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">MAKEFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-k&quot;</span> <span class="token function">make</span>
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k:
$ <span class="token function">make</span> -s
:MAKEFLAGS<span class="token operator">=</span>s:
:MAKEFLAGS<span class="token operator">=</span>s:
$ <span class="token function">make</span> -j
:MAKEFLAGS<span class="token operator">=</span>:
:MAKEFLAGS<span class="token operator">=</span> -j:
$ <span class="token assign-left variable">MAKEFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-k -j&quot;</span> <span class="token function">make</span>
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k -j:
$ <span class="token function">make</span> -k -s -j
:MAKEFLAGS<span class="token operator">=</span>ks:
:MAKEFLAGS<span class="token operator">=</span>ks -j:
$ <span class="token assign-left variable">MAKEFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-k FOO=bar&quot;</span> <span class="token function">make</span>
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k -- <span class="token assign-left variable">FOO</span><span class="token operator">=</span>bar:
$ <span class="token assign-left variable">MAKEFLAGS</span><span class="token operator">=</span><span class="token string">&quot;-k FOO=bar&quot;</span> <span class="token function">make</span> -j
:MAKEFLAGS<span class="token operator">=</span>k:
:MAKEFLAGS<span class="token operator">=</span>k -j -- <span class="token assign-left variable">FOO</span><span class="token operator">=</span>bar:
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u6362\u4E00\u4E2A Makefile</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>MAKEFLAGS<span class="token operator">=</span>-k

<span class="token symbol"><span class="token variable">$</span>(info</span> <span class="token punctuation">:</span>MAKEFLAGS<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>MAKEFLAGS<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">)</span>

<span class="token symbol">main</span><span class="token punctuation">:</span>
<span class="token symbol">        @echo</span> <span class="token punctuation">:</span>MAKEFLAGS<span class="token operator">=</span><span class="token variable">$$MAKEFLAGS</span><span class="token punctuation">:</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u5982\u4E0B\u8868\u660E\uFF0C\u5728makefile\u4E2D\u8BBE\u7F6E\u53D8\u91CFMAKEFLAGS\uFF0C\u7C7B\u4F3C\u4E8E\u73AF\u5883\u53D8\u91CF\u7684 MAKEFLAGS\uFF0C\u4F1A\u4E0E\u547D\u4EE4\u884C\u9009\u9879 \u5408\u5E76\u3002\u4F46\u5F53\u524D make \u7684MAKEFLAGS \u4E0D\u4F1A\u53CD\u8FC7\u6765\u518D\u53D7\u5F71\u54CD\u4E86\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
:MAKEFLAGS<span class="token operator">=</span>-k:
:MAKEFLAGS<span class="token operator">=</span>k:
$ <span class="token function">make</span> -j
:MAKEFLAGS<span class="token operator">=</span>-k:
:MAKEFLAGS<span class="token operator">=</span>k -j:
$ <span class="token function">make</span> -s -k
:MAKEFLAGS<span class="token operator">=</span>-k:
:MAKEFLAGS<span class="token operator">=</span>ks:
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u603B\u7ED3\uFF0C\u5C31\u662F</p><ol><li>MAKEFLAGS \u73AF\u5883\u53D8\u91CF\u6216\u8005make\u4E2D\u7684MAKEFLAGS\u53D8\u91CF\u6307\u5B9A\u7684\u9009\u9879\uFF0C\u4F1A\u9644\u52A0\u5230\u5F53\u524Dmake\u7684\u547D\u4EE4\u884C\u9009\u9879\u5217\u8868\u4E2D\u3002 PS\uFF1A\u540C\u6837\uFF0C\u5728 MAKEFLAGS \u4E2D\u6307\u5B9A\u7684 CfOW \u9009\u9879\u4F1A\u88AB\u5FFD\u7565 PS\uFF1A\u5982\u679C\u8BBE\u7F6E\u4E86make\u53D8\u91CFMAKEFLAGS\uFF0C\u5F53\u524Dmake\u5C31\u4E0D\u4F1A\u6839\u636E\u6700\u7EC8\u547D\u4EE4\u884C\u9009\u9879\u53CD\u8FC7\u6765\u66F4\u65B0\u5F53\u524D\u7684MAKEFLAGS\u53D8\u4E86\uFF1B\u5982\u679C\u6CA1\u6709\u8BBE\u7F6E\uFF0C\u5C31\u4F1A\u53CD\u8FC7\u6765\u66F4\u65B0\u4E00\u6CE2\u3002</li><li>\u5F53make\u4F1A\u628A\u6700\u7EC8\u7684\u547D\u4EE4\u884C\u9009\u9879\u5217\u8868\uFF0C\u4E2D\u6709\u610F\u4E49\u7684\u9009\u9879\u4F20\u9012\u7ED9\u6267\u884C recipe \u7684\u5B50\u8FDB\u7A0B</li></ol>`,127);function p(l,o){return e}var c=s(a,[["render",p]]);export{c as default};
